!function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n,i=t.data.gpstracestart?t.data.gpstracestart:0,o=t.data.gpstraceend?t.data.gpstraceend:1;if(p.isUndefined(e)){var r=o-i;n=t.r*r+i}else n=-1===e?i:o;return n}function r(t,e){var n=o(t,e);return f["default"].updateGPS(t.data.gpstrace,n,!p.isUndefined(t.data.gpstracefollow)),n}Object.defineProperty(n,"__esModule",{value:!0});var s=t("./pages/5"),a=i(s),l=t("./pages/4"),u=i(l),c=t("./Page"),h=i(c),d=t("./map"),f=i(d);window.$=t("jquery");var p=t("underscore"),m=(t("leaflet/dist/leaflet-src"),parseInt(document.body.id)),g=new h["default"](m);g.on("load:gps",function(t,e){f["default"].initGPS(t,e),4===m&&u["default"](f["default"],g),5===m&&a["default"](f["default"],g)}),g.on("scrollblock:scroll",function(t){if(t.data.gpstrace){{r(t)}t.data.timelapse&&g.updateTimelapse(t,t.r)}}),g.on("scrollblock:enter",function(t,e){if(t.data.gpstrace){{r(t,e?-1:1)}f["default"].updateGPSStatuses(t.data.gpstrace),t.data.timelapse&&g.startTimelapse()}t.data.mapview&&f["default"].setView(t.data.mapview),t.data.geocodedimages&&f["default"].showGeocodedImages(t.el)}),g.on("scrollblock:leave",function(t,e){t.data.gpstrace&&r(t,e?1:-1)}),$(".modal").on("click",function(t){$("body").removeClass("isModalOpen")}),n["default"]=g,e.exports=n["default"]},{"./Page":2,"./map":4,"./pages/4":5,"./pages/5":9,jquery:21,"leaflet/dist/leaflet-src":24,underscore:95}],2:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./utils"),l=o(a),u=t("./Timelapse"),c=i(u),h=t("underscore"),d=t("jquery"),f=t("backbone"),p=function(){function t(e){r(this,t),this.data={},this.data.index=e,this._currentScrollBlockIndexes=[],this.setupFromDom(),this.loadData()}return s(t,[{key:"setupFromDom",value:function(){var t=this;this.data.scrollBlocks=[],d("[data-trigger]").each(function(e,n){n=d(n);var i=l.parseDataAttrFloats(n.data());h.each(i,function(t,e){""===t&&(i[e]=!0),h.contains(["gpstracestart","gpstraceend"],e)&&(i[e]=parseFloat(t)),"mapview"===e&&(i[e]=i[e].split("/").map(parseFloat))});var o=n.offset().top,r={start:o,end:o+n.innerHeight(),data:i,el:n};t.data.scrollBlocks.push(r)}),this.data.scrollBlocks=h.sortBy(this.data.scrollBlocks,function(t){return t.start}),this.data.gpstrace=[],d("[data-gpstrace]").each(function(e,n){t.data.gpstrace.push(d(n).data("gpstrace"))}),this.data.gpstrace=h.uniq(this.data.gpstrace),this.data.timelapse=d("[data-timelapse]").length,this.data.timelapse&&d(".js-imgprv").hide()}},{key:"loadData",value:function(){var t=this,e=this.data.gpstrace.map(function(e){return l.load("./data/"+t.data.index+"/"+e+".topojson")});Promise.all(e).then(function(n){t.trigger("load:gps",t.data.gpstrace,n.slice(0,e.length)),t._start()})}},{key:"_start",value:function(){var t=this;this._prevY=0,this._title=d("h1"),d(".title-overlay").addClass("title-overlay--ready"),this.data.timelapse&&(this._timelapse=new c["default"]),document.addEventListener("scroll",function(e){return t._onScroll()}),this._onScroll()}},{key:"_onScroll",value:function(){var t=window.scrollY+window.innerHeight,e=t-this._prevY,n=e>0;this._prevY=t;var i=!1,o=-50-.02*window.scrollY;this._title.css("margin-top",o+"%");for(var r=0;r<this.data.scrollBlocks.length;r++){var s=this.data.scrollBlocks[r],a=t;if(s.data.scrolltriggeroffset&&(a-=window.innerHeight*s.data.scrolltriggeroffset),a>=s.start&&a<s.end){var l=(a-s.start)/(s.end-s.start);s.r=l,h.contains(this._currentScrollBlockIndexes,r)||(this._currentScrollBlockIndexes.push(r),this.trigger("scrollblock:enter",s,n),s.data.fixed&&s.el.next(".fixed").addClass("show"),s.data.revealparent&&s.el.parents(".concealed").addClass("concealed--revealed")),this.trigger("scrollblock:scroll",s),i=!0}else h.contains(this._currentScrollBlockIndexes,r)&&(this._currentScrollBlockIndexes=h.without(this._currentScrollBlockIndexes,r),this.trigger("scrollblock:leave",s,n),s.el.next(".fixed").removeClass("show"),s.data.concealparent&&s.el.parents(".concealed").removeClass("concealed--revealed"))}}},{key:"startTimelapse",value:function(){d(".js-imgprv").show()}},{key:"updateTimelapse",value:function(t,e){this._timelapse.update(e)}}]),t}();n["default"]=p,h.extend(p.prototype,f.Events),e.exports=n["default"]},{"./Timelapse":3,"./utils":10,backbone:11,jquery:21,underscore:95}],3:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=t("underscore"),s=function(){function t(){i(this,t),this.numImages=939,this.targetWidth=256;var e=2048;this.targetHeight=.75*this.targetWidth,this.gridCols=e/this.targetWidth,this.gridRows=Math.floor(this.gridCols/.75),this.spritesInSheet=this.gridCols*this.gridRows;var n=Math.ceil(this.numImages/this.spritesInSheet);this.spritesheets=[];{var o;document.querySelector(".timelapse")}this.timelapseLow=document.querySelector(".timelapse-low"),this.timelapseMedium=document.querySelector(".timelapse-medium");for(var r=0;n>r;r++)o=document.createElement("div"),o.style.backgroundImage="url(data/6/timelapse/spritesheet_"+r+".jpg)",o.style.display="none",this.spritesheets.push(o),this.timelapseLow.appendChild(o)}return o(t,[{key:"update",value:function(t){var e=this;console.log(t);var n=Math.floor(t*this.numImages),i=Math.floor(n/this.spritesInSheet);i!==this.currentSpriteSheetIndex&&(this.currentSpriteSheetContainer&&(this.currentSpriteSheetContainer.style.display="none"),this.currentSpriteSheetIndex=i,this.currentSpriteSheetContainer=this.spritesheets[i],this.currentSpriteSheetContainer.style.display="block");var o=n%this.spritesInSheet,s=o%this.gridCols,a=Math.floor(o/this.gridCols),l=[i,o];if(!r.isEqual(this.currentSpriteSheetCoords,l)){var u=s*this.targetWidth,c=a*this.targetHeight;this.currentSpriteSheetContainer.style.backgroundPosition="-"+u+"px -"+c+"px",clearTimeout(this.showMediumTimeout),this.mediumImage&&(this.timelapseMedium.removeChild(this.mediumImage),this.timelapseMedium.style.display="none",this.timelapseLow.style.display="block",this.mediumImage.removeEventListener("load",this.onMediumImageLoaded),this.mediumImage=null),this.showMediumTimeout=setTimeout(function(){console.log(n),e.mediumImage=document.createElement("img"),e.mediumImage.addEventListener("load",e.onMediumImageLoaded.bind(e)),e.mediumImage.setAttribute("src","data/6/timelapse/medium/"+n+".jpg"),e.mediumImage.setAttribute("class","medium"),e.timelapseMedium.appendChild(e.mediumImage)},500)}this.currentSpriteSheetCoords=l}},{key:"onMediumImageLoaded",value:function(){this.timelapseMedium.style.display="block",this.timelapseLow.style.display="none"}}]),t}();n["default"]=s,e.exports=n["default"]},{underscore:95}],4:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}Object.defineProperty(n,"__esModule",{value:!0});var o=t("./utils"),r=(i(o),t("leaflet/dist/leaflet-src")),s=t("underscore"),a=t("jquery"),l=t("topojson"),u=t("turf-polygon"),c=(t("turf-point"),t("turf-centroid")),h=t("formatcoords");t("leaflet-graphicscale"),t("leaflet-hash"),r.Icon.Default.imagePath="./images/";{var d=r.map("map",{center:[27.746,-18.08],zoom:13,minZoom:4,maxZoom:20,scrollWheelZoom:!1});new r.Hash(d)}d.on("click",function(t){}),r.tileLayer("https://{s}.tiles.mapbox.com/v3/{key}/{z}/{x}/{y}.png",{key:"lrqdo.2f512fdf",attribution:""}).addTo(d),r.tileLayer("https://{s}.tiles.mapbox.com/v3/{key}/{z}/{x}/{y}.png",{key:"lrqdo.0c289a18",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(d);d.attributionControl.setPrefix("");var f=(r.control.graphicScale({fill:"hollow",showSubunits:!0}).addTo(d),{feet:s.template(a(".js-tpl-gps-feet").html()),car:s.template(a(".js-tpl-gps-car").html()),para:s.template(a(".js-tpl-gps-para").html())}),p={},m=[],g=[],v={initGPS:function(t,e){for(var n=0;n<e.length;n++){var i=e[n],o=l.feature(i,i.objects.stdin),u=o.features[0].geometry.coordinates.map(function(t){return[t[1],t[0],t[2]]}),c=t[n],h=r.polyline([]).addTo(d),g=c.match(/\d_(.+)/)[1],v=s.contains(["taxi","andrescar"],g)?"car":g;a(h._container).attr("class","gps gps--"+v);var y={data:{}};"taxi"===g&&(y.data.taxi=!0);var _=r.divIcon({html:f[v](y)}),b=r.marker([0,0],{icon:_});b.addTo(this.map),p[c]={name:c,index:n,polyline:h,coords:u,picto:b,pictoInner:a(b._icon).find(".picto-inner")},m.push(p[c])}a(".leaflet-overlay-pane svg").prepend(a(".js-tpl-svg-patterns").html())},getGPS:function(t){return p[t]},updateGPS:function(t,e,n){var i=p[t],o=Math.min(Math.floor(e*i.coords.length),i.coords.length-1);if(i.polyline.setLatLngs(i.coords.slice(0,o)),i.picto.setLatLng(i.coords[o]),n){var r=i.coords.slice(Math.max(0,o-20),o);r.push([r[0][0],r[0][1]]);var s=u([r]),a=c(s);d.panTo(a.geometry.coordinates,{animate:!1})}return i},updateGPSStatuses:function(t){for(var e=0;e<m.length;e++){var n=m[e],i=a(n.polyline._container).attr("class").split(" ");t===n.name?(i=s.without(i,"gps--old"),n.picto._icon.style.display="block"):(i.push("gps--old"),n.picto._icon.style.display="none"),i=s.uniq(i),a(n.polyline._container).attr("class",i.join(" "))}},setView:function(t){d.setView([t[1],t[2]],t[0])},showGeocodedImages:function(t){function e(t){var e=a(t).data("coords"),n=new r.Marker(e.split(","),{icon:i}).addTo(d);n.img=a(t),n.on("mouseover",function(){a(".js-imgprv").html(this.img)}),n.on("click",function(){a("body").addClass("isModalOpen");var t=a("<img>");t.attr("src",this.img.attr("src").replace("medium","hi")),a(".js-modal-img").html(t);var e=h(this.getLatLng()).format();a(".js-modal-coords").html(e)})}var n=[];t.find(".geocodedImages img").each(function(t,e){var i=e.getAttribute("src");s.contains(g,i)||(g.push(i),n.push(e))}),n=s.sortBy(n,function(t){return t.getAttribute("src")}),n.forEach(function(t,n){s.delay(e,50*n,t)});var i=r.divIcon({html:'<div class="geocodedImage"><div class="geocodedImage-inner"></div></div>'})},clean:function(){},map:d};n["default"]=v,e.exports=n["default"]},{"./utils":10,formatcoords:20,jquery:21,"leaflet-graphicscale":22,"leaflet-hash":23,"leaflet/dist/leaflet-src":24,topojson:25,"turf-centroid":91,"turf-point":96,"turf-polygon":94,underscore:95}],5:[function(t,e,n){"use strict";function i(t,e){o(t.map),e.on("scrollblock:scroll",function(t){t.data.torque&&r(t.r)})}function o(e){a=!0,l.heatmap=new s.TorqueLayer({user:"nerik",table:"terremotos_1",cartocss:t("./4_heatmap.carto.css"),attribution:['<a href="http://cartodb.com/attributions">CartoDB</a>','<a href="http://www.ign.es/">IGN Espa√±a</a>']}),l.heatmap.addTo(e),$(l.heatmap._container).css("opacity",".75"),l.mag=new s.TorqueLayer({user:"nerik",table:"terremotos_1_minmag",cartocss:t("./4_mag.carto.css")}),l.mag.addTo(e);var n=new s.Control.TorqueLegend({position:"bottomright"});n.addTo(e)}function r(t){var e=Math.floor(t*u);l.heatmap.setStep(e),l.mag.setStep(e)}Object.defineProperty(n,"__esModule",{value:!0});var s=t("leaflet/dist/leaflet-src");t("torque.js");var a=void 0,l={},u=92;s.Control.TorqueLegend=s.Control.extend({onAdd:function(e){var n=s.DomUtil.create("div");return n.innerHTML=t("./4_legend.html"),n}}),n["default"]=i,e.exports=n["default"]},{"./4_heatmap.carto.css":6,"./4_legend.html":7,"./4_mag.carto.css":8,"leaflet/dist/leaflet-src":24,"torque.js":35}],6:[function(t,e,n){var i='Map {\n  -torque-frame-count: 92;\n  -torque-animation-duration: 99999;\n  -torque-time-attribute: "datetime";\n  -torque-aggregation-function: "count(cartodb_id)";\n  -torque-resolution: 8;\n  -torque-data-aggregation: linear;\n}\n/*@road_primary: #ffc673;\n@road_secondary: #fff066;*/\n#terremotos_1 {\n  image-filters: colorize-alpha(#fff066, #ffc673, #fa4861);\n  marker-file: url(extra/alphamarker.png);\n  marker-fill-opacity: 0.4*[value];\n  marker-width: 35;\n}\n#terremotos_1[frame-offset=1] {\n  marker-width: 37;\n  marker-fill-opacity: 0.2;\n}\n#terremotos_1[frame-offset=2] {\n  marker-width: 39;\n  marker-fill-opacity: 0.1;\n}\n#terremotos_1[frame-offset=3] {\n  marker-width: 41;\n  marker-fill-opacity: 0.06666666666666667;\n}\n';t("browserify-css").createStyle(i,{href:"app/js/pages/4_heatmap.carto.css"}),e.exports=i},{"browserify-css":12}],7:[function(t,e,n){e.exports='<div class="torqueLegend">\n    <div class="torqueLegend-title">\n        Nombre d\'√©v√®nements sismiques enregistr√©s :\n    </div>\n    <div class="torqueLegend-heatmap">\n        <div class="torqueLegend-left">faibles</div>\n        <div class="torqueLegend-right">√©lev√©s</div>\n    </div>\n    <div class="torqueLegend-title">\n        Magnitude moyenne :\n    </div>\n    <div class="torqueLegend-mag">\n        <div class="torqueLegend-mag-circles">\n            <div> > 2</div>\n            <p></p>\n            <p></p>\n            <p></p>\n            <div> > 4</div>\n        </div>\n    </div>\n</div>\n\n'},{}],8:[function(t,e,n){var i='/** torque visualization */\nMap {\n  -torque-frame-count: 92;\n  -torque-animation-duration: 9999;\n  -torque-time-attribute: "datetime";\n  -torque-aggregation-function: "round(avg(mag))";\n  -torque-resolution: 2;\n  -torque-data-aggregation: linear;\n}\n#terremotos_1_minmag {\n  /*comp-op: lighter;*/\n  marker-fill-opacity: 0.9;\n  marker-type: ellipse;\n  marker-fill: #982636;\n  marker-width: 2;\n}\n#terremotos_1_minmag[frame-offset=1] {\n  marker-fill-opacity: 0.45;\n}\n#terremotos_1_minmag[frame-offset=2] {\n  marker-fill-opacity: 0.225;\n}\n#terremotos_1_minmag[frame-offset=3] {\n  marker-fill-opacity: 0.15;\n}\n/* marker-width = (value*value)/2 */\n/* TODO Scss loop? */\n#terremotos_1_minmag[value > 2.00] {\n  marker-width: 2;\n}\n#terremotos_1_minmag[value > 2.25] {\n  marker-width: 2.5;\n}\n#terremotos_1_minmag[value > 2.50] {\n  marker-width: 3.125;\n}\n#terremotos_1_minmag[value > 2.75] {\n  marker-width: 3.78;\n}\n#terremotos_1_minmag[value > 3.00] {\n  marker-width: 4.5;\n}\n#terremotos_1_minmag[value > 3.25] {\n  marker-width: 5.28;\n}\n#terremotos_1_minmag[value > 3.50] {\n  marker-width: 6.125;\n}\n#terremotos_1_minmag[value > 3.75] {\n  marker-width: 7;\n}\n#terremotos_1_minmag[value > 4.00] {\n  marker-width: 8;\n}\n';t("browserify-css").createStyle(i,{href:"app/js/pages/4_mag.carto.css"}),e.exports=i},{"browserify-css":12}],9:[function(t,e,n){"use strict";function i(t,e){var n=t.getGPS("2_para");e.on("scrollblock:enter",function(t){t.data.three&&!E&&o(n,t.el[0])})}function o(t,e){E=!0;window.innerWidth,window.innerHeight;m=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4);var n=50;m.position.y=n/2,m.position.x=n,m.position.z=n,m.lookAt(new THREE.Vector3(0,0,0)),g=new THREE.Scene,r(t.coords),a(P),_=new THREE.WebGLRenderer({antialias:!0}),_.setClearColor(2900324),_.setSize(window.innerWidth,window.innerHeight),e.appendChild(_.domElement),l(),p()}function r(t){for(var e=[],n=void 0,i=void 0,o=void 0,r=void 0,a=void 0,l=void 0,u=void 0,c=void 0,h=27.732765,d=-18.033666,f=.039386000000000365,p=.051719999999999544,m=231,_=1345,b=1114,w=0;w<t.length;w++)n=t[w],i=n[0],o=n[1],r=n[2],l=-(o-d)*S,u=(i-h)*S,c=(r-m)*k,a=new THREE.Vector3(l,c,u),e.push(a);console.log(m,_);for(var x=new THREE.SplineCurve3(e),L=new THREE.TubeGeometry(x,1e3,.2,10,!1),T=["a","b","c","d"],P=void 0,C=void 0,E=void 0,D=void 0,M=b*k,A=0;A<L.faces.length;A++){P=L.faces[A],E=P instanceof THREE.Face3?3:4;for(var z=0;E>z;z++){D=P[T[z]],C=L.vertices[D];var I=Math.min(1,C.y/M);P.vertexColors[z]=s(I)}}var O=[new THREE.MeshLambertMaterial({color:16777215,vertexColors:THREE.VertexColors})];v=new THREE.Object3D,g.add(v),y=THREE.SceneUtils.createMultiMaterialObject(L,O),y.position.x=p/2*S,y.position.z=-(f/2)*S,v.add(y);var N=new THREE.PointLight(16777215,1,300);N.position.set(0,15,0),g.add(N);var R=new THREE.AmbientLight(9474192);g.add(R),g.add(new THREE.AxisHelper(100)),g.add(new THREE.GridHelper(1e3,100))}function s(t){for(var e=void 0,n=void 0,i=void 0,o=void 0,r=0;3>r;r++)if(t<=C[r+1].r){e=C[r].c.clone(),n=C[r+1].c,i=C[r].r,o=C[r+1].r;break}var s=(t-i)/(o-i);return e.lerp(n,s)}function a(t){v.scale.set(t,t,t)}function l(){_.domElement.addEventListener("mousedown",u,!1)}function u(t){t.preventDefault(),_.domElement.addEventListener("mousemove",c,!1),_.domElement.addEventListener("mouseup",h,!1),_.domElement.addEventListener("mouseout",d,!1),x=t.clientX-T,w=b}function c(t){L=t.clientX-T,b=w+.02*(L-x)}function h(t){f()}function d(t){f()}function f(t){_.domElement.removeEventListener("mousemove",c,!1),_.domElement.removeEventListener("mouseup",h,!1),_.domElement.removeEventListener("mouseout",d,!1)}function p(){requestAnimationFrame(p.bind(this));var t=.05*(b-v.rotation.y);v.rotation.y+=t,_.render(g,m)}Object.defineProperty(n,"__esModule",{value:!0});var m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=0,w=0,x=void 0,L=void 0,T=window.innerWidth/2,S=(window.innerHeight/2,2e3),k=.02,P=1,C=[{r:0,c:new THREE.Color(10870897)},{r:.25,c:new THREE.Color(10870897)},{r:.6,c:new THREE.Color(15908384)},{r:1,c:new THREE.Color(10715997)}],E=void 0;n["default"]=i,e.exports=n["default"]},{}],10:[function(t,e,n){"use strict";function i(t){return new Promise(function(e,n){var i=new XMLHttpRequest;i.onload=function(t){200!==t.target.status?n(t.target.statusText):e(JSON.parse(t.target.response))},i.onerror=function(t){n(t.target.statusText)},i.open("GET",t),i.send()})}function o(e,n){var i=t("underscore");return i.each(e,function(t,o){i.contains(n,o)&&(e[o]=parseFloat(t))}),e}function r(t){return[t[1],t[0]]}Object.defineProperty(n,"__esModule",{value:!0}),n.load=i,n.parseDataAttrFloats=o,n.swapLL=r},{underscore:95}],11:[function(t,e,n){(function(e){!function(i){var o="object"==typeof self&&self.self==self&&self||"object"==typeof e&&e.global==e&&e;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(t,e,n){o.Backbone=i(o,n,t,e)});else if("undefined"!=typeof n){var r,s=t("underscore");try{r=t("jquery")}catch(a){}i(o,n,s,r)}else o.Backbone=i(o,{},o._,o.jQuery||o.Zepto||o.ender||o.$)}(function(t,e,n,i){var o=t.Backbone,r=[].slice;e.VERSION="1.2.1",e.$=i,e.noConflict=function(){return t.Backbone=o,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,i){switch(t){case 1:return function(){return n[e](this[i])};case 2:return function(t){return n[e](this[i],t)};case 3:return function(t,o){return n[e](this[i],t,o)};case 4:return function(t,o,r){return n[e](this[i],t,o,r)};default:return function(){var t=r.call(arguments);return t.unshift(this[i]),n[e].apply(n,t)}}},a=function(t,e,i){n.each(e,function(e,o){n[o]&&(t.prototype[o]=s(e,o,i))})},l=e.Events={},u=/\s+/,c=function(t,e,i,o,r){var s,a=0;if(i&&"object"==typeof i){void 0!==o&&"context"in r&&void 0===r.context&&(r.context=o);for(s=n.keys(i);a<s.length;a++)e=t(e,s[a],i[s[a]],r)}else if(i&&u.test(i))for(s=i.split(u);a<s.length;a++)e=t(e,s[a],o,r);else e=t(e,i,o,r);return e};l.on=function(t,e,n){return h(this,t,e,n)};var h=function(t,e,n,i,o){if(t._events=c(d,t._events||{},e,n,{context:i,ctx:t,listening:o}),o){var r=t._listeners||(t._listeners={});r[o.id]=o}return t};l.listenTo=function(t,e,i){if(!t)return this;var o=t._listenId||(t._listenId=n.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),s=r[o];if(!s){var a=this._listenId||(this._listenId=n.uniqueId("l"));s=r[o]={obj:t,objId:o,id:a,listeningTo:r,count:0}}return h(t,e,i,this,s),this};var d=function(t,e,n,i){if(n){var o=t[e]||(t[e]=[]),r=i.context,s=i.ctx,a=i.listening;a&&a.count++,o.push({callback:n,context:r,ctx:r||s,listening:a})}return t};l.off=function(t,e,n){return this._events?(this._events=c(f,this._events,t,e,{context:n,listeners:this._listeners}),this):this},l.stopListening=function(t,e,i){var o=this._listeningTo;if(!o)return this;for(var r=t?[t._listenId]:n.keys(o),s=0;s<r.length;s++){var a=o[r[s]];if(!a)break;a.obj.off(e,i,this)}return n.isEmpty(o)&&(this._listeningTo=void 0),this};var f=function(t,e,i,o){if(t){var r,s=0,a=o.context,l=o.listeners;if(e||i||a){for(var u=e?[e]:n.keys(t);s<u.length;s++){e=u[s];var c=t[e];if(!c)break;for(var h=[],d=0;d<c.length;d++){var f=c[d];i&&i!==f.callback&&i!==f.callback._callback||a&&a!==f.context?h.push(f):(r=f.listening,r&&0===--r.count&&(delete l[r.id],delete r.listeningTo[r.objId]))}h.length?t[e]=h:delete t[e]}return n.size(t)?t:void 0}for(var p=n.keys(l);s<p.length;s++)r=l[p[s]],delete l[r.id],delete r.listeningTo[r.objId]}};l.once=function(t,e,i){var o=c(p,{},t,e,n.bind(this.off,this));return this.on(o,void 0,i)},l.listenToOnce=function(t,e,i){var o=c(p,{},e,i,n.bind(this.stopListening,this,t));return this.listenTo(t,o)};var p=function(t,e,i,o){if(i){var r=t[e]=n.once(function(){o(e,r),i.apply(this,arguments)});r._callback=i}return t};l.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;e>i;i++)n[i]=arguments[i+1];return c(m,this._events,t,void 0,n),this};var m=function(t,e,n,i){if(t){var o=t[e],r=t.all;o&&r&&(r=r.slice()),o&&g(o,i),r&&g(r,[e].concat(i))}return t},g=function(t,e){var n,i=-1,o=t.length,r=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<o;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=t[i]).callback.call(n.ctx,r);return;case 2:for(;++i<o;)(n=t[i]).callback.call(n.ctx,r,s);return;case 3:for(;++i<o;)(n=t[i]).callback.call(n.ctx,r,s,a);return;default:for(;++i<o;)(n=t[i]).callback.apply(n.ctx,e);return}};l.bind=l.on,l.unbind=l.off,n.extend(e,l);var v=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(v.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var o;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;var r=i.unset,s=i.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,c=this.changed,h=this._previousAttributes;this.idAttribute in o&&(this.id=o[this.idAttribute]);for(var d in o)e=o[d],n.isEqual(u[d],e)||a.push(d),n.isEqual(h[d],e)?delete c[d]:c[d]=e,r?delete u[d]:u[d]=e;if(!s){a.length&&(this._pending=i);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,u[a[f]],i)}if(l)return this;if(!s)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e=this._changing?this._previousAttributes:this.attributes,i={};for(var o in t){var r=t[o];n.isEqual(e[o],r)||(i[o]=r)}return n.size(i)?i:!1},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,i=t.success;return t.success=function(n){var o=t.parse?e.parse(n,t):n;return e.set(o,t)?(i&&i.call(t.context,e,n,t),void e.trigger("sync",e,n,t)):!1},q(this,t),this.sync("read",this,t)},save:function(t,e,i){var o;null==t||"object"==typeof t?(o=t,i=e):(o={})[t]=e,i=n.extend({validate:!0,parse:!0},i);var r=i.wait;if(o&&!r){if(!this.set(o,i))return!1}else if(!this._validate(o,i))return!1;var s=this,a=i.success,l=this.attributes;i.success=function(t){s.attributes=l;var e=i.parse?s.parse(t,i):t;return r&&(e=n.extend({},o,e)),e&&!s.set(e,i)?!1:(a&&a.call(i.context,s,t,i),void s.trigger("sync",s,t,i))},q(this,i),o&&r&&(this.attributes=n.extend({},l,o));var u=this.isNew()?"create":i.patch?"patch":"update";"patch"!==u||i.attrs||(i.attrs=o);var c=this.sync(u,this,i);return this.attributes=l,c},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,o=t.wait,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){o&&r(),i&&i.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var s=!1;return this.isNew()?n.defer(t.success):(q(this,t),s=this.sync("delete",this,t)),o||r(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||j();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.defaults({validate:!0},t))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1):!0}});var y={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(v,y,"attributes");var _=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1};n.extend(_.prototype,l,{model:v,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,w))},remove:function(t,e){e=n.extend({},e);var i=!n.isArray(t);t=i?[t]:n.clone(t);var o=this._removeModels(t,e);return!e.silent&&o&&this.trigger("update",this,e),i?o[0]:o},set:function(t,e){e=n.defaults({},e,b),e.parse&&!this._isModel(t)&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:t.slice();var o,r,s,a,l,u=e.at;null!=u&&(u=+u),0>u&&(u+=this.length+1);for(var c=this.comparator&&null==u&&e.sort!==!1,h=n.isString(this.comparator)?this.comparator:null,d=[],f=[],p={},m=e.add,g=e.merge,v=e.remove,y=!c&&m&&v?[]:!1,_=!1,w=0;w<t.length;w++){if(s=t[w],a=this.get(s))v&&(p[a.cid]=!0),g&&s!==a&&(s=this._isModel(s)?s.attributes:s,e.parse&&(s=a.parse(s,e)),a.set(s,e),c&&!l&&a.hasChanged(h)&&(l=!0)),t[w]=a;else if(m){if(r=t[w]=this._prepareModel(s,e),!r)continue;d.push(r),this._addReference(r,e)}r=a||r,r&&(o=this.modelId(r.attributes),!y||!r.isNew()&&p[o]||(y.push(r),_=_||!this.models[w]||r.cid!==this.models[w].cid),p[o]=!0)}if(v){for(var w=0;w<this.length;w++)p[(r=this.models[w]).cid]||f.push(r);f.length&&this._removeModels(f,e)}if(d.length||_)if(c&&(l=!0),this.length+=d.length,null!=u)for(var w=0;w<d.length;w++)this.models.splice(u+w,0,d[w]);else{y&&(this.models.length=0);for(var x=y||d,w=0;w<x.length;w++)this.models.push(x[w])}if(l&&this.sort({silent:!0}),!e.silent){for(var L=null!=u?n.clone(e):e,w=0;w<d.length;w++)null!=u&&(L.index=u+w),(r=d[w]).trigger("add",r,this,L);(l||_)&&this.trigger("sort",this,e),(d.length||f.length)&&this.trigger("update",this,e)}return i?t[0]:t},reset:function(t,e){e=e?n.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null==t)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){var i=n.matches(t);return this[e?"find":"filter"](function(t){return i(t.attributes)})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=n.extend({parse:!0},t);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e.call(t.context,i,n,t),i.trigger("sync",i,n,t)},q(this,t),this.sync("read",this,t)},create:function(t,e){e=e?n.clone(e):{};var i=e.wait;if(t=this._prepareModel(t,e),!t)return!1;i||this.add(t,e);var o=this,r=e.success;return e.success=function(t,e,n){i&&o.add(t,n),r&&r.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var o=this.get(t[i]);if(o){var r=this.indexOf(o);this.models.splice(r,1),this.length--,e.silent||(e.index=r,o.trigger("remove",o,this,e)),n.push(o),this._removeReference(o,e)}}return n.length?n:!1},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if("add"!==t&&"remove"!==t||n===this){if("destroy"===t&&this.remove(e,i),"change"===t){var o=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);o!==r&&(null!=o&&delete this._byId[o],null!=r&&(this._byId[r]=e))}this.trigger.apply(this,arguments)}}});var x={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,
every:3,all:3,some:3,any:3,include:2,contains:2,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3};a(_,x,"models");var L=["groupBy","countBy","sortBy","indexBy"];n.each(L,function(t){n[t]&&(_.prototype[t]=function(e,i){var o=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,o,i)})});var T=e.View=function(t){this.cid=n.uniqueId("view"),n.extend(this,n.pick(t,k)),this._ensureElement(),this.initialize.apply(this,arguments)},S=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];n.extend(T.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[i]),i){var o=e.match(S);this.delegate(o[1],o[2],n.bind(i,this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,i,o){var r=P[t];n.defaults(o||(o={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=n.result(i,"url")||j()),null!=o.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||i.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===s.type||o.emulateJSON||(s.processData=!1);var l=o.error;o.error=function(t,e,n){o.textStatus=e,o.errorThrown=n,l&&l.call(o.context,t,e,n)};var u=o.xhr=e.ajax(n.extend(s,o));return i.trigger("request",i,u,o),u};var P={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var C=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,D=/(\(\?)?:\w+/g,M=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,l,{initialize:function(){},route:function(t,i,o){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(o=i,i=""),o||(o=this[i]);var r=this;return e.history.route(t,function(n){var s=r._extractParameters(t,n);r.execute(o,s,i)!==!1&&(r.trigger.apply(r,["route:"+i].concat(s)),r.trigger("route",i,s),e.history.trigger("route",r,i,s))}),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace(E,"(?:$1)?").replace(D,function(t,e){return e?t:"([^/?]+)"}).replace(M,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var z=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,N=/#.*$/;z.started=!1,n.extend(z.prototype,l,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(I,"")},start:function(t){if(z.started)throw new Error("Backbone.history has already been started");if(z.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(O,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,o=i.insertBefore(this.iframe,i.firstChild).contentWindow;o.document.open(),o.document.close(),o.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};return this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),z.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return this.matchRoot()?(t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})):!1},navigate:function(t,e){if(!z.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;(""===t||"?"===t.charAt(0))&&(n=n.slice(0,-1)||"/");var i=n+t;if(t=this.decodeFragment(t.replace(N,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new z;var R=function(t,e){var i,o=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},n.extend(i,o,e);var r=function(){this.constructor=i};return r.prototype=o.prototype,i.prototype=new r,t&&n.extend(i.prototype,t),i.__super__=o.prototype,i};v.extend=_.extend=C.extend=T.extend=z.extend=R;var j=function(){throw new Error('A "url" property or function must be specified')},q=function(t,e){var n=e.error;e.error=function(i){n&&n.call(e.context,t,i,e),t.trigger("error",t,i,e)}};return e})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{jquery:21,underscore:95}],12:[function(t,e,n){"use strict";e.exports={createLink:function(t,e){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("link");i.href=t,i.rel="stylesheet";for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];i.setAttribute("data-"+o,r)}n.appendChild(i)},createStyle:function(t,e){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css";for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];i.setAttribute("data-"+o,r)}i.sheet?(i.innerHTML=t,i.sheet.cssText=t,n.appendChild(i)):i.styleSheet?(n.appendChild(i),i.styleSheet.cssText=t):(i.appendChild(document.createTextNode(t)),n.appendChild(i))}}},{}],13:[function(t,e,n){},{}],14:[function(t,e,n){function i(t,e){return f.isUndefined(e)?""+e:f.isNumber(e)&&!isFinite(e)?e.toString():f.isFunction(e)||f.isRegExp(e)?e.toString():e}function o(t,e){return f.isString(t)?t.length<e?t:t.slice(0,e):t}function r(t){return o(JSON.stringify(t.actual,i),128)+" "+t.operator+" "+o(JSON.stringify(t.expected,i),128)}function s(t,e,n,i,o){throw new g.AssertionError({message:n,actual:t,expected:e,operator:i,stackStartFunction:o})}function a(t,e){t||s(t,!0,e,"==",g.ok)}function l(t,e){if(t===e)return!0;if(f.isBuffer(t)&&f.isBuffer(e)){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return f.isDate(t)&&f.isDate(e)?t.getTime()===e.getTime():f.isRegExp(t)&&f.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:f.isObject(t)||f.isObject(e)?c(t,e):t==e}function u(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function c(t,e){if(f.isNullOrUndefined(t)||f.isNullOrUndefined(e))return!1;if(t.prototype!==e.prototype)return!1;if(f.isPrimitive(t)||f.isPrimitive(e))return t===e;var n=u(t),i=u(e);if(n&&!i||!n&&i)return!1;if(n)return t=p.call(t),e=p.call(e),l(t,e);var o,r,s=v(t),a=v(e);if(s.length!=a.length)return!1;for(s.sort(),a.sort(),r=s.length-1;r>=0;r--)if(s[r]!=a[r])return!1;for(r=s.length-1;r>=0;r--)if(o=s[r],!l(t[o],e[o]))return!1;return!0}function h(t,e){return t&&e?"[object RegExp]"==Object.prototype.toString.call(e)?e.test(t):t instanceof e?!0:e.call({},t)===!0?!0:!1:!1}function d(t,e,n,i){var o;f.isString(n)&&(i=n,n=null);try{e()}catch(r){o=r}if(i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),t&&!o&&s(o,n,"Missing expected exception"+i),!t&&h(o,n)&&s(o,n,"Got unwanted exception"+i),t&&o&&n&&!h(o,n)||!t&&o)throw o}var f=t("util/"),p=Array.prototype.slice,m=Object.prototype.hasOwnProperty,g=e.exports=a;g.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=r(this),this.generatedMessage=!0);var e=t.stackStartFunction||s;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var i=n.stack,o=e.name,a=i.indexOf("\n"+o);if(a>=0){var l=i.indexOf("\n",a+1);i=i.substring(l+1)}this.stack=i}}},f.inherits(g.AssertionError,Error),g.fail=s,g.ok=a,g.equal=function(t,e,n){t!=e&&s(t,e,n,"==",g.equal)},g.notEqual=function(t,e,n){t==e&&s(t,e,n,"!=",g.notEqual)},g.deepEqual=function(t,e,n){l(t,e)||s(t,e,n,"deepEqual",g.deepEqual)},g.notDeepEqual=function(t,e,n){l(t,e)&&s(t,e,n,"notDeepEqual",g.notDeepEqual)},g.strictEqual=function(t,e,n){t!==e&&s(t,e,n,"===",g.strictEqual)},g.notStrictEqual=function(t,e,n){t===e&&s(t,e,n,"!==",g.notStrictEqual)},g["throws"]=function(t,e,n){d.apply(this,[!0].concat(p.call(arguments)))},g.doesNotThrow=function(t,e){d.apply(this,[!1].concat(p.call(arguments)))},g.ifError=function(t){if(t)throw t};var v=Object.keys||function(t){var e=[];for(var n in t)m.call(t,n)&&e.push(n);return e}},{"util/":19}],15:[function(t,e,n){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],16:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var o=t[i];"."===o?t.splice(i,1):".."===o?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(t){return o.exec(t).slice(1)};n.resolve=function(){for(var n="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s=r>=0?arguments[r]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(n=s+"/"+n,o="/"===s.charAt(0))}return n=e(i(n.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+n||"."},n.normalize=function(t){var o=n.isAbsolute(t),r="/"===s(t,-1);return t=e(i(t.split("/"),function(t){return!!t}),!o).join("/"),t||o||(t="."),t&&r&&(t+="/"),(o?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var o=i(t.split("/")),r=i(e.split("/")),s=Math.min(o.length,r.length),a=s,l=0;s>l;l++)if(o[l]!==r[l]){a=l;break}for(var u=[],l=a;l<o.length;l++)u.push("..");return u=u.concat(r.slice(a)),u.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=r(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},n.basename=function(t,e){var n=r(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return r(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:17}],17:[function(t,e,n){function i(){if(!a){a=!0;for(var t,e=s.length;e;){t=s,s=[];for(var n=-1;++n<e;)t[n]();e=s.length}a=!1}}function o(){}var r=e.exports={},s=[],a=!1;r.nextTick=function(t){s.push(t),a||setTimeout(i,0)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=o,r.addListener=o,r.once=o,r.off=o,r.removeListener=o,r.removeAllListeners=o,r.emit=o,r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],18:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],19:[function(t,e,n){(function(e,i){function o(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(e)?i.showHidden=e:e&&n._extend(i,e),w(i.showHidden)&&(i.showHidden=!1),w(i.depth)&&(i.depth=2),w(i.colors)&&(i.colors=!1),w(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=r),l(i,t,i.depth)}function r(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function l(t,e,i){if(t.customInspect&&e&&k(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(i,t);return _(o)||(o=l(t,o,i)),o}var r=u(t,e);if(r)return r;var s=Object.keys(e),m=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),S(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(k(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(T(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return c(e)}var v="",y=!1,b=["{","}"];if(p(e)&&(y=!0,b=["[","]"]),k(e)){var w=e.name?": "+e.name:"";v=" [Function"+w+"]"}if(x(e)&&(v=" "+RegExp.prototype.toString.call(e)),T(e)&&(v=" "+Date.prototype.toUTCString.call(e)),S(e)&&(v=" "+c(e)),0===s.length&&(!y||0==e.length))return b[0]+v+b[1];if(0>i)return x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var L;return L=y?h(t,e,i,m,s):s.map(function(n){return d(t,e,i,m,n,y)}),t.seen.pop(),f(L,v,b)}function u(t,e){if(w(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,i,o){for(var r=[],s=0,a=e.length;a>s;++s)r.push(M(e,String(s))?d(t,e,n,i,String(s),!0):"");return o.forEach(function(o){o.match(/^\d+$/)||r.push(d(t,e,n,i,o,!0))}),r}function d(t,e,n,i,o,r){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),M(i,o)||(s="["+o+"]"),a||(t.seen.indexOf(u.value)<0?(a=g(n)?l(t,u.value,null):l(t,u.value,n-1),a.indexOf("\n")>-1&&(a=r?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(s)){if(r&&o.match(/^\d+$/))return a;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t,e,n){var i=0,o=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function v(t){return null==t}function y(t){return"number"==typeof t}function _(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function w(t){return void 0===t}function x(t){return L(t)&&"[object RegExp]"===C(t)}function L(t){return"object"==typeof t&&null!==t}function T(t){return L(t)&&"[object Date]"===C(t)}function S(t){return L(t)&&("[object Error]"===C(t)||t instanceof Error)}function k(t){return"function"==typeof t}function P(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function C(t){return Object.prototype.toString.call(t)}function E(t){return 10>t?"0"+t.toString(10):t.toString(10)}function D(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var A=/%[sdj%]/g;n.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,r=i.length,s=String(t).replace(A,function(t){if("%%"===t)return"%";if(n>=r)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),a=i[n];r>n;a=i[++n])s+=g(a)||!L(a)?" "+a:" "+o(a);return s},n.deprecate=function(t,o){function r(){if(!s){if(e.throwDeprecation)throw new Error(o);e.traceDeprecation?console.trace(o):console.error(o),s=!0}return t.apply(this,arguments)}if(w(i.process))return function(){return n.deprecate(t,o).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return r};var z,I={};n.debuglog=function(t){if(w(z)&&(z=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!I[t])if(new RegExp("\\b"+t+"\\b","i").test(z)){var i=e.pid;I[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else I[t]=function(){};return I[t]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=p,n.isBoolean=m,n.isNull=g,n.isNullOrUndefined=v,n.isNumber=y,n.isString=_,n.isSymbol=b,n.isUndefined=w,n.isRegExp=x,n.isObject=L,n.isDate=T,n.isError=S,n.isFunction=k,n.isPrimitive=P,n.isBuffer=t("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",D(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!L(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":18,_process:17,inherits:15}],20:[function(t,e,n){function i(){}function o(){var t=new i;return t.init.apply(t,arguments),t}i.prototype.init=function(){if(!arguments.length)throw new Error("no arguments");if(arguments[0].lat&&arguments[0].lng)this.lat=arguments[0].lat,this.lon=arguments[0].lng;else if("string"==typeof arguments[0]){var t=arguments[0].split(",");this.lat=parseFloat(t[0].trim()),this.lon=parseFloat(t[1].trim())}else if("[object Array]"===Object.prototype.toString.call(arguments[0])){var e=arguments[0];arguments[1]===!0?(this.lat=e[1],this.lon=e[0]):(this.lat=e[0],this.lon=e[1])}else arguments[2]===!0?(this.lat=arguments[1],this.lon=arguments[0]):(this.lat=arguments[0],this.lon=arguments[1]);this.compute()},i.prototype.compute=function(){function t(t){var e={};return e.initValue=t,e.degrees=Math.abs(t),e.degreesInt=Math.floor(e.degrees),e.degreesFrac=e.degrees-e.degreesInt,e.secondsTotal=3600*e.degreesFrac,e.minutes=e.secondsTotal/60,e.minutesInt=Math.floor(e.minutes),e.seconds=e.secondsTotal-60*e.minutesInt,e}this.north=this.lat>0,this.east=this.lon>0,this.latValues=t(this.lat),this.lonValues=t(this.lon)};var r={FFf:"DD MM ss X",Ff:"DD mm X",f:"dd X"},s={degrees:"¬∞",minutes:"¬¥",seconds:'"'};i.prototype.format=function(t,e){function n(e,n){var i=t;return i=i.replace(/DD/g,e.degreesInt+s.degrees),i=i.replace(/dd/g,e.degrees.toFixed(5)+s.degrees),i=i.replace(/D/g,e.degreesInt),i=i.replace(/d/g,e.degrees.toFixed(5)),i=i.replace(/MM/g,e.minutesInt+s.minutes),i=i.replace(/mm/g,e.minutes.toFixed(5)+s.minutes),i=i.replace(/M/g,e.minutesInt),i=i.replace(/m/g,e.minutes.toFixed(5)),i=i.replace(/ss/g,e.seconds.toFixed(5)+s.seconds),i=i.replace(/s/g,e.seconds.toFixed(5)),i=i.replace(/-/g,e.initValue<0?"-":""),i=i.replace(/X/g,n)}t||(t="FFf"),e||(e=" "),Object.keys(r).indexOf(t)>-1&&(t=r[t]);var i=n(this.latValues,this.north?"N":"S"),o=n(this.lonValues,this.east?"E":"W");return i+e+o},e.exports=o},{}],21:[function(t,e,n){!function(t,n){"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(t)}("undefined"!=typeof window?window:this,function(t,e){function n(t){var e="length"in t&&t.length,n=Y.type(t);return"function"===n||Y.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t}function i(t,e,n){if(Y.isFunction(e))return Y.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return Y.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(at.test(e))return Y.filter(e,t,n);e=Y.filter(e,t)}return Y.grep(t,function(t){return G.call(e,t)>=0!==n})}function o(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function r(t){var e=pt[t]={};return Y.each(t.match(ft)||[],function(t,n){e[n]=!0}),e}function s(){K.removeEventListener("DOMContentLoaded",s,!1),t.removeEventListener("load",s,!1),Y.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Y.expando+a.uid++}function l(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(bt,"-$1").toLowerCase(),n=t.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:_t.test(n)?Y.parseJSON(n):n}catch(o){}yt.set(t,e,n)}else n=void 0;return n}function u(){return!0}function c(){return!1}function h(){try{return K.activeElement}catch(t){}}function d(t,e){return Y.nodeName(t,"table")&&Y.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function f(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function p(t){var e=Nt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function m(t,e){for(var n=0,i=t.length;i>n;n++)vt.set(t[n],"globalEval",!e||vt.get(e[n],"globalEval"))}function g(t,e){var n,i,o,r,s,a,l,u;if(1===e.nodeType){if(vt.hasData(t)&&(r=vt.access(t),s=vt.set(e,r),u=r.events)){delete s.handle,s.events={};for(o in u)for(n=0,i=u[o].length;i>n;n++)Y.event.add(e,o,u[o][n])}yt.hasData(t)&&(a=yt.access(t),l=Y.extend({},a),yt.set(e,l))}}function v(t,e){var n=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&Y.nodeName(t,e)?Y.merge([t],n):n}function y(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Tt.test(t.type)?e.checked=t.checked:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}function _(e,n){var i,o=Y(n.createElement(e)).appendTo(n.body),r=t.getDefaultComputedStyle&&(i=t.getDefaultComputedStyle(o[0]))?i.display:Y.css(o[0],"display");return o.detach(),r}function b(t){var e=K,n=Ft[t];return n||(n=_(t,e),"none"!==n&&n||(qt=(qt||Y("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=qt[0].contentDocument,e.write(),e.close(),n=_(t,e),qt.detach()),Ft[t]=n),n}function w(t,e,n){var i,o,r,s,a=t.style;return n=n||Ht(t),n&&(s=n.getPropertyValue(e)||n[e]),n&&(""!==s||Y.contains(t.ownerDocument,t)||(s=Y.style(t,e)),Bt.test(s)&&Ut.test(e)&&(i=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function x(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function L(t,e){if(e in t)return e;for(var n=e[0].toUpperCase()+e.slice(1),i=e,o=Xt.length;o--;)if(e=Xt[o]+n,e in t)return e;return i}function T(t,e,n){var i=Wt.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function S(t,e,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===e?1:0,s=0;4>r;r+=2)"margin"===n&&(s+=Y.css(t,n+xt[r],!0,o)),i?("content"===n&&(s-=Y.css(t,"padding"+xt[r],!0,o)),"margin"!==n&&(s-=Y.css(t,"border"+xt[r]+"Width",!0,o))):(s+=Y.css(t,"padding"+xt[r],!0,o),"padding"!==n&&(s+=Y.css(t,"border"+xt[r]+"Width",!0,o)));return s}function k(t,e,n){var i=!0,o="width"===e?t.offsetWidth:t.offsetHeight,r=Ht(t),s="border-box"===Y.css(t,"boxSizing",!1,r);if(0>=o||null==o){if(o=w(t,e,r),(0>o||null==o)&&(o=t.style[e]),Bt.test(o))return o;i=s&&($.boxSizingReliable()||o===t.style[e]),o=parseFloat(o)||0}return o+S(t,e,n||(s?"border":"content"),i,r)+"px"}function P(t,e){for(var n,i,o,r=[],s=0,a=t.length;a>s;s++)i=t[s],i.style&&(r[s]=vt.get(i,"olddisplay"),n=i.style.display,e?(r[s]||"none"!==n||(i.style.display=""),""===i.style.display&&Lt(i)&&(r[s]=vt.access(i,"olddisplay",b(i.nodeName)))):(o=Lt(i),"none"===n&&o||vt.set(i,"olddisplay",o?n:Y.css(i,"display"))));for(s=0;a>s;s++)i=t[s],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?r[s]||"":"none"));return t}function C(t,e,n,i,o){return new C.prototype.init(t,e,n,i,o)}function E(){return setTimeout(function(){$t=void 0}),$t=Y.now()}function D(t,e){var n,i=0,o={height:t};for(e=e?1:0;4>i;i+=2-e)n=xt[i],o["margin"+n]=o["padding"+n]=t;return e&&(o.opacity=o.width=t),o}function M(t,e,n){for(var i,o=(ne[e]||[]).concat(ne["*"]),r=0,s=o.length;s>r;r++)if(i=o[r].call(n,e,t))return i}function A(t,e,n){var i,o,r,s,a,l,u,c,h=this,d={},f=t.style,p=t.nodeType&&Lt(t),m=vt.get(t,"fxshow");n.queue||(a=Y._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,Y.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],u=Y.css(t,"display"),c="none"===u?vt.get(t,"olddisplay")||b(t.nodeName):u,"inline"===c&&"none"===Y.css(t,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in e)if(o=e[i],Qt.exec(o)){if(delete e[i],r=r||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;p=!0}d[i]=m&&m[i]||Y.style(t,i)}else u=void 0;if(Y.isEmptyObject(d))"inline"===("none"===u?b(t.nodeName):u)&&(f.display=u);else{m?"hidden"in m&&(p=m.hidden):m=vt.access(t,"fxshow",{}),r&&(m.hidden=!p),p?Y(t).show():h.done(function(){Y(t).hide()}),h.done(function(){var e;vt.remove(t,"fxshow");for(e in d)Y.style(t,e,d[e])});for(i in d)s=M(p?m[i]:0,i,h),i in m||(m[i]=s.start,p&&(s.end=s.start,s.start="width"===i||"height"===i?1:0))}}function z(t,e){var n,i,o,r,s;for(n in t)if(i=Y.camelCase(n),o=e[i],r=t[n],Y.isArray(r)&&(o=r[1],r=t[n]=r[0]),n!==i&&(t[i]=r,delete t[n]),s=Y.cssHooks[i],s&&"expand"in s){r=s.expand(r),delete t[i];for(n in r)n in t||(t[n]=r[n],e[n]=o)}else e[i]=o}function I(t,e,n){var i,o,r=0,s=ee.length,a=Y.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=$t||E(),n=Math.max(0,u.startTime+u.duration-e),i=n/u.duration||0,r=1-i,s=0,l=u.tweens.length;l>s;s++)u.tweens[s].run(r);return a.notifyWith(t,[u,r,n]),1>r&&l?n:(a.resolveWith(t,[u]),!1)},u=a.promise({elem:t,props:Y.extend({},e),opts:Y.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:$t||E(),duration:n.duration,tweens:[],createTween:function(e,n){var i=Y.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var n=0,i=e?u.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)u.tweens[n].run(1);return e?a.resolveWith(t,[u,e]):a.rejectWith(t,[u,e]),this}}),c=u.props;for(z(c,u.opts.specialEasing);s>r;r++)if(i=ee[r].call(u,t,c,u.opts))return i;return Y.map(c,M,u),Y.isFunction(u.opts.start)&&u.opts.start.call(t,u),Y.fx.timer(Y.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function O(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,r=e.toLowerCase().match(ft)||[];if(Y.isFunction(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function N(t,e,n,i){
function o(a){var l;return r[a]=!0,Y.each(t[a]||[],function(t,a){var u=a(e,n,i);return"string"!=typeof u||s||r[u]?s?!(l=u):void 0:(e.dataTypes.unshift(u),o(u),!1)}),l}var r={},s=t===_e;return o(e.dataTypes[0])||!r["*"]&&o("*")}function R(t,e){var n,i,o=Y.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((o[n]?t:i||(i={}))[n]=e[n]);return i&&Y.extend(!0,t,i),t}function j(t,e,n){for(var i,o,r,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(o in a)if(a[o]&&a[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}s||(s=o)}r=r||s}return r?(r!==l[0]&&l.unshift(r),n[r]):void 0}function q(t,e,n,i){var o,r,s,a,l,u={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)u[s.toLowerCase()]=t.converters[s];for(r=c.shift();r;)if(t.responseFields[r]&&(n[t.responseFields[r]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=c.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(s=u[l+" "+r]||u["* "+r],!s)for(o in u)if(a=o.split(" "),a[1]===r&&(s=u[l+" "+a[0]]||u["* "+a[0]])){s===!0?s=u[o]:u[o]!==!0&&(r=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&t["throws"])e=s(e);else try{e=s(e)}catch(h){return{state:"parsererror",error:s?h:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}function F(t,e,n,i){var o;if(Y.isArray(e))Y.each(e,function(e,o){n||Te.test(t)?i(t,o):F(t+"["+("object"==typeof o?e:"")+"]",o,n,i)});else if(n||"object"!==Y.type(e))i(t,e);else for(o in e)F(t+"["+o+"]",e[o],n,i)}function U(t){return Y.isWindow(t)?t:9===t.nodeType&&t.defaultView}var B=[],H=B.slice,Z=B.concat,W=B.push,G=B.indexOf,V={},J=V.toString,X=V.hasOwnProperty,$={},K=t.document,Q="2.1.4",Y=function(t,e){return new Y.fn.init(t,e)},tt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,et=/^-ms-/,nt=/-([\da-z])/gi,it=function(t,e){return e.toUpperCase()};Y.fn=Y.prototype={jquery:Q,constructor:Y,selector:"",length:0,toArray:function(){return H.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:H.call(this)},pushStack:function(t){var e=Y.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return Y.each(this,t,e)},map:function(t){return this.pushStack(Y.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(H.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:W,sort:B.sort,splice:B.splice},Y.extend=Y.fn.extend=function(){var t,e,n,i,o,r,s=arguments[0]||{},a=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[a]||{},a++),"object"==typeof s||Y.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(t=arguments[a]))for(e in t)n=s[e],i=t[e],s!==i&&(u&&i&&(Y.isPlainObject(i)||(o=Y.isArray(i)))?(o?(o=!1,r=n&&Y.isArray(n)?n:[]):r=n&&Y.isPlainObject(n)?n:{},s[e]=Y.extend(u,r,i)):void 0!==i&&(s[e]=i));return s},Y.extend({expando:"jQuery"+(Q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===Y.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!Y.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"!==Y.type(t)||t.nodeType||Y.isWindow(t)?!1:t.constructor&&!X.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?V[J.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;t=Y.trim(t),t&&(1===t.indexOf("use strict")?(e=K.createElement("script"),e.text=t,K.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(et,"ms-").replace(nt,it)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var o,r=0,s=t.length,a=n(t);if(i){if(a)for(;s>r&&(o=e.apply(t[r],i),o!==!1);r++);else for(r in t)if(o=e.apply(t[r],i),o===!1)break}else if(a)for(;s>r&&(o=e.call(t[r],r,t[r]),o!==!1);r++);else for(r in t)if(o=e.call(t[r],r,t[r]),o===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(tt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?Y.merge(i,"string"==typeof t?[t]:t):W.call(i,t)),i},inArray:function(t,e,n){return null==e?-1:G.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,o=t.length;n>i;i++)t[o++]=e[i];return t.length=o,t},grep:function(t,e,n){for(var i,o=[],r=0,s=t.length,a=!n;s>r;r++)i=!e(t[r],r),i!==a&&o.push(t[r]);return o},map:function(t,e,i){var o,r=0,s=t.length,a=n(t),l=[];if(a)for(;s>r;r++)o=e(t[r],r,i),null!=o&&l.push(o);else for(r in t)o=e(t[r],r,i),null!=o&&l.push(o);return Z.apply([],l)},guid:1,proxy:function(t,e){var n,i,o;return"string"==typeof e&&(n=t[e],e=t,t=n),Y.isFunction(t)?(i=H.call(arguments,2),o=function(){return t.apply(e||this,i.concat(H.call(arguments)))},o.guid=t.guid=t.guid||Y.guid++,o):void 0},now:Date.now,support:$}),Y.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){V["[object "+e+"]"]=e.toLowerCase()});var ot=function(t){function e(t,e,n,i){var o,r,s,a,l,u,h,f,p,m;if((e?e.ownerDocument||e:F)!==A&&M(e),e=e||A,n=n||[],a=e.nodeType,"string"!=typeof t||!t||1!==a&&9!==a&&11!==a)return n;if(!i&&I){if(11!==a&&(o=yt.exec(t)))if(s=o[1]){if(9===a){if(r=e.getElementById(s),!r||!r.parentNode)return n;if(r.id===s)return n.push(r),n}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(s))&&j(e,r)&&r.id===s)return n.push(r),n}else{if(o[2])return Q.apply(n,e.getElementsByTagName(t)),n;if((s=o[3])&&w.getElementsByClassName)return Q.apply(n,e.getElementsByClassName(s)),n}if(w.qsa&&(!O||!O.test(t))){if(f=h=q,p=e,m=1!==a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(u=S(t),(h=e.getAttribute("id"))?f=h.replace(bt,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",l=u.length;l--;)u[l]=f+d(u[l]);p=_t.test(t)&&c(e.parentNode)||e,m=u.join(",")}if(m)try{return Q.apply(n,p.querySelectorAll(m)),n}catch(g){}finally{h||e.removeAttribute("id")}}}return P(t.replace(lt,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>x.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[q]=!0,t}function o(t){var e=A.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var n=t.split("|"),i=t.length;i--;)x.attrHandle[n[i]]=e}function s(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||V)-(~t.sourceIndex||V);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function a(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function l(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function u(t){return i(function(e){return e=+e,i(function(n,i){for(var o,r=t([],n.length,e),s=r.length;s--;)n[o=r[s]]&&(n[o]=!(i[o]=n[o]))})})}function c(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function h(){}function d(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function f(t,e,n){var i=e.dir,o=n&&"parentNode"===i,r=B++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,r)}:function(e,n,s){var a,l,u=[U,r];if(s){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,s))return!0}else for(;e=e[i];)if(1===e.nodeType||o){if(l=e[q]||(e[q]={}),(a=l[i])&&a[0]===U&&a[1]===r)return u[2]=a[2];if(l[i]=u,u[2]=t(e,n,s))return!0}}}function p(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function m(t,n,i){for(var o=0,r=n.length;r>o;o++)e(t,n[o],i);return i}function g(t,e,n,i,o){for(var r,s=[],a=0,l=t.length,u=null!=e;l>a;a++)(r=t[a])&&(!n||n(r,i,o))&&(s.push(r),u&&e.push(a));return s}function v(t,e,n,o,r,s){return o&&!o[q]&&(o=v(o)),r&&!r[q]&&(r=v(r,s)),i(function(i,s,a,l){var u,c,h,d=[],f=[],p=s.length,v=i||m(e||"*",a.nodeType?[a]:a,[]),y=!t||!i&&e?v:g(v,d,t,a,l),_=n?r||(i?t:p||o)?[]:s:y;if(n&&n(y,_,a,l),o)for(u=g(_,f),o(u,[],a,l),c=u.length;c--;)(h=u[c])&&(_[f[c]]=!(y[f[c]]=h));if(i){if(r||t){if(r){for(u=[],c=_.length;c--;)(h=_[c])&&u.push(y[c]=h);r(null,_=[],u,l)}for(c=_.length;c--;)(h=_[c])&&(u=r?tt(i,h):d[c])>-1&&(i[u]=!(s[u]=h))}}else _=g(_===s?_.splice(p,_.length):_),r?r(null,s,_,l):Q.apply(s,_)})}function y(t){for(var e,n,i,o=t.length,r=x.relative[t[0].type],s=r||x.relative[" "],a=r?1:0,l=f(function(t){return t===e},s,!0),u=f(function(t){return tt(e,t)>-1},s,!0),c=[function(t,n,i){var o=!r&&(i||n!==C)||((e=n).nodeType?l(t,n,i):u(t,n,i));return e=null,o}];o>a;a++)if(n=x.relative[t[a].type])c=[f(p(c),n)];else{if(n=x.filter[t[a].type].apply(null,t[a].matches),n[q]){for(i=++a;o>i&&!x.relative[t[i].type];i++);return v(a>1&&p(c),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(lt,"$1"),n,i>a&&y(t.slice(a,i)),o>i&&y(t=t.slice(i)),o>i&&d(t))}c.push(n)}return p(c)}function _(t,n){var o=n.length>0,r=t.length>0,s=function(i,s,a,l,u){var c,h,d,f=0,p="0",m=i&&[],v=[],y=C,_=i||r&&x.find.TAG("*",u),b=U+=null==y?1:Math.random()||.1,w=_.length;for(u&&(C=s!==A&&s);p!==w&&null!=(c=_[p]);p++){if(r&&c){for(h=0;d=t[h++];)if(d(c,s,a)){l.push(c);break}u&&(U=b)}o&&((c=!d&&c)&&f--,i&&m.push(c))}if(f+=p,o&&p!==f){for(h=0;d=n[h++];)d(m,v,s,a);if(i){if(f>0)for(;p--;)m[p]||v[p]||(v[p]=$.call(l));v=g(v)}Q.apply(l,v),u&&!i&&v.length>0&&f+n.length>1&&e.uniqueSort(l)}return u&&(U=b,C=y),m};return o?i(s):s}var b,w,x,L,T,S,k,P,C,E,D,M,A,z,I,O,N,R,j,q="sizzle"+1*new Date,F=t.document,U=0,B=0,H=n(),Z=n(),W=n(),G=function(t,e){return t===e&&(D=!0),0},V=1<<31,J={}.hasOwnProperty,X=[],$=X.pop,K=X.push,Q=X.push,Y=X.slice,tt=function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=it.replace("w","w#"),rt="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ot+"))|)"+nt+"*\\]",st=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",at=new RegExp(nt+"+","g"),lt=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ut=new RegExp("^"+nt+"*,"+nt+"*"),ct=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ht=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),dt=new RegExp(st),ft=new RegExp("^"+ot+"$"),pt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+st),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_t=/[+~]/,bt=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),xt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Lt=function(){M()};try{Q.apply(X=Y.call(F.childNodes),F.childNodes),X[F.childNodes.length].nodeType}catch(Tt){Q={apply:X.length?function(t,e){K.apply(t,Y.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}w=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},M=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:F;return i!==A&&9===i.nodeType&&i.documentElement?(A=i,z=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",Lt,!1):n.attachEvent&&n.attachEvent("onunload",Lt)),I=!T(i),w.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=o(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=vt.test(i.getElementsByClassName),w.getById=o(function(t){return z.appendChild(t).id=q,!i.getElementsByName||!i.getElementsByName(q).length}),w.getById?(x.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&I){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},x.filter.ID=function(t){var e=t.replace(wt,xt);return function(t){return t.getAttribute("id")===e}}):(delete x.find.ID,x.filter.ID=function(t){var e=t.replace(wt,xt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),x.find.TAG=w.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},x.find.CLASS=w.getElementsByClassName&&function(t,e){return I?e.getElementsByClassName(t):void 0},N=[],O=[],(w.qsa=vt.test(i.querySelectorAll))&&(o(function(t){z.appendChild(t).innerHTML="<a id='"+q+"'></a><select id='"+q+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||O.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+q+"-]").length||O.push("~="),t.querySelectorAll(":checked").length||O.push(":checked"),t.querySelectorAll("a#"+q+"+*").length||O.push(".#.+[+~]")}),o(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&O.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),O.push(",.*:")})),(w.matchesSelector=vt.test(R=z.matches||z.webkitMatchesSelector||z.mozMatchesSelector||z.oMatchesSelector||z.msMatchesSelector))&&o(function(t){w.disconnectedMatch=R.call(t,"div"),R.call(t,"[s!='']:x"),N.push("!=",st)}),O=O.length&&new RegExp(O.join("|")),N=N.length&&new RegExp(N.join("|")),e=vt.test(z.compareDocumentPosition),j=e||vt.test(z.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},G=e?function(t,e){if(t===e)return D=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!w.sortDetached&&e.compareDocumentPosition(t)===n?t===i||t.ownerDocument===F&&j(F,t)?-1:e===i||e.ownerDocument===F&&j(F,e)?1:E?tt(E,t)-tt(E,e):0:4&n?-1:1)}:function(t,e){if(t===e)return D=!0,0;var n,o=0,r=t.parentNode,a=e.parentNode,l=[t],u=[e];if(!r||!a)return t===i?-1:e===i?1:r?-1:a?1:E?tt(E,t)-tt(E,e):0;if(r===a)return s(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)u.unshift(n);for(;l[o]===u[o];)o++;return o?s(l[o],u[o]):l[o]===F?-1:u[o]===F?1:0},i):A},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==A&&M(t),n=n.replace(ht,"='$1']"),!(!w.matchesSelector||!I||N&&N.test(n)||O&&O.test(n)))try{var i=R.call(t,n);if(i||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(o){}return e(n,A,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==A&&M(t),j(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==A&&M(t);var n=x.attrHandle[e.toLowerCase()],i=n&&J.call(x.attrHandle,e.toLowerCase())?n(t,e,!I):void 0;return void 0!==i?i:w.attributes||!I?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,o=0;if(D=!w.detectDuplicates,E=!w.sortStable&&t.slice(0),t.sort(G),D){for(;e=t[o++];)e===t[o]&&(i=n.push(o));for(;i--;)t.splice(n[i],1)}return E=null,t},L=e.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=L(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=L(e);return n},x=e.selectors={cacheLength:50,createPseudo:i,match:pt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,xt),t[3]=(t[3]||t[4]||t[5]||"").replace(wt,xt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return pt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&dt.test(n)&&(e=S(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(wt,xt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&H(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(o){var r=e.attr(o,t);return null==r?"!="===n:n?(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(at," ")+" ").indexOf(i)>-1:"|="===n?r===i||r.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(t,e,n,i,o){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var u,c,h,d,f,p,m=r!==s?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a;if(g){if(r){for(;m;){for(h=e;h=h[m];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[s?g.firstChild:g.lastChild],s&&y){for(c=g[q]||(g[q]={}),u=c[t]||[],f=u[0]===U&&u[1],d=u[0]===U&&u[2],h=f&&g.childNodes[f];h=++f&&h&&h[m]||(d=f=0)||p.pop();)if(1===h.nodeType&&++d&&h===e){c[t]=[U,f,d];break}}else if(y&&(u=(e[q]||(e[q]={}))[t])&&u[0]===U)d=u[1];else for(;(h=++f&&h&&h[m]||(d=f=0)||p.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[q]||(h[q]={}))[t]=[U,d]),h!==e)););return d-=o,d===i||d%i===0&&d/i>=0}}},PSEUDO:function(t,n){var o,r=x.pseudos[t]||x.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[q]?r(n):r.length>1?(o=[t,t,"",n],x.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,o=r(t,n),s=o.length;s--;)i=tt(t,o[s]),t[i]=!(e[i]=o[s])}):function(t){return r(t,0,o)}):r}},pseudos:{not:i(function(t){var e=[],n=[],o=k(t.replace(lt,"$1"));return o[q]?i(function(t,e,n,i){for(var r,s=o(t,null,i,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))}):function(t,i,r){return e[0]=t,o(e,null,r,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(wt,xt),function(e){return(e.textContent||e.innerText||L(e)).indexOf(t)>-1}}),lang:i(function(t){return ft.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(wt,xt).toLowerCase(),function(e){var n;do if(n=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===z},focus:function(t){return t===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,n){return[0>n?n+e:n]}),even:u(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:u(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:u(function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:u(function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t})}},x.pseudos.nth=x.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[b]=a(b);for(b in{submit:!0,reset:!0})x.pseudos[b]=l(b);return h.prototype=x.filters=x.pseudos,x.setFilters=new h,S=e.tokenize=function(t,n){var i,o,r,s,a,l,u,c=Z[t+" "];if(c)return n?0:c.slice(0);for(a=t,l=[],u=x.preFilter;a;){(!i||(o=ut.exec(a)))&&(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),i=!1,(o=ct.exec(a))&&(i=o.shift(),r.push({value:i,type:o[0].replace(lt," ")}),a=a.slice(i.length));for(s in x.filter)!(o=pt[s].exec(a))||u[s]&&!(o=u[s](o))||(i=o.shift(),r.push({value:i,type:s,matches:o}),a=a.slice(i.length));if(!i)break}return n?a.length:a?e.error(t):Z(t,l).slice(0)},k=e.compile=function(t,e){var n,i=[],o=[],r=W[t+" "];if(!r){for(e||(e=S(t)),n=e.length;n--;)r=y(e[n]),r[q]?i.push(r):o.push(r);r=W(t,_(o,i)),r.selector=t}return r},P=e.select=function(t,e,n,i){var o,r,s,a,l,u="function"==typeof t&&t,h=!i&&S(t=u.selector||t);if(n=n||[],1===h.length){if(r=h[0]=h[0].slice(0),r.length>2&&"ID"===(s=r[0]).type&&w.getById&&9===e.nodeType&&I&&x.relative[r[1].type]){if(e=(x.find.ID(s.matches[0].replace(wt,xt),e)||[])[0],!e)return n;u&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(o=pt.needsContext.test(t)?0:r.length;o--&&(s=r[o],!x.relative[a=s.type]);)if((l=x.find[a])&&(i=l(s.matches[0].replace(wt,xt),_t.test(r[0].type)&&c(e.parentNode)||e))){if(r.splice(o,1),t=i.length&&d(r),!t)return Q.apply(n,i),n;break}}return(u||k(t,h))(i,e,!I,n,_t.test(t)&&c(e.parentNode)||e),n},w.sortStable=q.split("").sort(G).join("")===q,w.detectDuplicates=!!D,M(),w.sortDetached=o(function(t){return 1&t.compareDocumentPosition(A.createElement("div"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||r(et,function(t,e,n){var i;return n?void 0:t[e]===!0?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(t);Y.find=ot,Y.expr=ot.selectors,Y.expr[":"]=Y.expr.pseudos,Y.unique=ot.uniqueSort,Y.text=ot.getText,Y.isXMLDoc=ot.isXML,Y.contains=ot.contains;var rt=Y.expr.match.needsContext,st=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,at=/^.[^:#\[\.,]*$/;Y.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?Y.find.matchesSelector(i,t)?[i]:[]:Y.find.matches(t,Y.grep(e,function(t){return 1===t.nodeType}))},Y.fn.extend({find:function(t){var e,n=this.length,i=[],o=this;if("string"!=typeof t)return this.pushStack(Y(t).filter(function(){for(e=0;n>e;e++)if(Y.contains(o[e],this))return!0}));for(e=0;n>e;e++)Y.find(t,o[e],i);return i=this.pushStack(n>1?Y.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(i(this,t||[],!1))},not:function(t){return this.pushStack(i(this,t||[],!0))},is:function(t){return!!i(this,"string"==typeof t&&rt.test(t)?Y(t):t||[],!1).length}});var lt,ut=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ct=Y.fn.init=function(t,e){var n,i;if(!t)return this;if("string"==typeof t){if(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:ut.exec(t),!n||!n[1]&&e)return!e||e.jquery?(e||lt).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof Y?e[0]:e,Y.merge(this,Y.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:K,!0)),st.test(n[1])&&Y.isPlainObject(e))for(n in e)Y.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return i=K.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=K,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):Y.isFunction(t)?"undefined"!=typeof lt.ready?lt.ready(t):t(Y):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),Y.makeArray(t,this))};ct.prototype=Y.fn,lt=Y(K);var ht=/^(?:parents|prev(?:Until|All))/,dt={children:!0,contents:!0,next:!0,prev:!0};Y.extend({dir:function(t,e,n){for(var i=[],o=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&Y(t).is(n))break;i.push(t)}return i},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}}),Y.fn.extend({has:function(t){var e=Y(t,this),n=e.length;return this.filter(function(){for(var t=0;n>t;t++)if(Y.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,i=0,o=this.length,r=[],s=rt.test(t)||"string"!=typeof t?Y(t,e||this.context):0;o>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&Y.find.matchesSelector(n,t))){r.push(n);break}return this.pushStack(r.length>1?Y.unique(r):r)},index:function(t){return t?"string"==typeof t?G.call(Y(t),this[0]):G.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Y.unique(Y.merge(this.get(),Y(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Y.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Y.dir(t,"parentNode")},parentsUntil:function(t,e,n){return Y.dir(t,"parentNode",n)},next:function(t){return o(t,"nextSibling")},prev:function(t){return o(t,"previousSibling")},nextAll:function(t){return Y.dir(t,"nextSibling")},prevAll:function(t){return Y.dir(t,"previousSibling")},nextUntil:function(t,e,n){return Y.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return Y.dir(t,"previousSibling",n)},siblings:function(t){return Y.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return Y.sibling(t.firstChild)},contents:function(t){return t.contentDocument||Y.merge([],t.childNodes)}},function(t,e){Y.fn[t]=function(n,i){var o=Y.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=Y.filter(i,o)),this.length>1&&(dt[t]||Y.unique(o),ht.test(t)&&o.reverse()),this.pushStack(o)}});var ft=/\S+/g,pt={};Y.Callbacks=function(t){t="string"==typeof t?pt[t]||r(t):Y.extend({},t);var e,n,i,o,s,a,l=[],u=!t.once&&[],c=function(r){for(e=t.memory&&r,n=!0,a=o||0,o=0,s=l.length,i=!0;l&&s>a;a++)if(l[a].apply(r[0],r[1])===!1&&t.stopOnFalse){e=!1;break}i=!1,l&&(u?u.length&&c(u.shift()):e?l=[]:h.disable())},h={add:function(){if(l){var n=l.length;!function r(e){Y.each(e,function(e,n){var i=Y.type(n);"function"===i?t.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!==i&&r(n)})}(arguments),i?s=l.length:e&&(o=n,c(e))}return this},remove:function(){return l&&Y.each(arguments,function(t,e){for(var n;(n=Y.inArray(e,l,n))>-1;)l.splice(n,1),i&&(s>=n&&s--,a>=n&&a--)}),this},has:function(t){return t?Y.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=u=e=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,e||h.disable(),this},locked:function(){return!u},fireWith:function(t,e){return!l||n&&!u||(e=e||[],e=[t,e.slice?e.slice():e],i?u.push(e):c(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},Y.extend({Deferred:function(t){var e=[["resolve","done",Y.Callbacks("once memory"),"resolved"],["reject","fail",Y.Callbacks("once memory"),"rejected"],["notify","progress",Y.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return Y.Deferred(function(n){Y.each(e,function(e,r){var s=Y.isFunction(t[e])&&t[e];o[r[1]](function(){var t=s&&s.apply(this,arguments);t&&Y.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r[0]+"With"](this===i?n.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?Y.extend(t,i):i}},o={};return i.pipe=i.then,Y.each(e,function(t,r){var s=r[2],a=r[3];i[r[1]]=s.add,a&&s.add(function(){n=a},e[1^t][2].disable,e[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=s.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(t){var e,n,i,o=0,r=H.call(arguments),s=r.length,a=1!==s||t&&Y.isFunction(t.promise)?s:0,l=1===a?t:Y.Deferred(),u=function(t,n,i){return function(o){n[t]=this,i[t]=arguments.length>1?H.call(arguments):o,i===e?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(s>1)for(e=new Array(s),n=new Array(s),i=new Array(s);s>o;o++)r[o]&&Y.isFunction(r[o].promise)?r[o].promise().done(u(o,i,r)).fail(l.reject).progress(u(o,n,e)):--a;return a||l.resolveWith(i,r),l.promise()}});var mt;Y.fn.ready=function(t){return Y.ready.promise().done(t),this},Y.extend({isReady:!1,readyWait:1,holdReady:function(t){t?Y.readyWait++:Y.ready(!0)},ready:function(t){(t===!0?--Y.readyWait:Y.isReady)||(Y.isReady=!0,t!==!0&&--Y.readyWait>0||(mt.resolveWith(K,[Y]),Y.fn.triggerHandler&&(Y(K).triggerHandler("ready"),Y(K).off("ready"))))}}),Y.ready.promise=function(e){return mt||(mt=Y.Deferred(),"complete"===K.readyState?setTimeout(Y.ready):(K.addEventListener("DOMContentLoaded",s,!1),t.addEventListener("load",s,!1))),mt.promise(e)},Y.ready.promise();var gt=Y.access=function(t,e,n,i,o,r,s){var a=0,l=t.length,u=null==n;if("object"===Y.type(n)){o=!0;for(a in n)Y.access(t,e,a,n[a],!0,r,s)}else if(void 0!==i&&(o=!0,Y.isFunction(i)||(s=!0),u&&(s?(e.call(t,i),e=null):(u=e,e=function(t,e,n){return u.call(Y(t),n)})),e))for(;l>a;a++)e(t[a],n,s?i:i.call(t[a],a,e(t[a],n)));return o?t:u?e.call(t):l?e(t[0],n):r};Y.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},a.uid=1,a.accepts=Y.acceptData,a.prototype={key:function(t){if(!a.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=a.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(i){e[this.expando]=n,Y.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var i,o=this.key(t),r=this.cache[o];if("string"==typeof e)r[e]=n;else if(Y.isEmptyObject(r))Y.extend(this.cache[o],e);else for(i in e)r[i]=e[i];return r},get:function(t,e){var n=this.cache[this.key(t)];return void 0===e?n:n[e]},access:function(t,e,n){var i;return void 0===e||e&&"string"==typeof e&&void 0===n?(i=this.get(t,e),void 0!==i?i:this.get(t,Y.camelCase(e))):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i,o,r=this.key(t),s=this.cache[r];if(void 0===e)this.cache[r]={};else{Y.isArray(e)?i=e.concat(e.map(Y.camelCase)):(o=Y.camelCase(e),e in s?i=[e,o]:(i=o,i=i in s?[i]:i.match(ft)||[])),n=i.length;for(;n--;)delete s[i[n]]}},hasData:function(t){return!Y.isEmptyObject(this.cache[t[this.expando]]||{});

},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var vt=new a,yt=new a,_t=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,bt=/([A-Z])/g;Y.extend({hasData:function(t){return yt.hasData(t)||vt.hasData(t)},data:function(t,e,n){return yt.access(t,e,n)},removeData:function(t,e){yt.remove(t,e)},_data:function(t,e,n){return vt.access(t,e,n)},_removeData:function(t,e){vt.remove(t,e)}}),Y.fn.extend({data:function(t,e){var n,i,o,r=this[0],s=r&&r.attributes;if(void 0===t){if(this.length&&(o=yt.get(r),1===r.nodeType&&!vt.get(r,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(i=s[n].name,0===i.indexOf("data-")&&(i=Y.camelCase(i.slice(5)),l(r,i,o[i])));vt.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each(function(){yt.set(this,t)}):gt(this,function(e){var n,i=Y.camelCase(t);if(r&&void 0===e){if(n=yt.get(r,t),void 0!==n)return n;if(n=yt.get(r,i),void 0!==n)return n;if(n=l(r,i,void 0),void 0!==n)return n}else this.each(function(){var n=yt.get(this,i);yt.set(this,i,e),-1!==t.indexOf("-")&&void 0!==n&&yt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){yt.remove(this,t)})}}),Y.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=vt.get(t,e),n&&(!i||Y.isArray(n)?i=vt.access(t,e,Y.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=Y.queue(t,e),i=n.length,o=n.shift(),r=Y._queueHooks(t,e),s=function(){Y.dequeue(t,e)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===e&&n.unshift("inprogress"),delete r.stop,o.call(t,s,r)),!i&&r&&r.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return vt.get(t,n)||vt.access(t,n,{empty:Y.Callbacks("once memory").add(function(){vt.remove(t,[e+"queue",n])})})}}),Y.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?Y.queue(this[0],t):void 0===e?this:this.each(function(){var n=Y.queue(this,t,e);Y._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&Y.dequeue(this,t)})},dequeue:function(t){return this.each(function(){Y.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,o=Y.Deferred(),r=this,s=this.length,a=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)n=vt.get(r[s],t+"queueHooks"),n&&n.empty&&(i++,n.empty.add(a));return a(),o.promise(e)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xt=["Top","Right","Bottom","Left"],Lt=function(t,e){return t=e||t,"none"===Y.css(t,"display")||!Y.contains(t.ownerDocument,t)},Tt=/^(?:checkbox|radio)$/i;!function(){var t=K.createDocumentFragment(),e=t.appendChild(K.createElement("div")),n=K.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),$.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",$.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var St="undefined";$.focusinBubbles="onfocusin"in t;var kt=/^key/,Pt=/^(?:mouse|pointer|contextmenu)|click/,Ct=/^(?:focusinfocus|focusoutblur)$/,Et=/^([^.]*)(?:\.(.+)|)$/;Y.event={global:{},add:function(t,e,n,i,o){var r,s,a,l,u,c,h,d,f,p,m,g=vt.get(t);if(g)for(n.handler&&(r=n,n=r.handler,o=r.selector),n.guid||(n.guid=Y.guid++),(l=g.events)||(l=g.events={}),(s=g.handle)||(s=g.handle=function(e){return typeof Y!==St&&Y.event.triggered!==e.type?Y.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(ft)||[""],u=e.length;u--;)a=Et.exec(e[u])||[],f=m=a[1],p=(a[2]||"").split(".").sort(),f&&(h=Y.event.special[f]||{},f=(o?h.delegateType:h.bindType)||f,h=Y.event.special[f]||{},c=Y.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&Y.expr.match.needsContext.test(o),namespace:p.join(".")},r),(d=l[f])||(d=l[f]=[],d.delegateCount=0,h.setup&&h.setup.call(t,i,p,s)!==!1||t.addEventListener&&t.addEventListener(f,s,!1)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),o?d.splice(d.delegateCount++,0,c):d.push(c),Y.event.global[f]=!0)},remove:function(t,e,n,i,o){var r,s,a,l,u,c,h,d,f,p,m,g=vt.hasData(t)&&vt.get(t);if(g&&(l=g.events)){for(e=(e||"").match(ft)||[""],u=e.length;u--;)if(a=Et.exec(e[u])||[],f=m=a[1],p=(a[2]||"").split(".").sort(),f){for(h=Y.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,d=l[f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=d.length;r--;)c=d[r],!o&&m!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(r,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));s&&!d.length&&(h.teardown&&h.teardown.call(t,p,g.handle)!==!1||Y.removeEvent(t,f,g.handle),delete l[f])}else for(f in l)Y.event.remove(t,f+e[u],n,i,!0);Y.isEmptyObject(l)&&(delete g.handle,vt.remove(t,"events"))}},trigger:function(e,n,i,o){var r,s,a,l,u,c,h,d=[i||K],f=X.call(e,"type")?e.type:e,p=X.call(e,"namespace")?e.namespace.split("."):[];if(s=a=i=i||K,3!==i.nodeType&&8!==i.nodeType&&!Ct.test(f+Y.event.triggered)&&(f.indexOf(".")>=0&&(p=f.split("."),f=p.shift(),p.sort()),u=f.indexOf(":")<0&&"on"+f,e=e[Y.expando]?e:new Y.Event(f,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:Y.makeArray(n,[e]),h=Y.event.special[f]||{},o||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!o&&!h.noBubble&&!Y.isWindow(i)){for(l=h.delegateType||f,Ct.test(l+f)||(s=s.parentNode);s;s=s.parentNode)d.push(s),a=s;a===(i.ownerDocument||K)&&d.push(a.defaultView||a.parentWindow||t)}for(r=0;(s=d[r++])&&!e.isPropagationStopped();)e.type=r>1?l:h.bindType||f,c=(vt.get(s,"events")||{})[e.type]&&vt.get(s,"handle"),c&&c.apply(s,n),c=u&&s[u],c&&c.apply&&Y.acceptData(s)&&(e.result=c.apply(s,n),e.result===!1&&e.preventDefault());return e.type=f,o||e.isDefaultPrevented()||h._default&&h._default.apply(d.pop(),n)!==!1||!Y.acceptData(i)||u&&Y.isFunction(i[f])&&!Y.isWindow(i)&&(a=i[u],a&&(i[u]=null),Y.event.triggered=f,i[f](),Y.event.triggered=void 0,a&&(i[u]=a)),e.result}},dispatch:function(t){t=Y.event.fix(t);var e,n,i,o,r,s=[],a=H.call(arguments),l=(vt.get(this,"events")||{})[t.type]||[],u=Y.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,t)!==!1){for(s=Y.event.handlers.call(this,t,l),e=0;(o=s[e++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,i=((Y.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,a),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,o,r,s=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(i=[],n=0;a>n;n++)r=e[n],o=r.selector+" ",void 0===i[o]&&(i[o]=r.needsContext?Y(o,this).index(l)>=0:Y.find(o,this,null,[l]).length),i[o]&&i.push(r);i.length&&s.push({elem:l,handlers:i})}return a<e.length&&s.push({elem:this,handlers:e.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,o,r=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||K,i=n.documentElement,o=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[Y.expando])return t;var e,n,i,o=t.type,r=t,s=this.fixHooks[o];for(s||(this.fixHooks[o]=s=Pt.test(o)?this.mouseHooks:kt.test(o)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,t=new Y.Event(r),e=i.length;e--;)n=i[e],t[n]=r[n];return t.target||(t.target=K),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==h()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Y.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return Y.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var o=Y.extend(new Y.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?Y.event.trigger(o,null,e):Y.event.dispatch.call(e,o),o.isDefaultPrevented()&&n.preventDefault()}},Y.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},Y.Event=function(t,e){return this instanceof Y.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?u:c):this.type=t,e&&Y.extend(this,e),this.timeStamp=t&&t.timeStamp||Y.now(),void(this[Y.expando]=!0)):new Y.Event(t,e)},Y.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=u,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=u,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=u,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},Y.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){Y.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,o=t.relatedTarget,r=t.handleObj;return(!o||o!==i&&!Y.contains(i,o))&&(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),$.focusinBubbles||Y.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){Y.event.simulate(e,t.target,Y.event.fix(t),!0)};Y.event.special[e]={setup:function(){var i=this.ownerDocument||this,o=vt.access(i,e);o||i.addEventListener(t,n,!0),vt.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=vt.access(i,e)-1;o?vt.access(i,e,o):(i.removeEventListener(t,n,!0),vt.remove(i,e))}}}),Y.fn.extend({on:function(t,e,n,i,o){var r,s;if("object"==typeof t){"string"!=typeof e&&(n=n||e,e=void 0);for(s in t)this.on(s,e,n,t[s],o);return this}if(null==n&&null==i?(i=e,n=e=void 0):null==i&&("string"==typeof e?(i=n,n=void 0):(i=n,n=e,e=void 0)),i===!1)i=c;else if(!i)return this;return 1===o&&(r=i,i=function(t){return Y().off(t),r.apply(this,arguments)},i.guid=r.guid||(r.guid=Y.guid++)),this.each(function(){Y.event.add(this,t,i,n,e)})},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,Y(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return(e===!1||"function"==typeof e)&&(n=e,e=void 0),n===!1&&(n=c),this.each(function(){Y.event.remove(this,t,n,e)})},trigger:function(t,e){return this.each(function(){Y.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?Y.event.trigger(t,e,n,!0):void 0}});var Dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Mt=/<([\w:]+)/,At=/<|&#?\w+;/,zt=/<(?:script|style|link)/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Ot=/^$|\/(?:java|ecma)script/i,Nt=/^true\/(.*)/,Rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,jt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};jt.optgroup=jt.option,jt.tbody=jt.tfoot=jt.colgroup=jt.caption=jt.thead,jt.th=jt.td,Y.extend({clone:function(t,e,n){var i,o,r,s,a=t.cloneNode(!0),l=Y.contains(t.ownerDocument,t);if(!($.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Y.isXMLDoc(t)))for(s=v(a),r=v(t),i=0,o=r.length;o>i;i++)y(r[i],s[i]);if(e)if(n)for(r=r||v(t),s=s||v(a),i=0,o=r.length;o>i;i++)g(r[i],s[i]);else g(t,a);return s=v(a,"script"),s.length>0&&m(s,!l&&v(t,"script")),a},buildFragment:function(t,e,n,i){for(var o,r,s,a,l,u,c=e.createDocumentFragment(),h=[],d=0,f=t.length;f>d;d++)if(o=t[d],o||0===o)if("object"===Y.type(o))Y.merge(h,o.nodeType?[o]:o);else if(At.test(o)){for(r=r||c.appendChild(e.createElement("div")),s=(Mt.exec(o)||["",""])[1].toLowerCase(),a=jt[s]||jt._default,r.innerHTML=a[1]+o.replace(Dt,"<$1></$2>")+a[2],u=a[0];u--;)r=r.lastChild;Y.merge(h,r.childNodes),r=c.firstChild,r.textContent=""}else h.push(e.createTextNode(o));for(c.textContent="",d=0;o=h[d++];)if((!i||-1===Y.inArray(o,i))&&(l=Y.contains(o.ownerDocument,o),r=v(c.appendChild(o),"script"),l&&m(r),n))for(u=0;o=r[u++];)Ot.test(o.type||"")&&n.push(o);return c},cleanData:function(t){for(var e,n,i,o,r=Y.event.special,s=0;void 0!==(n=t[s]);s++){if(Y.acceptData(n)&&(o=n[vt.expando],o&&(e=vt.cache[o]))){if(e.events)for(i in e.events)r[i]?Y.event.remove(n,i):Y.removeEvent(n,i,e.handle);vt.cache[o]&&delete vt.cache[o]}delete yt.cache[n[yt.expando]]}}}),Y.fn.extend({text:function(t){return gt(this,function(t){return void 0===t?Y.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,i=t?Y.filter(t,this):this,o=0;null!=(n=i[o]);o++)e||1!==n.nodeType||Y.cleanData(v(n)),n.parentNode&&(e&&Y.contains(n.ownerDocument,n)&&m(v(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Y.cleanData(v(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return Y.clone(this,t,e)})},html:function(t){return gt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!zt.test(t)&&!jt[(Mt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Dt,"<$1></$2>");try{for(;i>n;n++)e=this[n]||{},1===e.nodeType&&(Y.cleanData(v(e,!1)),e.innerHTML=t);e=0}catch(o){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,Y.cleanData(v(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=Z.apply([],t);var n,i,o,r,s,a,l=0,u=this.length,c=this,h=u-1,d=t[0],m=Y.isFunction(d);if(m||u>1&&"string"==typeof d&&!$.checkClone&&It.test(d))return this.each(function(n){var i=c.eq(n);m&&(t[0]=d.call(this,n,i.html())),i.domManip(t,e)});if(u&&(n=Y.buildFragment(t,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(o=Y.map(v(n,"script"),f),r=o.length;u>l;l++)s=n,l!==h&&(s=Y.clone(s,!0,!0),r&&Y.merge(o,v(s,"script"))),e.call(this[l],s,l);if(r)for(a=o[o.length-1].ownerDocument,Y.map(o,p),l=0;r>l;l++)s=o[l],Ot.test(s.type||"")&&!vt.access(s,"globalEval")&&Y.contains(a,s)&&(s.src?Y._evalUrl&&Y._evalUrl(s.src):Y.globalEval(s.textContent.replace(Rt,"")))}return this}}),Y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){Y.fn[t]=function(t){for(var n,i=[],o=Y(t),r=o.length-1,s=0;r>=s;s++)n=s===r?this:this.clone(!0),Y(o[s])[e](n),W.apply(i,n.get());return this.pushStack(i)}});var qt,Ft={},Ut=/^margin/,Bt=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),Ht=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):t.getComputedStyle(e,null)};!function(){function e(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",o.appendChild(r);var e=t.getComputedStyle(s,null);n="1%"!==e.top,i="4px"===e.width,o.removeChild(r)}var n,i,o=K.documentElement,r=K.createElement("div"),s=K.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",$.clearCloneStyle="content-box"===s.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(s),t.getComputedStyle&&Y.extend($,{pixelPosition:function(){return e(),n},boxSizingReliable:function(){return null==i&&e(),i},reliableMarginRight:function(){var e,n=s.appendChild(K.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",o.appendChild(r),e=!parseFloat(t.getComputedStyle(n,null).marginRight),o.removeChild(r),s.removeChild(n),e}}))}(),Y.swap=function(t,e,n,i){var o,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];o=n.apply(t,i||[]);for(r in e)t.style[r]=s[r];return o};var Zt=/^(none|table(?!-c[ea]).+)/,Wt=new RegExp("^("+wt+")(.*)$","i"),Gt=new RegExp("^([+-])=("+wt+")","i"),Vt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];Y.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=w(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,s,a=Y.camelCase(e),l=t.style;return e=Y.cssProps[a]||(Y.cssProps[a]=L(l,a)),s=Y.cssHooks[e]||Y.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(o=s.get(t,!1,i))?o:l[e]:(r=typeof n,"string"===r&&(o=Gt.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(Y.css(t,e)),r="number"),null!=n&&n===n&&("number"!==r||Y.cssNumber[a]||(n+="px"),$.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l[e]=n)),void 0)}},css:function(t,e,n,i){var o,r,s,a=Y.camelCase(e);return e=Y.cssProps[a]||(Y.cssProps[a]=L(t.style,a)),s=Y.cssHooks[e]||Y.cssHooks[a],s&&"get"in s&&(o=s.get(t,!0,n)),void 0===o&&(o=w(t,e,i)),"normal"===o&&e in Jt&&(o=Jt[e]),""===n||n?(r=parseFloat(o),n===!0||Y.isNumeric(r)?r||0:o):o}}),Y.each(["height","width"],function(t,e){Y.cssHooks[e]={get:function(t,n,i){return n?Zt.test(Y.css(t,"display"))&&0===t.offsetWidth?Y.swap(t,Vt,function(){return k(t,e,i)}):k(t,e,i):void 0},set:function(t,n,i){var o=i&&Ht(t);return T(t,n,i?S(t,e,i,"border-box"===Y.css(t,"boxSizing",!1,o),o):0)}}}),Y.cssHooks.marginRight=x($.reliableMarginRight,function(t,e){return e?Y.swap(t,{display:"inline-block"},w,[t,"marginRight"]):void 0}),Y.each({margin:"",padding:"",border:"Width"},function(t,e){Y.cssHooks[t+e]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];4>i;i++)o[t+xt[i]+e]=r[i]||r[i-2]||r[0];return o}},Ut.test(t)||(Y.cssHooks[t+e].set=T)}),Y.fn.extend({css:function(t,e){return gt(this,function(t,e,n){var i,o,r={},s=0;if(Y.isArray(e)){for(i=Ht(t),o=e.length;o>s;s++)r[e[s]]=Y.css(t,e[s],!1,i);return r}return void 0!==n?Y.style(t,e,n):Y.css(t,e)},t,e,arguments.length>1)},show:function(){return P(this,!0)},hide:function(){return P(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Lt(this)?Y(this).show():Y(this).hide()})}}),Y.Tween=C,C.prototype={constructor:C,init:function(t,e,n,i,o,r){this.elem=t,this.prop=n,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=r||(Y.cssNumber[n]?"":"px")},cur:function(){var t=C.propHooks[this.prop];return t&&t.get?t.get(this):C.propHooks._default.get(this)},run:function(t){var e,n=C.propHooks[this.prop];return this.pos=e=this.options.duration?Y.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=Y.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){Y.fx.step[t.prop]?Y.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[Y.cssProps[t.prop]]||Y.cssHooks[t.prop])?Y.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Y.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},Y.fx=C.prototype.init,Y.fx.step={};var $t,Kt,Qt=/^(?:toggle|show|hide)$/,Yt=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),te=/queueHooks$/,ee=[A],ne={"*":[function(t,e){var n=this.createTween(t,e),i=n.cur(),o=Yt.exec(e),r=o&&o[3]||(Y.cssNumber[t]?"":"px"),s=(Y.cssNumber[t]||"px"!==r&&+i)&&Yt.exec(Y.css(n.elem,t)),a=1,l=20;if(s&&s[3]!==r){r=r||s[3],o=o||[],s=+i||1;do a=a||".5",s/=a,Y.style(n.elem,t,s+r);while(a!==(a=n.cur()/i)&&1!==a&&--l)}return o&&(s=n.start=+s||+i||0,n.unit=r,n.end=o[1]?s+(o[1]+1)*o[2]:+o[2]),n}]};Y.Animation=Y.extend(I,{tweener:function(t,e){Y.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,o=t.length;o>i;i++)n=t[i],ne[n]=ne[n]||[],ne[n].unshift(e)},prefilter:function(t,e){e?ee.unshift(t):ee.push(t)}}),Y.speed=function(t,e,n){var i=t&&"object"==typeof t?Y.extend({},t):{complete:n||!n&&e||Y.isFunction(t)&&t,duration:t,easing:n&&e||e&&!Y.isFunction(e)&&e};return i.duration=Y.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in Y.fx.speeds?Y.fx.speeds[i.duration]:Y.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){Y.isFunction(i.old)&&i.old.call(this),i.queue&&Y.dequeue(this,i.queue)},i},Y.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=Y.isEmptyObject(t),r=Y.speed(e,n,i),s=function(){var e=I(this,Y.extend({},t),r);(o||vt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,o||r.queue===!1?this.each(s):this.queue(r.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",r=Y.timers,s=vt.get(this);if(o)s[o]&&s[o].stop&&i(s[o]);else for(o in s)s[o]&&s[o].stop&&te.test(o)&&i(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(n),e=!1,r.splice(o,1));(e||!n)&&Y.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=vt.get(this),i=n[t+"queue"],o=n[t+"queueHooks"],r=Y.timers,s=i?i.length:0;for(n.finish=!0,Y.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;s>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),Y.each(["toggle","show","hide"],function(t,e){var n=Y.fn[e];Y.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(D(e,!0),t,i,o)}}),Y.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){Y.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),Y.timers=[],Y.fx.tick=function(){var t,e=0,n=Y.timers;for($t=Y.now();e<n.length;e++)t=n[e],t()||n[e]!==t||n.splice(e--,1);n.length||Y.fx.stop(),$t=void 0},Y.fx.timer=function(t){Y.timers.push(t),t()?Y.fx.start():Y.timers.pop()},Y.fx.interval=13,Y.fx.start=function(){Kt||(Kt=setInterval(Y.fx.tick,Y.fx.interval))},Y.fx.stop=function(){clearInterval(Kt),Kt=null},Y.fx.speeds={slow:600,fast:200,_default:400},Y.fn.delay=function(t,e){return t=Y.fx?Y.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}})},function(){var t=K.createElement("input"),e=K.createElement("select"),n=e.appendChild(K.createElement("option"));t.type="checkbox",$.checkOn=""!==t.value,$.optSelected=n.selected,e.disabled=!0,$.optDisabled=!n.disabled,t=K.createElement("input"),t.value="t",t.type="radio",$.radioValue="t"===t.value}();var ie,oe,re=Y.expr.attrHandle;Y.fn.extend({attr:function(t,e){return gt(this,Y.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){Y.removeAttr(this,t)})}}),Y.extend({attr:function(t,e,n){var i,o,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return typeof t.getAttribute===St?Y.prop(t,e,n):(1===r&&Y.isXMLDoc(t)||(e=e.toLowerCase(),i=Y.attrHooks[e]||(Y.expr.match.bool.test(e)?oe:ie)),void 0===n?i&&"get"in i&&null!==(o=i.get(t,e))?o:(o=Y.find.attr(t,e),null==o?void 0:o):null!==n?i&&"set"in i&&void 0!==(o=i.set(t,n,e))?o:(t.setAttribute(e,n+""),n):void Y.removeAttr(t,e))},removeAttr:function(t,e){var n,i,o=0,r=e&&e.match(ft);if(r&&1===t.nodeType)for(;n=r[o++];)i=Y.propFix[n]||n,Y.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!$.radioValue&&"radio"===e&&Y.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}}}),oe={set:function(t,e,n){return e===!1?Y.removeAttr(t,n):t.setAttribute(n,n),n}},Y.each(Y.expr.match.bool.source.match(/\w+/g),function(t,e){var n=re[e]||Y.find.attr;re[e]=function(t,e,i){var o,r;return i||(r=re[e],re[e]=o,o=null!=n(t,e,i)?e.toLowerCase():null,re[e]=r),o}});var se=/^(?:input|select|textarea|button)$/i;Y.fn.extend({prop:function(t,e){return gt(this,Y.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[Y.propFix[t]||t]})}}),Y.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,n){var i,o,r,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return r=1!==s||!Y.isXMLDoc(t),r&&(e=Y.propFix[e]||e,o=Y.propHooks[e]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:t[e]=n:o&&"get"in o&&null!==(i=o.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||se.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),$.optSelected||(Y.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),Y.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Y.propFix[this.toLowerCase()]=this});var ae=/[\t\r\n\f]/g;Y.fn.extend({addClass:function(t){var e,n,i,o,r,s,a="string"==typeof t&&t,l=0,u=this.length;if(Y.isFunction(t))return this.each(function(e){Y(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(ft)||[];u>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ae," "):" ")){for(r=0;o=e[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");s=Y.trim(i),n.className!==s&&(n.className=s)}return this},removeClass:function(t){var e,n,i,o,r,s,a=0===arguments.length||"string"==typeof t&&t,l=0,u=this.length;if(Y.isFunction(t))return this.each(function(e){Y(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(ft)||[];u>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ae," "):"")){for(r=0;o=e[r++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");s=t?Y.trim(i):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):this.each(Y.isFunction(t)?function(n){Y(this).toggleClass(t.call(this,n,this.className,e),e)}:function(){if("string"===n)for(var e,i=0,o=Y(this),r=t.match(ft)||[];e=r[i++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else(n===St||"boolean"===n)&&(this.className&&vt.set(this,"__className__",this.className),this.className=this.className||t===!1?"":vt.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ae," ").indexOf(e)>=0)return!0;return!1}});var le=/\r/g;Y.fn.extend({val:function(t){var e,n,i,o=this[0];{if(arguments.length)return i=Y.isFunction(t),this.each(function(n){var o;1===this.nodeType&&(o=i?t.call(this,n,Y(this).val()):t,null==o?o="":"number"==typeof o?o+="":Y.isArray(o)&&(o=Y.map(o,function(t){return null==t?"":t+""})),e=Y.valHooks[this.type]||Y.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))});if(o)return e=Y.valHooks[o.type]||Y.valHooks[o.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(n=e.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(le,""):null==n?"":n)}}}),Y.extend({valHooks:{option:{get:function(t){var e=Y.find.attr(t,"value");return null!=e?e:Y.trim(Y.text(t))}},select:{get:function(t){for(var e,n,i=t.options,o=t.selectedIndex,r="select-one"===t.type||0>o,s=r?null:[],a=r?o+1:i.length,l=0>o?a:r?o:0;a>l;l++)if(n=i[l],!(!n.selected&&l!==o||($.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&Y.nodeName(n.parentNode,"optgroup"))){if(e=Y(n).val(),r)return e;s.push(e)}return s},set:function(t,e){for(var n,i,o=t.options,r=Y.makeArray(e),s=o.length;s--;)i=o[s],(i.selected=Y.inArray(i.value,r)>=0)&&(n=!0);return n||(t.selectedIndex=-1),r}}}}),Y.each(["radio","checkbox"],function(){Y.valHooks[this]={set:function(t,e){return Y.isArray(e)?t.checked=Y.inArray(Y(t).val(),e)>=0:void 0}},$.checkOn||(Y.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),Y.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){Y.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),Y.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var ue=Y.now(),ce=/\?/;Y.parseJSON=function(t){return JSON.parse(t+"")},Y.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{n=new DOMParser,e=n.parseFromString(t,"text/xml")}catch(i){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&Y.error("Invalid XML: "+t),e};var he=/#.*$/,de=/([?&])_=[^&]*/,fe=/^(.*?):[ \t]*([^\r\n]*)$/gm,pe=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,me=/^(?:GET|HEAD)$/,ge=/^\/\//,ve=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ye={},_e={},be="*/".concat("*"),we=t.location.href,xe=ve.exec(we.toLowerCase())||[];

Y.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we,type:"GET",isLocal:pe.test(xe[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":be,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Y.parseJSON,"text xml":Y.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?R(R(t,Y.ajaxSettings),e):R(Y.ajaxSettings,t)},ajaxPrefilter:O(ye),ajaxTransport:O(_e),ajax:function(t,e){function n(t,e,n,s){var l,c,v,y,b,x=e;2!==_&&(_=2,a&&clearTimeout(a),i=void 0,r=s||"",w.readyState=t>0?4:0,l=t>=200&&300>t||304===t,n&&(y=j(h,w,n)),y=q(h,y,w,l),l?(h.ifModified&&(b=w.getResponseHeader("Last-Modified"),b&&(Y.lastModified[o]=b),b=w.getResponseHeader("etag"),b&&(Y.etag[o]=b)),204===t||"HEAD"===h.type?x="nocontent":304===t?x="notmodified":(x=y.state,c=y.data,v=y.error,l=!v)):(v=x,(t||!x)&&(x="error",0>t&&(t=0))),w.status=t,w.statusText=(e||x)+"",l?p.resolveWith(d,[c,x,w]):p.rejectWith(d,[w,x,v]),w.statusCode(g),g=void 0,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[w,h,l?c:v]),m.fireWith(d,[w,x]),u&&(f.trigger("ajaxComplete",[w,h]),--Y.active||Y.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,o,r,s,a,l,u,c,h=Y.ajaxSetup({},e),d=h.context||h,f=h.context&&(d.nodeType||d.jquery)?Y(d):Y.event,p=Y.Deferred(),m=Y.Callbacks("once memory"),g=h.statusCode||{},v={},y={},_=0,b="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!s)for(s={};e=fe.exec(r);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?r:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return _||(t=y[n]=y[n]||t,v[t]=e),this},overrideMimeType:function(t){return _||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>_)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||b;return i&&i.abort(e),n(0,e),this}};if(p.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,h.url=((t||h.url||we)+"").replace(he,"").replace(ge,xe[1]+"//"),h.type=e.method||e.type||h.method||h.type,h.dataTypes=Y.trim(h.dataType||"*").toLowerCase().match(ft)||[""],null==h.crossDomain&&(l=ve.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===xe[1]&&l[2]===xe[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(xe[3]||("http:"===xe[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=Y.param(h.data,h.traditional)),N(ye,h,e,w),2===_)return w;u=Y.event&&h.global,u&&0===Y.active++&&Y.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!me.test(h.type),o=h.url,h.hasContent||(h.data&&(o=h.url+=(ce.test(o)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=de.test(o)?o.replace(de,"$1_="+ue++):o+(ce.test(o)?"&":"?")+"_="+ue++)),h.ifModified&&(Y.lastModified[o]&&w.setRequestHeader("If-Modified-Since",Y.lastModified[o]),Y.etag[o]&&w.setRequestHeader("If-None-Match",Y.etag[o])),(h.data&&h.hasContent&&h.contentType!==!1||e.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+be+"; q=0.01":""):h.accepts["*"]);for(c in h.headers)w.setRequestHeader(c,h.headers[c]);if(h.beforeSend&&(h.beforeSend.call(d,w,h)===!1||2===_))return w.abort();b="abort";for(c in{success:1,error:1,complete:1})w[c](h[c]);if(i=N(_e,h,e,w)){w.readyState=1,u&&f.trigger("ajaxSend",[w,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},h.timeout));try{_=1,i.send(v,n)}catch(x){if(!(2>_))throw x;n(-1,x)}}else n(-1,"No Transport");return w},getJSON:function(t,e,n){return Y.get(t,e,n,"json")},getScript:function(t,e){return Y.get(t,void 0,e,"script")}}),Y.each(["get","post"],function(t,e){Y[e]=function(t,n,i,o){return Y.isFunction(n)&&(o=o||i,i=n,n=void 0),Y.ajax({url:t,type:e,dataType:o,data:n,success:i})}}),Y._evalUrl=function(t){return Y.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Y.fn.extend({wrapAll:function(t){var e;return Y.isFunction(t)?this.each(function(e){Y(this).wrapAll(t.call(this,e))}):(this[0]&&(e=Y(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(Y.isFunction(t)?function(e){Y(this).wrapInner(t.call(this,e))}:function(){var e=Y(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=Y.isFunction(t);return this.each(function(n){Y(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){Y.nodeName(this,"body")||Y(this).replaceWith(this.childNodes)}).end()}}),Y.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},Y.expr.filters.visible=function(t){return!Y.expr.filters.hidden(t)};var Le=/%20/g,Te=/\[\]$/,Se=/\r?\n/g,ke=/^(?:submit|button|image|reset|file)$/i,Pe=/^(?:input|select|textarea|keygen)/i;Y.param=function(t,e){var n,i=[],o=function(t,e){e=Y.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=Y.ajaxSettings&&Y.ajaxSettings.traditional),Y.isArray(t)||t.jquery&&!Y.isPlainObject(t))Y.each(t,function(){o(this.name,this.value)});else for(n in t)F(n,t[n],e,o);return i.join("&").replace(Le,"+")},Y.fn.extend({serialize:function(){return Y.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=Y.prop(this,"elements");return t?Y.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!Y(this).is(":disabled")&&Pe.test(this.nodeName)&&!ke.test(t)&&(this.checked||!Tt.test(t))}).map(function(t,e){var n=Y(this).val();return null==n?null:Y.isArray(n)?Y.map(n,function(t){return{name:e.name,value:t.replace(Se,"\r\n")}}):{name:e.name,value:n.replace(Se,"\r\n")}}).get()}}),Y.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Ce=0,Ee={},De={0:200,1223:204},Me=Y.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in Ee)Ee[t]()}),$.cors=!!Me&&"withCredentials"in Me,$.ajax=Me=!!Me,Y.ajaxTransport(function(t){var e;return $.cors||Me&&!t.crossDomain?{send:function(n,i){var o,r=t.xhr(),s=++Ce;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)r[o]=t.xhrFields[o];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(o in n)r.setRequestHeader(o,n[o]);e=function(t){return function(){e&&(delete Ee[s],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?i(r.status,r.statusText):i(De[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=Ee[s]=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(a){if(e)throw a}},abort:function(){e&&e()}}:void 0}),Y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return Y.globalEval(t),t}}}),Y.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),Y.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,o){e=Y("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),K.head.appendChild(e[0])},abort:function(){n&&n()}}}});var Ae=[],ze=/(=)\?(?=&|$)|\?\?/;Y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ae.pop()||Y.expando+"_"+ue++;return this[t]=!0,t}}),Y.ajaxPrefilter("json jsonp",function(e,n,i){var o,r,s,a=e.jsonp!==!1&&(ze.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ze.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(o=e.jsonpCallback=Y.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(ze,"$1"+o):e.jsonp!==!1&&(e.url+=(ce.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return s||Y.error(o+" was not called"),s[0]},e.dataTypes[0]="json",r=t[o],t[o]=function(){s=arguments},i.always(function(){t[o]=r,e[o]&&(e.jsonpCallback=n.jsonpCallback,Ae.push(o)),s&&Y.isFunction(r)&&r(s[0]),s=r=void 0}),"script"):void 0}),Y.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||K;var i=st.exec(t),o=!n&&[];return i?[e.createElement(i[1])]:(i=Y.buildFragment([t],e,o),o&&o.length&&Y(o).remove(),Y.merge([],i.childNodes))};var Ie=Y.fn.load;Y.fn.load=function(t,e,n){if("string"!=typeof t&&Ie)return Ie.apply(this,arguments);var i,o,r,s=this,a=t.indexOf(" ");return a>=0&&(i=Y.trim(t.slice(a)),t=t.slice(0,a)),Y.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(o="POST"),s.length>0&&Y.ajax({url:t,type:o,dataType:"html",data:e}).done(function(t){r=arguments,s.html(i?Y("<div>").append(Y.parseHTML(t)).find(i):t)}).complete(n&&function(t,e){s.each(n,r||[t.responseText,e,t])}),this},Y.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){Y.fn[e]=function(t){return this.on(e,t)}}),Y.expr.filters.animated=function(t){return Y.grep(Y.timers,function(e){return t===e.elem}).length};var Oe=t.document.documentElement;Y.offset={setOffset:function(t,e,n){var i,o,r,s,a,l,u,c=Y.css(t,"position"),h=Y(t),d={};"static"===c&&(t.style.position="relative"),a=h.offset(),r=Y.css(t,"top"),l=Y.css(t,"left"),u=("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1,u?(i=h.position(),s=i.top,o=i.left):(s=parseFloat(r)||0,o=parseFloat(l)||0),Y.isFunction(e)&&(e=e.call(t,n,a)),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+o),"using"in e?e.using.call(t,d):h.css(d)}},Y.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){Y.offset.setOffset(this,t,e)});var e,n,i=this[0],o={top:0,left:0},r=i&&i.ownerDocument;if(r)return e=r.documentElement,Y.contains(e,i)?(typeof i.getBoundingClientRect!==St&&(o=i.getBoundingClientRect()),n=U(r),{top:o.top+n.pageYOffset-e.clientTop,left:o.left+n.pageXOffset-e.clientLeft}):o},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===Y.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),Y.nodeName(t[0],"html")||(i=t.offset()),i.top+=Y.css(t[0],"borderTopWidth",!0),i.left+=Y.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-Y.css(n,"marginTop",!0),left:e.left-i.left-Y.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Oe;t&&!Y.nodeName(t,"html")&&"static"===Y.css(t,"position");)t=t.offsetParent;return t||Oe})}}),Y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i="pageYOffset"===n;Y.fn[e]=function(o){return gt(this,function(e,o,r){var s=U(e);return void 0===r?s?s[n]:e[o]:void(s?s.scrollTo(i?t.pageXOffset:r,i?r:t.pageYOffset):e[o]=r)},e,o,arguments.length,null)}}),Y.each(["top","left"],function(t,e){Y.cssHooks[e]=x($.pixelPosition,function(t,n){return n?(n=w(t,e),Bt.test(n)?Y(t).position()[e]+"px":n):void 0})}),Y.each({Height:"height",Width:"width"},function(t,e){Y.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){Y.fn[i]=function(i,o){var r=arguments.length&&(n||"boolean"!=typeof i),s=n||(i===!0||o===!0?"margin":"border");return gt(this,function(e,n,i){var o;return Y.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?Y.css(e,n,s):Y.style(e,n,i,s)},e,r?i:void 0,r,null)}})}),Y.fn.size=function(){return this.length},Y.fn.andSelf=Y.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Y});var Ne=t.jQuery,Re=t.$;return Y.noConflict=function(e){return t.$===Y&&(t.$=Re),e&&t.jQuery===Y&&(t.jQuery=Ne),Y},typeof e===St&&(t.jQuery=t.$=Y),Y})},{}],22:[function(t,e,n){L.Control.GraphicScale=L.Control.extend({options:{position:"bottomleft",updateWhenIdle:!1,minUnitWidth:30,maxUnitsWidth:240,fill:!1,showSubunits:!1,doubleLine:!1},onAdd:function(t){return this._map=t,this._possibleUnitsNum=[3,5,2,4],this._possibleUnitsNumLen=this._possibleUnitsNum.length,this._possibleDivisions=[1,.5,.25,.2],this._possibleDivisionsLen=this._possibleDivisions.length,this._possibleDivisionsSub={1:{num:2,division:.5},.5:{num:5,division:.1},.25:{num:5,division:.05},.2:{num:2,division:.1}},this._scaleInner=this._buildScale(),this._scale=this._addScale(this._scaleInner),this._setStyle(this.options),t.on(this.options.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),this._scale},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScale:function(t){var e=L.DomUtil.create("div");return e.className="leaflet-control-graphicscale",e.appendChild(t),e},_setStyle:function(t){var e=["leaflet-control-graphicscale-inner"];t.fill&&"nofill"!==t.fill&&(e.push("filled"),e.push("filled-"+t.fill)),t.showSubunits&&e.push("showsubunits"),t.doubleLine&&e.push("double"),this._scaleInner.className=e.join(" ")},_buildScale:function(){var t=document.createElement("div");t.className="leaflet-control-graphicscale-inner";var e=L.DomUtil.create("div","subunits",t),n=L.DomUtil.create("div","units",t);this._units=[],this._unitsLbls=[],this._subunits=[];for(var i=0;5>i;i++){var o=this._buildDivision(i%2===0);n.appendChild(o),this._units.push(o);var r=this._buildDivisionLbl();o.appendChild(r),this._unitsLbls.push(r);var s=this._buildDivision(i%2===1);e.appendChild(s),this._subunits.unshift(s)}return this._zeroLbl=L.DomUtil.create("div","label zeroLabel"),this._zeroLbl.innerHTML="0",this._units[0].appendChild(this._zeroLbl),this._subunitsLbl=L.DomUtil.create("div","label subunitsLabel"),this._subunitsLbl.innerHTML="?",this._subunits[4].appendChild(this._subunitsLbl),t},_buildDivision:function(t){var e=L.DomUtil.create("div","division"),n=L.DomUtil.create("div","line");e.appendChild(n);var i=L.DomUtil.create("div","line2");return e.appendChild(i),t&&n.appendChild(L.DomUtil.create("div","fill")),t||i.appendChild(L.DomUtil.create("div","fill")),e},_buildDivisionLbl:function(){var t=L.DomUtil.create("div","label divisionLabel");return t},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180),i=n*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize();o.x>0&&this._updateScale(i,this.options)},_updateScale:function(t,e){var n=this._getBestScale(t,e.minUnitWidth,e.maxUnitsWidth);this._render(n)},_getBestScale:function(t,e,n){var i=this._getPossibleUnits(t,e,this._map.getSize().x),o=this._getPossibleScales(i,n);o.sort(function(t,e){return e.score-t.score});var r=o[0];return r.subunits=this._getSubunits(r),r},_getSubunits:function(t){var e=this._possibleDivisionsSub[t.unit.unitDivision],n={};n.subunitDivision=e.division,n.subunitMeters=e.division*(t.unit.unitMeters/t.unit.unitDivision),n.subunitPx=e.division*(t.unit.unitPx/t.unit.unitDivision);var i={subunit:n,numSubunits:e.num,total:e.num*n.subunitMeters};return i},_getPossibleScales:function(t,e){for(var n,i=[],o=Number.POSITIVE_INFINITY,r=0;r<this._possibleUnitsNumLen;r++)for(var s=this._possibleUnitsNum[r],a=.5*(this._possibleUnitsNumLen-r),l=0;l<t.length;l++){var u=t[l],c=u.unitPx*s,h={unit:u,totalWidthPx:c,numUnits:s,score:0},d=1-(e-c)/e;d*=3;var f=u.unitScore+a+d;(.25===u.unitDivision&&3===s||.5===u.unitDivision&&3===s||.25===u.unitDivision&&5===s)&&(f-=2),h.score=f,e>c&&i.push(h),o>c&&(o=c,n=h)}return i.length||i.push(n),i},_getPossibleUnits:function(t,e,n){for(var i,o=(Math.floor(t)+"").length,r=[],s=o;s>0;s--){i=Math.pow(10,s);for(var a=0;a<this._possibleDivisionsLen;a++){var l=i*this._possibleDivisions[a],u=n*(l/t);if(e>u)return r;r.push({unitMeters:l,unitPx:u,unitDivision:this._possibleDivisions[a],unitScore:this._possibleDivisionsLen-a})}}return r},_render:function(t){this._renderPart(t.unit.unitPx,t.unit.unitMeters,t.numUnits,this._units,this._unitsLbls),this._renderPart(t.subunits.subunit.subunitPx,t.subunits.subunit.subunitMeters,t.subunits.numSubunits,this._subunits);var e=this._getDisplayUnit(t.subunits.total);this._subunitsLbl.innerHTML=""+e.amount+e.unit},_renderPart:function(t,e,n,i,o){for(var r=this._getDisplayUnit(e),s=0;s<this._units.length;s++){var a=i[s];if(n>s?(a.style.width=t+"px",a.className="division"):(a.style.width=0,a.className="division hidden"),o){var l=o[s],u=["label","divisionLabel"];if(n>s){var c=(s+1)*r.amount;s===n-1?(c+=r.unit,u.push("labelLast")):u.push("labelSub"),l.innerHTML=c}l.className=u.join(" ")}}},_getDisplayUnit:function(t){var e=1e3>t?"m":"km";return{unit:e,amount:"km"===e?t/1e3:t}}}),L.Map.mergeOptions({graphicScaleControl:!1}),L.Map.addInitHook(function(){this.options.graphicScaleControl&&(this.graphicScaleControl=new L.Control.GraphicScale,this.addControl(this.graphicScaleControl))}),L.control.graphicScale=function(t){return new L.Control.GraphicScale(t)}},{}],23:[function(t,e,n){!function(t){var e=function(){var e=t.documentMode;return"onhashchange"in t&&(void 0===e||e>7)}();L.Hash=function(t){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t)},L.Hash.parseHash=function(t){0===t.indexOf("#")&&(t=t.substr(1));var e=t.split("/");if(3==e.length){var n=parseInt(e[0],10),i=parseFloat(e[1]),o=parseFloat(e[2]);return isNaN(n)||isNaN(i)||isNaN(o)?!1:{center:new L.LatLng(i,o),zoom:n}}return!1},L.Hash.formatHash=function(t){var e=t.getCenter(),n=t.getZoom(),i=Math.max(0,Math.ceil(Math.log(n)/Math.LN2));return"#"+[n,e.lat.toFixed(i),e.lng.toFixed(i)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t){this.map=t,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(t){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t=location.hash;if(t!==this.lastHash){var e=this.parseHash(t);e?(this.movingMap=!0,this.map.setView(e.center,e.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var t=this;this.changeTimeout=setTimeout(function(){t.update(),t.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),e?L.DomEvent.addListener(t,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),e?L.DomEvent.removeListener(t,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(t){return new L.Hash(t)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window)},{}],24:[function(t,e,n){!function(t,n,i){var o=t.L,r={};r.version="0.7.2","object"==typeof e&&"object"==typeof e.exports?e.exports=r:"function"==typeof define&&define.amd&&define(r),r.noConflict=function(){return t.L=o,this},t.L=r,r.Util={extend:function(t){var e,n,i,o,r=Array.prototype.slice.call(arguments,1);for(n=0,i=r.length;i>n;n++){o=r[n]||{};for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},bind:function(t,e){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(n){return n[e]=n[e]||++t,n[e]}}(),invokeEach:function(t,e,n){var i,o;if("object"==typeof t){o=Array.prototype.slice.call(arguments,3);for(i in t)e.apply(n,[i,t[i]].concat(o));return!0}return!1},limitExecByInterval:function(t,e,n){var i,o;return function r(){var s=arguments;return i?void(o=!0):(i=!0,setTimeout(function(){i=!1,o&&(r.apply(n,s),o=!1)},e),void t.apply(n,s))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return r.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=r.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var n,i,o=["webkit","moz","o","ms"];for(n=0;n<o.length&&!i;n++)i=t[o[n]+e];return i}function n(e){var n=+new Date,o=Math.max(0,16-(n-i));return i=n+o,t.setTimeout(e,o)}var i=0,o=t.requestAnimationFrame||e("RequestAnimationFrame")||n,s=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};r.Util.requestAnimFrame=function(e,i,s,a){return e=r.bind(e,i),s&&o===n?void e():o.call(t,e,a)},r.Util.cancelAnimFrame=function(e){e&&s.call(t,e)}}(),r.extend=r.Util.extend,r.bind=r.Util.bind,r.stamp=r.Util.stamp,r.setOptions=r.Util.setOptions,r.Class=function(){},r.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;i.constructor=e,e.prototype=i;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(r.extend(e,t.statics),delete t.statics),t.includes&&(r.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=r.extend({},i.options,t.options)),r.extend(i,t),i._initHooks=[];var s=this;return e.__super__=s.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){s.prototype.callInitHooks&&s.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;e>t;t++)i._initHooks[t].call(this)}},e},r.Class.include=function(t){r.extend(this.prototype,t)},r.Class.mergeOptions=function(t){r.extend(this.prototype.options,t)},r.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var s="_leaflet_events";r.Mixin={},r.Mixin.Events={addEventListener:function(t,e,n){if(r.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,o,a,l,u,c,h,d=this[s]=this[s]||{},f=n&&n!==this&&r.stamp(n);for(t=r.Util.splitWords(t),i=0,o=t.length;o>i;i++)a={action:e,context:n||this},l=t[i],f?(u=l+"_idx",c=u+"_len",h=d[u]=d[u]||{},h[f]||(h[f]=[],d[c]=(d[c]||0)+1),h[f].push(a)):(d[l]=d[l]||[],d[l].push(a));return this},hasEventListeners:function(t){var e=this[s];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,n){if(!this[s])return this;if(!t)return this.clearAllEventListeners();if(r.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,o,a,l,u,c,h,d,f,p=this[s],m=n&&n!==this&&r.stamp(n);for(t=r.Util.splitWords(t),i=0,o=t.length;o>i;i++)if(a=t[i],c=a+"_idx",h=c+"_len",d=p[c],e){if(l=m&&d?d[m]:p[a]){for(u=l.length-1;u>=0;u--)l[u].action!==e||n&&l[u].context!==n||(f=l.splice(u,1),f[0].action=r.Util.falseFn);n&&d&&0===l.length&&(delete d[m],p[h]--)}}else delete p[a],delete p[c],delete p[h];return this},clearAllEventListeners:function(){return delete this[s],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,o,a,l,u=r.Util.extend({},e,{type:t,target:this}),c=this[s];if(c[t])for(n=c[t].slice(),i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,u);a=c[t+"_idx"];for(l in a)if(n=a[l].slice())for(i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,u);return this},addOneTimeEventListener:function(t,e,n){if(r.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=r.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},r.Mixin.Events.on=r.Mixin.Events.addEventListener,r.Mixin.Events.off=r.Mixin.Events.removeEventListener,r.Mixin.Events.once=r.Mixin.Events.addOneTimeEventListener,r.Mixin.Events.fire=r.Mixin.Events.fireEvent,function(){var e="ActiveXObject"in t,o=e&&!n.addEventListener,s=navigator.userAgent.toLowerCase(),a=-1!==s.indexOf("webkit"),l=-1!==s.indexOf("chrome"),u=-1!==s.indexOf("phantom"),c=-1!==s.indexOf("android"),h=-1!==s.search("android [23]"),d=-1!==s.indexOf("gecko"),f=typeof orientation!=i+"",p=t.navigator&&t.navigator.msPointerEnabled&&t.navigator.msMaxTouchPoints&&!t.PointerEvent,m=t.PointerEvent&&t.navigator.pointerEnabled&&t.navigator.maxTouchPoints||p,g="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,v=n.documentElement,y=e&&"transition"in v.style,_="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!h,b="MozPerspective"in v.style,w="OTransition"in v.style,x=!t.L_DISABLE_3D&&(y||_||b||w)&&!u,L=!t.L_NO_TOUCH&&!u&&function(){var t="ontouchstart";if(m||t in v)return!0;var e=n.createElement("div"),i=!1;return e.setAttribute?(e.setAttribute(t,"return;"),"function"==typeof e[t]&&(i=!0),e.removeAttribute(t),e=null,i):!1}();r.Browser={ie:e,ielt9:o,webkit:a,gecko:d&&!a&&!t.opera&&!e,android:c,android23:h,chrome:l,ie3d:y,webkit3d:_,gecko3d:b,opera3d:w,any3d:x,mobile:f,mobileWebkit:f&&a,mobileWebkit3d:f&&_,mobileOpera:f&&t.opera,touch:L,msPointer:p,pointer:m,retina:g}}(),r.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(t){return this.clone()._add(r.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(r.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=r.point(t);var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return t=r.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=r.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"}},r.point=function(t,e,n){return t instanceof r.Point?t:r.Util.isArray(t)?new r.Point(t[0],t[1]):t===i||null===t?t:new r.Point(t,e,n)},r.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},r.Bounds.prototype={extend:function(t){return t=r.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return t="number"==typeof t[0]||t instanceof r.Point?r.point(t):r.bounds(t),t instanceof r.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=r.bounds(t);var e=this.min,n=this.max,i=t.min,o=t.max,s=o.x>=e.x&&i.x<=n.x,a=o.y>=e.y&&i.y<=n.y;return s&&a},isValid:function(){return!(!this.min||!this.max)}},r.bounds=function(t,e){return!t||t instanceof r.Bounds?t:new r.Bounds(t,e)},r.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},r.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new r.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},r.DomUtil={get:function(t){return"string"==typeof t?n.getElementById(t):t},getStyle:function(t,e){var i=t.style[e];if(!i&&t.currentStyle&&(i=t.currentStyle[e]),(!i||"auto"===i)&&n.defaultView){var o=n.defaultView.getComputedStyle(t,null);i=o?o[e]:null}return"auto"===i?null:i},getViewportOffset:function(t){var e,i=0,o=0,s=t,a=n.body,l=n.documentElement;do{if(i+=s.offsetTop||0,o+=s.offsetLeft||0,i+=parseInt(r.DomUtil.getStyle(s,"borderTopWidth"),10)||0,o+=parseInt(r.DomUtil.getStyle(s,"borderLeftWidth"),10)||0,e=r.DomUtil.getStyle(s,"position"),s.offsetParent===a&&"absolute"===e)break;if("fixed"===e){i+=a.scrollTop||l.scrollTop||0,o+=a.scrollLeft||l.scrollLeft||0;break}if("relative"===e&&!s.offsetLeft){var u=r.DomUtil.getStyle(s,"width"),c=r.DomUtil.getStyle(s,"max-width"),h=s.getBoundingClientRect();("none"!==u||"none"!==c)&&(o+=h.left+s.clientLeft),i+=h.top+(a.scrollTop||l.scrollTop||0);break}s=s.offsetParent}while(s);s=t;do{if(s===a)break;i-=s.scrollTop||0,o-=s.scrollLeft||0,s=s.parentNode}while(s);return new r.Point(o,i)},documentIsLtr:function(){return r.DomUtil._docIsLtrCached||(r.DomUtil._docIsLtrCached=!0,r.DomUtil._docIsLtr="ltr"===r.DomUtil.getStyle(n.body,"direction")),r.DomUtil._docIsLtr},create:function(t,e,i){var o=n.createElement(t);return o.className=e,i&&i.appendChild(o),o},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=r.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=r.Util.splitWords(e),o=0,s=n.length;s>o;o++)t.classList.add(n[o]);else if(!r.DomUtil.hasClass(t,e)){var a=r.DomUtil._getClass(t);r.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):r.DomUtil._setClass(t,r.Util.trim((" "+r.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(o){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var e=n.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},getTranslateString:function(t){var e=r.Browser.webkit3d,n="translate"+(e?"3d":"")+"(",i=(e?",0":"")+")";return n+t.x+"px,"+t.y+"px"+i},getScaleString:function(t,e){var n=r.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),i=" scale("+t+") ";return n+i},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&r.Browser.any3d?t.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",
t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),r.DomUtil.TRANSITION=r.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),r.DomUtil.TRANSITION_END="webkitTransition"===r.DomUtil.TRANSITION||"OTransition"===r.DomUtil.TRANSITION?r.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in n)r.extend(r.DomUtil,{disableTextSelection:function(){r.DomEvent.on(t,"selectstart",r.DomEvent.preventDefault)},enableTextSelection:function(){r.DomEvent.off(t,"selectstart",r.DomEvent.preventDefault)}});else{var e=r.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);r.extend(r.DomUtil,{disableTextSelection:function(){if(e){var t=n.documentElement.style;this._userSelect=t[e],t[e]="none"}},enableTextSelection:function(){e&&(n.documentElement.style[e]=this._userSelect,delete this._userSelect)}})}r.extend(r.DomUtil,{disableImageDrag:function(){r.DomEvent.on(t,"dragstart",r.DomEvent.preventDefault)},enableImageDrag:function(){r.DomEvent.off(t,"dragstart",r.DomEvent.preventDefault)}})}(),r.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},r.extend(r.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),r.LatLng.prototype={equals:function(t){if(!t)return!1;t=r.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=r.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+r.Util.formatNum(this.lat,t)+", "+r.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=r.latLng(t);var e=6378137,n=r.LatLng.DEG_TO_RAD,i=(t.lat-this.lat)*n,o=(t.lng-this.lng)*n,s=this.lat*n,a=t.lat*n,l=Math.sin(i/2),u=Math.sin(o/2),c=l*l+u*u*Math.cos(s)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))},wrap:function(t,e){var n=this.lng;return t=t||-180,e=e||180,n=(n+e)%(e-t)+(t>n||n===e?e:t),new r.LatLng(this.lat,n)}},r.latLng=function(t,e){return t instanceof r.LatLng?t:r.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new r.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new r.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new r.LatLng(t,e)},r.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},r.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=r.latLng(t);return t=null!==e?e:r.latLngBounds(t),t instanceof r.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new r.LatLng(t.lat,t.lng),this._northEast=new r.LatLng(t.lat,t.lng)):t instanceof r.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new r.LatLngBounds(new r.LatLng(e.lat-i,e.lng-o),new r.LatLng(n.lat+i,n.lng+o))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof r.LatLng?r.latLng(t):r.latLngBounds(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof r.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=r.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>=e.lat&&i.lat<=n.lat,a=o.lng>=e.lng&&i.lng<=n.lng;return s&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=r.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},r.latLngBounds=function(t,e){return!t||t instanceof r.LatLngBounds?t:new r.LatLngBounds(t,e)},r.Projection={},r.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=r.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=t.lng*e,s=i*e;return s=Math.log(Math.tan(Math.PI/4+s/2)),new r.Point(o,s)},unproject:function(t){var e=r.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new r.LatLng(i,n)}},r.Projection.LonLat={project:function(t){return new r.Point(t.lng,t.lat)},unproject:function(t){return new r.LatLng(t.y,t.x)}},r.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return r.point(e,e)}},r.CRS.Simple=r.extend({},r.CRS,{projection:r.Projection.LonLat,transformation:new r.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),r.CRS.EPSG3857=r.extend({},r.CRS,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:new r.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),n=6378137;return e.multiplyBy(n)}}),r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"}),r.CRS.EPSG4326=r.extend({},r.CRS,{code:"EPSG:4326",projection:r.Projection.LonLat,transformation:new r.Transformation(1/360,.5,-1/360,.5)}),r.Map=r.Class.extend({includes:r.Mixin.Events,options:{crs:r.CRS.EPSG3857,fadeAnimation:r.DomUtil.TRANSITION&&!r.Browser.android23,trackResize:!0,markerZoomAnimation:r.DomUtil.TRANSITION&&r.Browser.any3d},initialize:function(t,e){e=r.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=r.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(r.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(r.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),s=t instanceof r.Point?t:this.latLngToContainerPoint(t),a=s.subtract(o).multiplyBy(1-1/i),l=this.containerPointToLatLng(o.add(a));return this.setView(l,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():r.latLngBounds(t);var n=r.point(e.paddingTopLeft||e.padding||[0,0]),i=r.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i)),s=i.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),o),l=this.project(t.getNorthEast(),o),u=this.unproject(a.add(l).divideBy(2).add(s),o);return o=e&&e.maxZoom?Math.min(e.maxZoom,o):o,this.setView(u,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(r.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=r.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=r.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&t instanceof r.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=r.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&t instanceof r.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?r.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=r.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),s=i.subtract(o);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new r.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=r.latLngBounds(t);var i,o=this.getMinZoom()-(e?1:0),s=this.getMaxZoom(),a=this.getSize(),l=t.getNorthWest(),u=t.getSouthEast(),c=!0;n=r.point(n||[0,0]);do o++,i=this.project(u,o).subtract(this.project(l,o)).add(n),c=e?i.x<a.x||i.y<a.y:a.contains(i);while(c&&s>=o);return c&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new r.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new r.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(r.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(r.point(t),e)},layerPointToLatLng:function(t){var e=r.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(r.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return r.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return r.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(r.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(r.latLng(t)))},mouseEventToContainerPoint:function(t){return r.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=r.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;r.DomUtil.addClass(t,"leaflet-container"+(r.Browser.touch?" leaflet-touch":"")+(r.Browser.retina?" leaflet-retina":"")+(r.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=r.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(r.DomUtil.addClass(t.markerPane,e),r.DomUtil.addClass(t.shadowPane,e),r.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return r.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?r.Util.isArray(t)?t:[t]:[];for(var e=0,n=t.length;n>e;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var o=this._zoom!==e;i||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):r.DomUtil.setPosition(this._mapPane,new r.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var s=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),s&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){r.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-(1/0),o=this._getZoomSpan();for(t in this._zoomBoundLayers){var r=this._zoomBoundLayers[t];isNaN(r.options.minZoom)||(e=Math.min(e,r.options.minZoom)),isNaN(r.options.maxZoom)||(n=Math.max(n,r.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),o!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(r.DomEvent){e=e||"on",r.DomEvent[e](this._container,"click",this._onMouseClick,this);var n,i,o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(n=0,i=o.length;i>n;n++)r.DomEvent[e](this._container,o[n],this._fireMouseEvent,this);this.options.trackResize&&r.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){r.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=r.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||r.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!r.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&r.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),o=this.layerPointToLatLng(i);this.fire(e,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return r.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),s=new r.Bounds(i.subtract(o),i.add(o)),a=this._getBoundsOffset(s,n,e);return this.unproject(i.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new r.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),o=this.project(e.getSouthEast(),n).subtract(t.max),s=this._rebound(i.x,-o.x),a=this._rebound(i.y,-o.y);return new r.Point(s,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),r.map=function(t,e){return new r.Map(t,e)},r.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=r.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=this.R_MAJOR,s=this.R_MINOR,a=t.lng*e*o,l=i*e,u=s/o,c=Math.sqrt(1-u*u),h=c*Math.sin(l);h=Math.pow((1-h)/(1+h),.5*c);var d=Math.tan(.5*(.5*Math.PI-l))/h;return l=-o*Math.log(d),new r.Point(a,l)},unproject:function(t){for(var e,n=r.LatLng.RAD_TO_DEG,i=this.R_MAJOR,o=this.R_MINOR,s=t.x*n/i,a=o/i,l=Math.sqrt(1-a*a),u=Math.exp(-t.y/i),c=Math.PI/2-2*Math.atan(u),h=15,d=1e-7,f=h,p=.1;Math.abs(p)>d&&--f>0;)e=l*Math.sin(c),p=Math.PI/2-2*Math.atan(u*Math.pow((1-e)/(1+e),.5*l))-c,c+=p;return new r.LatLng(c*n,s)}},r.CRS.EPSG3395=r.extend({},r.CRS,{code:"EPSG:3395",projection:r.Projection.Mercator,transformation:function(){var t=r.Projection.Mercator,e=t.R_MAJOR,n=.5/(Math.PI*e);return new r.Transformation(n,.5,-n,.5)}()}),r.TileLayer=r.Class.extend({includes:r.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:r.Browser.mobile,updateWhenIdle:r.Browser.mobile},initialize:function(t,e){e=r.setOptions(this,e),e.detectRetina&&r.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=r.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=r.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,o,r=t.children,s=-e(1/0,-(1/0));for(i=0,o=r.length;o>i;i++)r[i]!==this._container&&(n=parseInt(r[i].style.zIndex,10),isNaN(n)||(s=e(s,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(s)?s:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(r.Browser.ielt9)for(t in e)r.DomUtil.setOpacity(e[t],this.options.opacity);else r.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=r.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=r.DomUtil.create("div",e,this._container),this._tileContainer=r.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&e>n&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var o=r.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var e,i,o,s=[],a=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)o=new r.Point(i,e),this._tileShouldBeLoaded(o)&&s.push(o);var l=s.length;if(0!==l){s.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var u=n.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=l,i=0;l>i;i++)this._addTile(s[i],u);this._tileContainer.appendChild(u)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=e.tileSize,o=t.multiplyBy(i),r=o.add([i,i]),s=this._map.unproject(o),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(s=s.wrap(),a=a.wrap()),!e.bounds.intersects([s,a]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,o;for(o in this._tiles)e=o.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(r.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),r.Browser.android||(e.onload=null,e.src=r.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();r.DomUtil.setPosition(i,n,r.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return r.Util.template(this._url,r.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=r.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=r.Util.falseFn,r.Browser.ielt9&&this.options.opacity!==i&&r.DomUtil.setOpacity(t,this.options.opacity),r.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&r.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(r.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==r.Util.emptyImageUrl&&(r.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),r.tileLayer=function(t,e){return new r.TileLayer(t,e)},r.TileLayer.WMS=r.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=r.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;n.width=n.height=e.detectRetina&&r.Browser.retina?2*i:i;for(var o in e)this.options.hasOwnProperty(o)||"crs"===o||(n[o]=e[o]);this.wmsParams=n,r.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,r.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),o=i.add([n,n]),s=this._crs.project(e.unproject(i,t.z)),a=this._crs.project(e.unproject(o,t.z)),l=this._wmsVersion>=1.3&&this._crs===r.CRS.EPSG4326?[a.y,s.x,s.y,a.x].join(","):[s.x,a.y,a.x,s.y].join(","),u=r.Util.template(this._url,{s:this._getSubdomain(t)});return u+r.Util.getParamString(this.wmsParams,u,!0)+"&BBOX="+l},setParams:function(t,e){return r.extend(this.wmsParams,t),e||this.redraw(),this}}),r.tileLayer.wms=function(t,e){return new r.TileLayer.WMS(t,e)},r.TileLayer.Canvas=r.TileLayer.extend({options:{async:!1},initialize:function(t){r.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=r.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=r.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),r.tileLayer.canvas=function(t){return new r.TileLayer.Canvas(t)},r.ImageOverlay=r.Class.extend({includes:r.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=r.latLngBounds(e),r.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&r.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=r.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&r.Browser.any3d?r.DomUtil.addClass(this._image,"leaflet-zoom-animated"):r.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),r.extend(this._image,{galleryimg:"no",onselectstart:r.Util.falseFn,onmousemove:r.Util.falseFn,onload:r.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),s=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(o,t.zoom,t.center),l=e._latLngToNewLayerPoint(s,t.zoom,t.center)._subtract(a),u=a._add(l._multiplyBy(.5*(1-1/i)));n.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(u)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);r.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){r.DomUtil.setOpacity(this._image,this.options.opacity)}}),r.imageOverlay=function(t,e,n){return new r.ImageOverlay(t,e,n)},r.Icon=r.Class.extend({options:{className:""},initialize:function(t){r.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t);

},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i;return i=e&&"IMG"===e.tagName?this._createImg(n,e):this._createImg(n),this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n,i=this.options,o=r.point(i[e+"Size"]);n=r.point("shadow"===e?i.shadowAnchor||i.iconAnchor:i.iconAnchor),!n&&o&&(n=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return e=e||n.createElement("img"),e.src=t,e},_getIconUrl:function(t){return r.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),r.icon=function(t){return new r.Icon(t)},r.Icon.Default=r.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];r.Browser.retina&&"icon"===t&&(t+="-2x");var n=r.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),r.Icon.Default.imagePath=function(){var t,e,i,o,r,s=n.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=s.length;e>t;t++)if(i=s[t].src,o=i.match(a))return r=i.split(a)[0],(r?r+"/":"")+"images"}(),r.Marker=r.Class.extend({includes:r.Mixin.Events,options:{icon:new r.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){r.setOptions(this,e),this._latlng=r.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=r.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation,i=n?"leaflet-zoom-animated":"leaflet-zoom-hide",o=t.icon.createIcon(this._icon),s=!1;o!==this._icon&&(this._icon&&this._removeIcon(),s=!0,t.title&&(o.title=t.title),t.alt&&(o.alt=t.alt)),r.DomUtil.addClass(o,i),t.keyboard&&(o.tabIndex="0"),this._icon=o,this._initInteraction(),t.riseOnHover&&r.DomEvent.on(o,"mouseover",this._bringToFront,this).on(o,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),l=!1;a!==this._shadow&&(this._removeShadow(),l=!0),a&&r.DomUtil.addClass(a,i),this._shadow=a,t.opacity<1&&this._updateOpacity();var u=this._map._panes;s&&u.markerPane.appendChild(this._icon),a&&l&&u.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&r.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){r.DomUtil.setPosition(this._icon,t),this._shadow&&r.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];r.DomUtil.addClass(t,"leaflet-clickable"),r.DomEvent.on(t,"click",this._onMouseClick,this),r.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)r.DomEvent.on(t,e[n],this._fireMouseEvent,this);r.Handler.MarkerDrag&&(this.dragging=new r.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&r.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&r.DomEvent.preventDefault(t),"mousedown"!==t.type?r.DomEvent.stopPropagation(t):r.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){r.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&r.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),r.marker=function(t,e){return new r.Marker(t,e)},r.DivIcon=r.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:n.createElement("div"),i=this.options;return e.innerHTML=i.html!==!1?i.html:"",i.bgPos&&(e.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),r.divIcon=function(t){return new r.DivIcon(t)},r.Map.mergeOptions({closePopupOnClick:!0}),r.Popup=r.Class.extend({includes:r.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){r.setOptions(this,t),this._source=e,this._animated=r.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&r.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&r.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),r.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&r.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=r.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=r.DomUtil.create("div",n);this.options.closeButton&&(t=this._closeButton=r.DomUtil.create("a",e+"-close-button",i),t.href="#close",t.innerHTML="&#215;",r.DomEvent.disableClickPropagation(t),r.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=r.DomUtil.create("div",e+"-content-wrapper",i);r.DomEvent.disableClickPropagation(o),this._contentNode=r.DomUtil.create("div",e+"-content",o),r.DomEvent.disableScrollPropagation(this._contentNode),r.DomEvent.on(o,"contextmenu",r.DomEvent.stopPropagation),this._tipContainer=r.DomUtil.create("div",e+"-tip-container",i),this._tip=r.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,s="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",r.DomUtil.addClass(t,s)):r.DomUtil.removeClass(t,s),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=r.point(this.options.offset);e&&r.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);r.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new r.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(r.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(i),s=r.point(this.options.autoPanPadding),a=r.point(this.options.autoPanPaddingTopLeft||s),l=r.point(this.options.autoPanPaddingBottomRight||s),u=t.getSize(),c=0,h=0;o.x+n+l.x>u.x&&(c=o.x+n-u.x+l.x),o.x-c-a.x<0&&(c=o.x-a.x),o.y+e+l.y>u.y&&(h=o.y+e-u.y+l.y),o.y-h-a.y<0&&(h=o.y-a.y),(c||h)&&t.fire("autopanstart").panBy([c,h])}},_onCloseButtonClick:function(t){this._close(),r.DomEvent.stop(t)}}),r.popup=function(t,e){return new r.Popup(t,e)},r.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof r.Popup)){var i=t;t=new r.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),r.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=r.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(r.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=r.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof r.Popup?(r.setOptions(t,e),this._popup=t):this._popup=new r.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),r.LayerGroup=r.Class.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;n>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)n=this._layers[e],n[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r.stamp(t)}}),r.layerGroup=function(t){return new r.LayerGroup(t)},r.FeatureGroup=r.LayerGroup.extend({includes:r.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.off(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new r.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof r.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=r.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),r.featureGroup=function(t){return new r.FeatureGroup(t)},r.Path=r.Class.extend({includes:[r.Mixin.Events],statics:{CLIP_PADDING:function(){var e=r.Browser.mobile?1280:2e3,n=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,n))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){r.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,r.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return r.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),r.Map.include({_updatePathViewport:function(){var t=r.Path.CLIP_PADDING,e=this.getSize(),n=r.DomUtil.getPosition(this._mapPane),i=n.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),o=i.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new r.Bounds(i,o)}}),r.Path.SVG_NS="http://www.w3.org/2000/svg",r.Browser.svg=!(!n.createElementNS||!n.createElementNS(r.Path.SVG_NS,"svg").createSVGRect),r.Path=r.Path.extend({statics:{SVG:r.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return n.createElementNS(r.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&r.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(r.Browser.svg||!r.Browser.vml)&&r.DomUtil.addClass(this._path,"leaflet-clickable"),r.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)r.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),o=e.layerPointToLatLng(i);this.fire(t.type,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&r.DomEvent.preventDefault(t),"mousemove"!==t.type&&r.DomEvent.stopPropagation(t)}}}),r.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=r.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&r.Browser.any3d?(r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,o=n.y-e.y,s=this._pathRoot,a=this._panes.overlayPane;r.Browser.mobileWebkit&&a.removeChild(s),r.DomUtil.setPosition(s,e),s.setAttribute("width",i),s.setAttribute("height",o),s.setAttribute("viewBox",[e.x,e.y,i,o].join(" ")),r.Browser.mobileWebkit&&a.appendChild(s)}}}),r.Path.include({bindPopup:function(t,e){return t instanceof r.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new r.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),r.Browser.vml=!r.Browser.svg&&function(){try{var t=n.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}(),r.Path=r.Browser.svg||!r.Browser.vml?r.Path:r.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return n.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return n.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return n.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");r.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&r.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,t.dashStyle=n.dashArray?r.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):"",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),r.Map.include(r.Browser.svg||!r.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=n.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),r.Browser.canvas=function(){return!!n.createElement("canvas").getContext}(),r.Path=r.Path.SVG&&!t.L_PREFER_CANVAS||!r.Browser.canvas?r.Path:r.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return r.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!r.Path._updateRequest&&(r.Path._updateRequest=r.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){r.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color)},_drawPath:function(){var t,e,n,i,o,s;for(this._ctx.beginPath(),t=0,n=this._parts.length;n>t;t++){for(e=0,i=this._parts[t].length;i>e;e++)o=this._parts[t][e],s=(0===e?"move":"line")+"To",this._ctx[s](o.x,o.y);this instanceof r.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill()),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(t){this._containsPoint(t.layerPoint)&&this.fire("click",t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),r.Map.include(r.Path.SVG&&!t.L_PREFER_CANVAS||!r.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||(e=this._pathRoot=n.createElement("canvas"),e.style.position="absolute",t=this._canvasCtx=e.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;r.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),r.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,e){var n=t.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,r=new o(n);r[0]=r[n-1]=1,this._simplifyDPStep(t,r,e,0,n-1);var s,a=[];for(s=0;n>s;s++)r[s]&&a.push(t[s]);return a},_simplifyDPStep:function(t,e,n,i,o){var r,s,a,l=0;for(s=i+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[i],t[o],!0),a>l&&(r=s,l=a);l>n&&(e[r]=1,this._simplifyDPStep(t,e,n,i,r),this._simplifyDPStep(t,e,n,r,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,r=t.length;r>i;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return r-1>o&&n.push(t[r-1]),n},clipSegment:function(t,e,n,i){var o,r,s,a=i?this._lastCode:this._getBitCode(t,n),l=this._getBitCode(e,n);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;o=a||l,r=this._getEdgeIntersection(t,e,o,n),s=this._getBitCode(r,n),o===a?(t=r,a=s):(e=r,l=s)}},_getEdgeIntersection:function(t,e,n,i){var o=e.x-t.x,s=e.y-t.y,a=i.min,l=i.max;return 8&n?new r.Point(t.x+o*(l.y-t.y)/s,l.y):4&n?new r.Point(t.x+o*(a.y-t.y)/s,a.y):2&n?new r.Point(l.x,t.y+s*(l.x-t.x)/o):1&n?new r.Point(a.x,t.y+s*(a.x-t.x)/o):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var o,s=e.x,a=e.y,l=n.x-s,u=n.y-a,c=l*l+u*u;return c>0&&(o=((t.x-s)*l+(t.y-a)*u)/c,o>1?(s=n.x,a=n.y):o>0&&(s+=l*o,a+=u*o)),l=t.x-s,u=t.y-a,i?l*l+u*u:new r.Point(s,a)}},r.Polyline=r.Path.extend({initialize:function(t,e){r.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";e>t;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(r.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,o=this._parts,s=null,a=0,l=o.length;l>a;a++)for(var u=o[a],c=1,h=u.length;h>c;c++){e=u[c-1],n=u[c];var d=r.LineUtil._sqClosestPointOnSegment(t,e,n,!0);i>d&&(i=d,s=r.LineUtil._sqClosestPointOnSegment(t,e,n))}return s&&(s.distance=Math.sqrt(i)),s},getBounds:function(){return new r.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,o=e?t:[];for(n=0,i=t.length;i>n;n++){if(r.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;o[n]=r.latLng(t[n])}return o},_initEvents:function(){r.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=r.Path.VML,i=0,o=t.length,s="";o>i;i++)e=t[i],n&&e._round(),s+=(i?"L":"M")+e.x+" "+e.y;return s},_clipPoints:function(){var t,e,n,i=this._originalPoints,o=i.length;if(this.options.noClip)return void(this._parts=[i]);this._parts=[];var s=this._parts,a=this._map._pathViewport,l=r.LineUtil;for(t=0,e=0;o-1>t;t++)n=l.clipSegment(i[t],i[t+1],a,t),n&&(s[e]=s[e]||[],s[e].push(n[0]),(n[1]!==i[t+1]||t===o-2)&&(s[e].push(n[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=r.LineUtil,n=0,i=t.length;i>n;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),r.Path.prototype._updatePath.call(this))}}),r.polyline=function(t,e){return new r.Polyline(t,e)},r.PolyUtil={},r.PolyUtil.clipPolygon=function(t,e){var n,i,o,s,a,l,u,c,h,d=[1,4,2,8],f=r.LineUtil;for(i=0,u=t.length;u>i;i++)t[i]._code=f._getBitCode(t[i],e);for(s=0;4>s;s++){for(c=d[s],n=[],i=0,u=t.length,o=u-1;u>i;o=i++)a=t[i],l=t[o],a._code&c?l._code&c||(h=f._getEdgeIntersection(l,a,c,e),h._code=f._getBitCode(h,e),n.push(h)):(l._code&c&&(h=f._getEdgeIntersection(l,a,c,e),h._code=f._getBitCode(h,e),n.push(h)),n.push(a));t=n}return t},r.Polygon=r.Polyline.extend({options:{fill:!0},initialize:function(t,e){r.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&r.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;n>e;e++)i=this._holes[e]=this._convertLatLngs(this._holes[e]),i[0].equals(i[i.length-1])&&i.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(r.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,n,i;for(t=0,n=this._holes.length;n>t;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;i>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&r.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):r.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;i>n;n++){var o=r.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){var e=r.Polyline.prototype._getPathPartStr.call(this,t);

return e+(r.Browser.svg?"z":"x")}}),r.polygon=function(t,e){return new r.Polygon(t,e)},function(){function t(t){return r.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){i>n?t.setLatLngs(e[n++]):this.removeLayer(t)},this);i>n;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}r.MultiPolyline=t(r.Polyline),r.MultiPolygon=t(r.Polygon),r.multiPolyline=function(t,e){return new r.MultiPolyline(t,e)},r.multiPolygon=function(t,e){return new r.MultiPolygon(t,e)}}(),r.Rectangle=r.Polygon.extend({initialize:function(t,e){r.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=r.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),r.rectangle=function(t,e){return new r.Rectangle(t,e)},r.Circle=r.Path.extend({initialize:function(t,e,n){r.Path.prototype.initialize.call(this,n),this._latlng=r.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=r.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new r.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":r.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(r.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),r.circle=function(t,e,n){return new r.Circle(t,e,n)},r.CircleMarker=r.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){r.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){r.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return r.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),r.circleMarker=function(t,e){return new r.CircleMarker(t,e)},r.Polyline.include(r.Path.CANVAS?{_containsPoint:function(t,e){var n,i,o,s,a,l,u,c=this.options.weight/2;for(r.Browser.touch&&(c+=10),n=0,s=this._parts.length;s>n;n++)for(u=this._parts[n],i=0,a=u.length,o=a-1;a>i;o=i++)if((e||0!==i)&&(l=r.LineUtil.pointToSegmentDistance(t,u[o],u[i]),c>=l))return!0;return!1}}:{}),r.Polygon.include(r.Path.CANVAS?{_containsPoint:function(t){var e,n,i,o,s,a,l,u,c=!1;if(r.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(e=this._parts[o],s=0,u=e.length,a=u-1;u>s;a=s++)n=e[s],i=e[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c}}:{}),r.Circle.include(r.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),r.CircleMarker.include(r.Path.CANVAS?{_updateStyle:function(){r.Path.prototype._updateStyle.call(this)}}:{}),r.GeoJSON=r.FeatureGroup.extend({initialize:function(t,e){r.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,o=r.Util.isArray(t)?t:t.features;if(o){for(e=0,n=o.length;n>e;e++)i=o[e],(i.geometries||i.geometry||i.features||i.coordinates)&&this.addData(o[e]);return this}var s=this.options;if(!s.filter||s.filter(t)){var a=r.GeoJSON.geometryToLayer(t,s.pointToLayer,s.coordsToLatLng,s);return a.feature=r.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),s.onEachFeature&&s.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(r.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),r.extend(r.GeoJSON,{geometryToLayer:function(t,e,n,i){var o,s,a,l,u="Feature"===t.type?t.geometry:t,c=u.coordinates,h=[];switch(n=n||this.coordsToLatLng,u.type){case"Point":return o=n(c),e?e(t,o):new r.Marker(o);case"MultiPoint":for(a=0,l=c.length;l>a;a++)o=n(c[a]),h.push(e?e(t,o):new r.Marker(o));return new r.FeatureGroup(h);case"LineString":return s=this.coordsToLatLngs(c,0,n),new r.Polyline(s,i);case"Polygon":if(2===c.length&&!c[1].length)throw new Error("Invalid GeoJSON object.");return s=this.coordsToLatLngs(c,1,n),new r.Polygon(s,i);case"MultiLineString":return s=this.coordsToLatLngs(c,1,n),new r.MultiPolyline(s,i);case"MultiPolygon":return s=this.coordsToLatLngs(c,2,n),new r.MultiPolygon(s,i);case"GeometryCollection":for(a=0,l=u.geometries.length;l>a;a++)h.push(this.geometryToLayer({geometry:u.geometries[a],type:"Feature",properties:t.properties},e,n,i));return new r.FeatureGroup(h);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new r.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,o,r,s=[];for(o=0,r=t.length;r>o;o++)i=e?this.coordsToLatLngs(t[o],e-1,n):(n||this.coordsToLatLng)(t[o]),s.push(i);return s},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push(r.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?r.extend({},t.feature,{geometry:e}):r.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var a={toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this.getLatLng())})}};r.Marker.include(a),r.Circle.include(a),r.CircleMarker.include(a),r.Polyline.include({toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"LineString",coordinates:r.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),r.Polygon.include({toGeoJSON:function(){var t,e,n,i=[r.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)n=r.GeoJSON.latLngsToCoords(this._holes[t]),n.push(n[0]),i.push(n);return r.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),r.GeoJSON.getFeature(this,{type:t,coordinates:e})}}r.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),r.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),r.LayerGroup.include({toGeoJSON:function(){var e,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return t("MultiPoint").call(this);var o=n&&"GeometryCollection"===n.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(o?e.geometry:r.GeoJSON.asFeature(e)))}),o?r.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),r.geoJson=function(t,e){return new r.GeoJSON(t,e)},r.DomEvent={addListener:function(t,e,n,i){var o,s,a,l=r.stamp(n),u="_leaflet_"+e+l;return t[u]?this:(o=function(e){return n.call(i||t,e||r.DomEvent._getEvent())},r.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,o,l):(r.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,o,l),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?(s=o,a="mouseenter"===e?"mouseover":"mouseout",o=function(e){return r.DomEvent._checkMouse(t,e)?s(e):void 0},t.addEventListener(a,o,!1)):"click"===e&&r.Browser.android?(s=o,o=function(t){return r.DomEvent._filterClick(t,s)},t.addEventListener(e,o,!1)):t.addEventListener(e,o,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[u]=o,this))},removeListener:function(t,e,n){var i=r.stamp(n),o="_leaflet_"+e+i,s=t[o];return s?(r.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):r.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,r.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=r.DomEvent.stopPropagation;return r.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=r.DomEvent.stopPropagation,n=r.Draggable.START.length-1;n>=0;n--)r.DomEvent.on(t,r.Draggable.START[n],e);return r.DomEvent.on(t,"click",r.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return r.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new r.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new r.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){r.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t},_getEvent:function(){var e=t.event;if(!e)for(var n=arguments.callee.caller;n&&(e=n.arguments[0],!e||t.Event!==e.constructor);)n=n.caller;return e},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=r.DomEvent._lastClick&&n-r.DomEvent._lastClick;return i&&i>100&&500>i||t.target._simulatedClick&&!t._simulated?void r.DomEvent.stop(t):(r.DomEvent._lastClick=n,e(t))}},r.DomEvent.on=r.DomEvent.addListener,r.DomEvent.off=r.DomEvent.removeListener,r.Draggable=r.Class.extend({includes:r.Mixin.Events,statics:{START:r.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.on(this._dragStartTarget,r.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.off(this._dragStartTarget,r.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(r.DomEvent.stopPropagation(t),r.Draggable._disabled||(r.DomUtil.disableImageDrag(),r.DomUtil.disableTextSelection(),this._moving)))){var e=t.touches?t.touches[0]:t;this._startPoint=new r.Point(e.clientX,e.clientY),this._startPos=this._newPos=r.DomUtil.getPosition(this._element),r.DomEvent.on(n,r.Draggable.MOVE[t.type],this._onMove,this).on(n,r.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new r.Point(e.clientX,e.clientY),o=i.subtract(this._startPoint);(o.x||o.y)&&(r.Browser.touch&&Math.abs(o.x)+Math.abs(o.y)<3||(r.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=r.DomUtil.getPosition(this._element).subtract(o),r.DomUtil.addClass(n.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,r.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),r.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){r.DomUtil.removeClass(n.body,"leaflet-dragging"),this._lastTarget&&(r.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in r.Draggable.MOVE)r.DomEvent.off(n,r.Draggable.MOVE[t],this._onMove).off(n,r.Draggable.END[t],this._onUp);r.DomUtil.enableImageDrag(),r.DomUtil.enableTextSelection(),this._moved&&this._moving&&(r.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),r.Handler=r.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),r.Map.mergeOptions({dragging:!0,inertia:!r.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:r.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),r.Map.Drag=r.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new r.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,s=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,o=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+i-this._times[0])/1e3,l=n.easeLinearity,u=s.multiplyBy(l/a),c=u.distanceTo([0,0]),h=Math.min(n.inertiaMaxSpeed,c),d=u.multiplyBy(h/c),f=h/(n.inertiaDeceleration*l),p=d.multiplyBy(-f/2).round();p.x&&p.y?(p=e._limitOffset(p,e.options.maxBounds),r.Util.requestAnimFrame(function(){e.panBy(p,{duration:f,easeLinearity:l,noMoveStart:!0})})):e.fire("moveend")}}}),r.Map.addInitHook("addHandler","dragging",r.Map.Drag),r.Map.mergeOptions({doubleClickZoom:!0}),r.Map.DoubleClickZoom=r.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),r.Map.addInitHook("addHandler","doubleClickZoom",r.Map.DoubleClickZoom),r.Map.mergeOptions({scrollWheelZoom:!0}),r.Map.ScrollWheelZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),r.DomEvent.on(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault),this._delta=0},removeHooks:function(){r.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),r.DomEvent.off(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=r.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r.bind(this._performZoom,this),n),r.DomEvent.preventDefault(t),r.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),r.Map.addInitHook("addHandler","scrollWheelZoom",r.Map.ScrollWheelZoom),r.extend(r.DomEvent,{_touchstart:r.Browser.msPointer?"MSPointerDown":r.Browser.pointer?"pointerdown":"touchstart",_touchend:r.Browser.msPointer?"MSPointerUp":r.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function o(t){var e;if(r.Browser.pointer?(p.push(t.pointerId),e=p.length):e=t.touches.length,!(e>1)){var n=Date.now(),i=n-(a||n);l=t.touches?t.touches[0]:t,u=i>0&&c>=i,a=n}}function s(t){if(r.Browser.pointer){var n=p.indexOf(t.pointerId);if(-1===n)return;p.splice(n,1)}if(u){if(r.Browser.pointer){var i,o={};for(var s in l)i=l[s],o[s]="function"==typeof i?i.bind(l):i;l=o}l.type="dblclick",e(l),a=null}}var a,l,u=!1,c=250,h="_leaflet_",d=this._touchstart,f=this._touchend,p=[];t[h+d+i]=o,t[h+f+i]=s;var m=r.Browser.pointer?n.documentElement:t;return t.addEventListener(d,o,!1),m.addEventListener(f,s,!1),r.Browser.pointer&&m.addEventListener(r.DomEvent.POINTER_CANCEL,s,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_";return t.removeEventListener(this._touchstart,t[i+this._touchstart+e],!1),(r.Browser.pointer?n.documentElement:t).removeEventListener(this._touchend,t[i+this._touchend+e],!1),r.Browser.pointer&&n.documentElement.removeEventListener(r.DomEvent.POINTER_CANCEL,t[i+this._touchend+e],!1),this}}),r.extend(r.DomEvent,{POINTER_DOWN:r.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:r.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:r.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:r.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,i,o){var s="_leaflet_",a=this._pointers,l=function(t){r.DomEvent.preventDefault(t);for(var e=!1,n=0;n<a.length;n++)if(a[n].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],i(t)};if(t[s+"touchstart"+o]=l,t.addEventListener(this.POINTER_DOWN,l,!1),!this._pointerDocumentListener){var u=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};n.documentElement.addEventListener(this.POINTER_UP,u,!1),n.documentElement.addEventListener(this.POINTER_CANCEL,u,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s[e]=t;break}t.touches=s.slice(),t.changedTouches=[t],n(t)}}var r="_leaflet_",s=this._pointers;return t[r+"touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var o="_leaflet_",r=this._pointers,s=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}t.touches=r.slice(),t.changedTouches=[t],n(t)};return t[o+"touchend"+i]=s,t.addEventListener(this.POINTER_UP,s,!1),t.addEventListener(this.POINTER_CANCEL,s,!1),this},removePointerListener:function(t,e,n){var i="_leaflet_",o=t[i+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,o,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,o,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,o,!1),t.removeEventListener(this.POINTER_CANCEL,o,!1)}return this}}),r.Map.mergeOptions({touchZoom:r.Browser.touch&&!r.Browser.android23,bounceAtZoomLimits:!0}),r.Map.TouchZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),o=e.mouseEventToLayerPoint(t.touches[1]),s=e._getCenterLayerPoint();this._startCenter=i.add(o)._divideBy(2),this._startDist=i.distanceTo(o),this._moved=!1,this._zooming=!0,this._centerOffset=s.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),r.DomEvent.on(n,"touchmove",this._onTouchMove,this).on(n,"touchend",this._onTouchEnd,this),r.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(r.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),r.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,r.DomUtil.removeClass(t._mapPane,"leaflet-touching"),r.Util.cancelAnimFrame(this._animRequest),r.DomEvent.off(n,"touchmove",this._onTouchMove).off(n,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),o=t.getZoom(),s=t.getScaleZoom(this._scale)-o,a=s>0?Math.ceil(s):Math.floor(s),l=t._limitZoom(o+a),u=t.getZoomScale(l)/this._scale;t._animateZoom(i,l,e,u)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),r.Map.addInitHook("addHandler","touchZoom",r.Map.TouchZoom),r.Map.mergeOptions({tap:!0,tapTolerance:15}),r.Map.Tap=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(r.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new r.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&r.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(r.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),r.DomEvent.on(n,"touchmove",this._onMove,this).on(n,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),r.DomEvent.off(n,"touchmove",this._onMove,this).off(n,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&r.DomUtil.removeClass(i,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new r.Point(e.clientX,e.clientY)},_simulateEvent:function(e,i){var o=n.createEvent("MouseEvents");o._simulated=!0,i.target._simulatedClick=!0,o.initMouseEvent(e,!0,!0,t,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(o)}}),r.Browser.touch&&!r.Browser.pointer&&r.Map.addInitHook("addHandler","tap",r.Map.Tap),r.Map.mergeOptions({boxZoom:!0}),r.Map.BoxZoom=r.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){r.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){r.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(r.DomUtil.disableTextSelection(),r.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void r.DomEvent.on(n,"mousemove",this._onMouseMove,this).on(n,"mouseup",this._onMouseUp,this).on(n,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=r.DomUtil.create("div","leaflet-zoom-box",this._pane),r.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),o=i.subtract(e),s=new r.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));r.DomUtil.setPosition(n,s),this._moved=!0,n.style.width=Math.max(0,Math.abs(o.x)-4)+"px",n.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),r.DomUtil.enableTextSelection(),r.DomUtil.enableImageDrag(),r.DomEvent.off(n,"mousemove",this._onMouseMove).off(n,"mouseup",this._onMouseUp).off(n,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new r.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),r.Map.addInitHook("addHandler","boxZoom",r.Map.BoxZoom),r.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),r.Map.Keyboard=r.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),r.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;r.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var e=n.body,i=n.documentElement,o=e.scrollTop||i.scrollTop,r=e.scrollLeft||i.scrollLeft;this._map._container.focus(),t.scrollTo(r,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;n>e;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;n>e;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;n>e;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;n>e;e++)i[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;n>e;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;n>e;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){r.DomEvent.on(n,"keydown",this._onKeyDown,this)},_removeHooks:function(){r.DomEvent.off(n,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}r.DomEvent.stop(t)}}),r.Map.addInitHook("addHandler","keyboard",r.Map.Keyboard),r.Handler.MarkerDrag=r.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new r.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),r.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),r.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=r.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&r.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),r.Control=r.Class.extend({options:{position:"topright"},initialize:function(t){r.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return r.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),n=t._controlCorners[e];return n.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),r.control=function(t){return new r.Control(t)},r.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,o){var s=n+t+" "+n+o;e[t+o]=r.DomUtil.create("div",s,i)}var e=this._controlCorners={},n="leaflet-",i=this._controlContainer=r.DomUtil.create("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),r.Control.Zoom=r.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",
zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=r.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,o,s){var a=r.DomUtil.create("a",n,i);a.innerHTML=t,a.href="#",a.title=e;var l=r.DomEvent.stopPropagation;return r.DomEvent.on(a,"click",l).on(a,"mousedown",l).on(a,"dblclick",l).on(a,"click",r.DomEvent.preventDefault).on(a,"click",o,s).on(a,"click",this._refocusOnMap,s),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";r.DomUtil.removeClass(this._zoomInButton,e),r.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&r.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&r.DomUtil.addClass(this._zoomInButton,e)}}),r.Map.mergeOptions({zoomControl:!0}),r.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new r.Control.Zoom,this.addControl(this.zoomControl))}),r.control.zoom=function(t){return new r.Control.Zoom(t)},r.Control.Attribution=r.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){r.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=r.DomUtil.create("div","leaflet-control-attribution"),r.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),r.Map.mergeOptions({attributionControl:!0}),r.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new r.Control.Attribution).addTo(this))}),r.control.attribution=function(t){return new r.Control.Attribution(t)},r.Control.Scale=r.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",n=r.DomUtil.create("div",e),i=this.options;return this._addScales(i,e,n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=r.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=r.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180),i=n*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),r=this.options,s=0;o.x>0&&(s=i*(r.maxWidth/o.x)),this._updateScales(r,s)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,o=3.2808399*t,r=this._iScale;o>5280?(e=o/5280,n=this._getRoundNum(e),r.style.width=this._getScaleWidth(n/e)+"px",r.innerHTML=n+" mi"):(i=this._getRoundNum(o),r.style.width=this._getScaleWidth(i/o)+"px",r.innerHTML=i+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),r.control.scale=function(t){return new r.Control.Scale(t)},r.Control.Layers=r.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){r.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=r.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=r.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),r.Browser.touch?r.DomEvent.on(e,"click",r.DomEvent.stopPropagation):r.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=r.DomUtil.create("form",t+"-list");if(this.options.collapsed){r.Browser.android||r.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=r.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",r.Browser.touch?r.DomEvent.on(i,"click",r.DomEvent.stop).on(i,"click",this._expand,this):r.DomEvent.on(i,"focus",this._expand,this),r.DomEvent.on(n,"click",function(){setTimeout(r.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=r.DomUtil.create("div",t+"-base",n),this._separator=r.DomUtil.create("div",t+"-separator",n),this._overlaysList=r.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=r.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[r.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(i+=' checked="checked"'),i+="/>";var o=n.createElement("div");return o.innerHTML=i,o.firstChild},_addItem:function(t){var e,i=n.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?(e=n.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=o):e=this._createRadioElement("leaflet-base-layers",o),e.layerId=r.stamp(t.layer),r.DomEvent.on(e,"click",this._onInputClick,this);var s=n.createElement("span");s.innerHTML=" "+t.name,i.appendChild(e),i.appendChild(s);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(i),i},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),o=i.length;for(this._handlingClick=!0,t=0;o>t;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),r.control.layers=function(t,e,n){return new r.Control.Layers(t,e,n)},r.PosAnimation=r.Class.extend({includes:r.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[r.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",r.DomEvent.on(t,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),r.DomUtil.setPosition(t,e),r.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(r.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(r.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),r.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,n,i,o=this._el,s=t.getComputedStyle(o);if(r.Browser.any3d){if(i=s[r.DomUtil.TRANSFORM].match(this._transformRe),!i)return;e=parseFloat(i[1]),n=parseFloat(i[2])}else e=parseFloat(s.left),n=parseFloat(s.top);return new r.Point(e,n,!0)},_onTransitionEnd:function(){r.DomEvent.off(this._el,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[r.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),r.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(r.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=r.extend({animate:n.animate},n.zoom),n.pan=r.extend({animate:n.animate},n.pan));var o=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=r.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new r.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){r.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){r.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(n)?(this.panBy(n,e),!0):!1}}),r.PosAnimation=r.DomUtil.TRANSITION?r.PosAnimation:r.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=r.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=r.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));r.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){r.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),r.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),r.DomUtil.TRANSITION&&r.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&r.DomUtil.TRANSITION&&r.Browser.any3d&&!r.Browser.android23&&!r.Browser.mobileOpera,this._zoomAnimated&&r.DomEvent.on(this._mapPane,r.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),r.Map.include(r.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i),r=this._getCenterLayerPoint()._add(o);return n.animate===!0||this.getSize().contains(o)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,i,null,!0),!0):!1},_animateZoom:function(t,e,n,i,o,s,a){a||(this._animatingZoom=!0),r.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,r.Draggable&&(r.Draggable._disabled=!0),r.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:o,backwards:s})},this)},_onZoomTransitionEnd:function(){this._animatingZoom=!1,r.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),r.Draggable&&(r.Draggable._disabled=!1)}}:{}),r.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=r.DomUtil.TRANSFORM,i=t.delta?r.DomUtil.getTranslateString(t.delta):e.style[n],o=r.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?o+" "+i:i+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),r.Util.falseFn(e.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[r.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);return e&&n>.5&&.5>i?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[r.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),o=0;for(e=0,n=i.length;n>e;e++)i[e].complete&&o++;return o/n},_stopLoadingImages:function(t){var e,n,i,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=o.length;n>e;e++)i=o[e],i.complete||(i.onload=r.Util.falseFn,i.onerror=r.Util.falseFn,i.src=r.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),r.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=r.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=r.bind(this._handleGeolocationResponse,this),n=r.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new r.LatLng(e,n),o=180*t.coords.accuracy/40075017,s=o/Math.cos(r.LatLng.DEG_TO_RAD*e),a=r.latLngBounds([e-o,n-s],[e+o,n+s]),l=this._locateOptions;if(l.setView){var u=Math.min(this.getBoundsZoom(a),l.maxZoom);this.setView(i,u)}var c={latlng:i,bounds:a,timestamp:t.timestamp};for(var h in t.coords)"number"==typeof t.coords[h]&&(c[h]=t.coords[h]);this.fire("locationfound",c)}})}(window,document)},{}],25:[function(t,e,i){!function(){function t(t,e){function n(e){var n,i=t.arcs[0>e?~e:e],o=i[0];return t.transform?(n=[0,0],i.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=i[i.length-1],0>e?[n,o]:[o,n]}function i(t,e){for(var n in t){var i=t[n];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){o[0>t?~t:t]=1}),a.push(i)}}var o={},r={},s={},a=[],l=-1;return e.forEach(function(n,i){var o,r=t.arcs[0>n?~n:n];r.length<3&&!r[1][0]&&!r[1][1]&&(o=e[++l],e[l]=n,e[i]=o)}),e.forEach(function(t){var e,i,o=n(t),a=o[0],l=o[1];if(e=s[a])if(delete s[e.end],e.push(t),e.end=l,i=r[l]){delete r[i.start];var u=i===e?e:e.concat(i);r[u.start=e.start]=s[u.end=i.end]=u}else r[e.start]=s[e.end]=e;else if(e=r[l])if(delete r[e.start],e.unshift(t),e.start=a,i=s[a]){delete s[i.end];var c=i===e?e:i.concat(e);r[c.start=i.start]=s[c.end=e.end]=c}else r[e.start]=s[e.end]=e;else e=[t],r[e.start=a]=s[e.end=l]=e}),i(s,r),i(r,s),e.forEach(function(t){o[0>t?~t:t]||a.push([t])}),a}function i(e,n,i){function o(t){var e=0>t?~t:t;(c[e]||(c[e]=[])).push({i:t,g:u})}function r(t){t.forEach(o)}function s(t){t.forEach(r)}function a(t){"GeometryCollection"===t.type?t.geometries.forEach(a):t.type in h&&(u=t,h[t.type](t.arcs))}var l=[];if(arguments.length>1){var u,c=[],h={LineString:r,MultiLineString:s,Polygon:s,MultiPolygon:function(t){t.forEach(s)}};a(n),c.forEach(arguments.length<3?function(t){l.push(t[0].i)}:function(t){i(t[0].g,t[t.length-1].g)&&l.push(t[0].i)})}else for(var d=0,f=e.arcs.length;f>d;++d)l.push(d);return{type:"MultiLineString",arcs:t(e,l)}}function o(e,i){function o(t){t.forEach(function(e){e.forEach(function(e){(s[e=0>e?~e:e]||(s[e]=[])).push(t)})}),l.push(t)}function r(t){return d(a(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var s={},l=[],u=[];return i.forEach(function(t){"Polygon"===t.type?o(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(o)}),l.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,u.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){s[0>t?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),l.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:u.map(function(i){var o=[];if(i.forEach(function(t){t.forEach(function(t){t.forEach(function(t){s[0>t?~t:t].length<2&&o.push(t)})})}),o=t(e,o),(n=o.length)>1)for(var a,l=r(i[0][0]),u=0;u<n;++u)if(l===r(o[u])){a=o[0],o[0]=o[u],o[u]=a;break}return o})}}function r(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return s(t,e)})}:s(t,e)}function s(t,e){var n={type:"Feature",id:e.id,properties:e.properties||{},geometry:a(t,e)};return null==e.id&&delete n.id,n}function a(t,e){function n(t,e){e.length&&e.pop();for(var n,i=c[0>t?~t:t],o=0,r=i.length;r>o;++o)e.push(n=i[o].slice()),u(n,o);0>t&&l(e,r)}function i(t){return t=t.slice(),u(t,0),t}function o(t){for(var e=[],i=0,o=t.length;o>i;++i)n(t[i],e);return e.length<2&&e.push(e[0].slice()),e}function r(t){for(var e=o(t);e.length<4;)e.push(e[0].slice());return e}function s(t){return t.map(r)}function a(t){var e=t.type;return"GeometryCollection"===e?{type:e,geometries:t.geometries.map(a)}:e in h?{type:e,coordinates:h[e](t)}:null}var u=g(t.transform),c=t.arcs,h={Point:function(t){return i(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(i)},LineString:function(t){return o(t.arcs)},MultiLineString:function(t){return t.arcs.map(o)},Polygon:function(t){return s(t.arcs)},MultiPolygon:function(t){return t.arcs.map(s)}};return a(e)}function l(t,e){for(var n,i=t.length,o=i-e;o<--i;)n=t[o],t[o++]=t[i],t[i]=n}function u(t,e){for(var n=0,i=t.length;i>n;){var o=n+i>>>1;t[o]<e?n=o+1:i=o}return n}function c(t){function e(t,e){t.forEach(function(t){0>t&&(t=~t);var n=o[t];n?n.push(e):o[t]=[e]})}function n(t,n){t.forEach(function(t){e(t,n)})}function i(t,e){"GeometryCollection"===t.type?t.geometries.forEach(function(t){i(t,e)}):t.type in s&&s[t.type](t.arcs,e)}var o={},r=t.map(function(){return[]}),s={LineString:e,MultiLineString:n,Polygon:n,MultiPolygon:function(t,e){t.forEach(function(t){n(t,e)})}};t.forEach(i);for(var a in o)for(var l=o[a],c=l.length,h=0;c>h;++h)for(var d=h+1;c>d;++d){var f,p=l[h],m=l[d];(f=r[p])[a=u(f,m)]!==m&&f.splice(a,0,m),(f=r[m])[a=u(f,p)]!==p&&f.splice(a,0,p)}return r}function h(t,e){function n(t){r.remove(t),t[1][2]=e(t),r.push(t)}var i=g(t.transform),o=v(t.transform),r=m();return e||(e=f),t.arcs.forEach(function(t){for(var s,a,l=[],u=0,c=0,h=t.length;h>c;++c)a=t[c],i(t[c]=[a[0],a[1],1/0],c);for(var c=1,h=t.length-1;h>c;++c)s=t.slice(c-1,c+2),s[1][2]=e(s),l.push(s),r.push(s);for(var c=0,h=l.length;h>c;++c)s=l[c],s.previous=l[c-1],s.next=l[c+1];for(;s=r.pop();){var d=s.previous,f=s.next;s[1][2]<u?s[1][2]=u:u=s[1][2],d&&(d.next=f,d[2]=s[2],n(d)),f&&(f.previous=d,f[0]=s[0],n(f))}t.forEach(o)}),t}function d(t){for(var e,n=-1,i=t.length,o=t[i-1],r=0;++n<i;)e=o,o=t[n],r+=e[0]*o[1]-e[1]*o[0];return.5*r}function f(t){var e=t[0],n=t[1],i=t[2];return Math.abs((e[0]-i[0])*(n[1]-e[1])-(e[0]-n[0])*(i[1]-e[1]))}function p(t,e){return t[1][2]-e[1][2]}function m(){function t(t,e){for(;e>0;){var n=(e+1>>1)-1,o=i[n];if(p(t,o)>=0)break;i[o._=e]=o,i[t._=e=n]=t}}function e(t,e){for(;;){var n=e+1<<1,r=n-1,s=e,a=i[s];if(o>r&&p(i[r],a)<0&&(a=i[s=r]),o>n&&p(i[n],a)<0&&(a=i[s=n]),s===e)break;i[a._=e]=a,i[t._=e=s]=t}}var n={},i=[],o=0;return n.push=function(e){return t(i[e._=o]=e,o++),o},n.pop=function(){if(!(0>=o)){var t,n=i[0];return--o>0&&(t=i[o],e(i[t._=0]=t,0)),n}},n.remove=function(n){var r,s=n._;if(i[s]===n)return s!==--o&&(r=i[o],(p(r,n)<0?t:e)(i[r._=s]=r,s)),s},n}function g(t){if(!t)return y;var e,n,i=t.scale[0],o=t.scale[1],r=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0),t[0]=(e+=t[0])*i+r,t[1]=(n+=t[1])*o+s}}function v(t){if(!t)return y;var e,n,i=t.scale[0],o=t.scale[1],r=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0);var l=(t[0]-r)/i|0,u=(t[1]-s)/o|0;t[0]=l-e,t[1]=u-n,e=l,n=u}}function y(){}var _={version:"1.6.19",mesh:function(t){return a(t,i.apply(this,arguments))},meshArcs:i,merge:function(t){return a(t,o.apply(this,arguments))},mergeArcs:o,feature:r,neighbors:c,presimplify:h};"function"==typeof define&&define.amd?define(_):"object"==typeof e&&e.exports?e.exports=_:this.topojson=_}()},{}],26:[function(t,e,n){(function(n){function i(t,e){if(!e.steps)throw new Error("steps option missing");this.options=e,this.running=!1,this._tick=this._tick.bind(this),this._t0=+new Date,this.callback=t,this._time=0,this.itemsReady=!1,this.options=o.extend({animationDelay:0,maxDelta:.2,loop:void 0===e.loop?!0:e.loop},this.options),this.rescale()}var o=t("./"),r=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame||function(t){return n.setTimeout(t,1e3/60)},s=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.msCancelAnimationFrame||function(t){clearTimeout(t)};i.prototype={start:function(){this.running=!0,r(this._tick),this.options.onStart&&this.options.onStart(),1===this.options.steps&&(this.running=!1)},isRunning:function(){return this.running},stop:function(){this.pause(),this.time(0),this.options.onStop&&this.options.onStop()},time:function(t){if(!arguments.length)return this._time;this._time=t;var e=this.range(this.domain(this._time));this.callback(e)},toggle:function(){this.running?this.pause():this.start()},rescale:function(){return this.domainInv=o.math.linear(this.options.animationDelay,this.options.animationDelay+this.options.animationDuration),this.domain=this.domainInv.invert(),this.range=o.math.linear(0,this.options.steps),this.rangeInv=this.range.invert(),this.time(this._time),this.start(),this},duration:function(t){return arguments.length?(this.options.animationDuration=t,this.time()>t&&this.time(0),this.rescale(),this):this.options.animationDuration},steps:function(t){return this.options.steps=t,this.rescale()},step:function(t){return 0===arguments.length?this.range(this.domain(this._time)):void(this._time=this.domainInv(this.rangeInv(t)))},pause:function(){this.running=!1,s(this._tick),this.options.onPause&&this.options.onPause()},_tick:function(){var t=+new Date,e=.001*(t-this._t0);e=Math.min(this.options.maxDelta,e),this._t0=t,this._time+=e,this.step()>=this.options.steps&&(this.options.loop?this._time=0:(this.time(this.options.animationDuration),this.pause())),this.running&&(this.time(this._time),r(this._tick))}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":35}],27:[function(t,e,n){var i={version:"1.0.0",style:{"comp-op":{css:"comp-op","default-value":"src-over","default-meaning":"add the current layer on top of other layers",doc:"Composite operation. This defines how this layer should behave relative to layers atop or below it.",type:["src","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","darken","lighten"]}},layer:{"buffer-size":{"default-value":"0",type:"float","default-meaning":"No buffer will be used",doc:"Extra tolerance around the Layer extent (in pixels) used to when querying and (potentially) clipping the layer data during rendering"},"-torque-clear-color":{css:"-torque-clear-color",type:"color","default-value":"rgba(255, 255, 255, 0)","default-meaning":"full clear",doc:"color used to clear canvas on each frame"},"-torque-frame-count":{css:"-torque-frame-count","default-value":"128",type:"number","default-meaning":"the data is broken into 128 time frames",doc:"Number of animation steps/frames used in the animation. If the data contains a fewere number of total frames, the lesser value will be used."},"-torque-resolution":{css:"-torque-resolution","default-value":"2",type:"number","default-meaning":"",doc:"Spatial resolution in pixels. A resolution of 1 means no spatial aggregation of the data. Any other resolution of N results in spatial aggregation into cells of NxN pixels. The value N must be power of 2"},"-torque-animation-duration":{css:"-torque-animation-duration","default-value":"30",type:"number","default-meaning":"the animation lasts 30 seconds",doc:"Animation duration in seconds"},"-torque-aggregation-function":{css:"-torque-aggregation-function","default-value":"count(cartodb_id)",type:"string","default-meaning":"the value for each cell is the count of points in that cell",doc:"A function used to calculate a value from the aggregate data for each cell. See -torque-resolution"},"-torque-time-attribute":{css:"-torque-time-attribute","default-value":"time",type:"string","default-meaning":"the data column in your table that is of a time based type",doc:"The table column that contains the time information used create the animation"},"-torque-data-aggregation":{css:"-torque-data-aggregation","default-value":"linear",type:["cumulative"],"default-meaning":"previous values are discarded",doc:"A linear animation will discard previous values while a cumulative animation will accumulate them until it restarts"}},symbolizers:{"*":{"comp-op":{css:"comp-op","default-value":"src-over","default-meaning":"add the current layer on top of other layers",doc:"Composite operation. This defines how this layer should behave relative to layers atop or below it.",type:["src","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","darken","lighten"]},opacity:{css:"opacity",type:"float",doc:"An alpha value for the style (which means an alpha applied to all features in separate buffer and then composited back to main buffer)","default-value":1,"default-meaning":"no separate buffer will be used and no alpha will be applied to the style after rendering"}},trail:{steps:{css:"trail-steps",type:"float","default-value":1,"default-meaning":"no trail steps",doc:"How many steps of trails are going to be rendered"}},polygon:{fill:{css:"polygon-fill",type:"color","default-value":"rgba(128,128,128,1)","default-meaning":"gray and fully opaque (alpha = 1), same as rgb(128,128,128)",doc:"Fill color to assign to a polygon"},"fill-opacity":{css:"polygon-opacity",type:"float",doc:"The opacity of the polygon","default-value":1,"default-meaning":"opaque"}},line:{stroke:{css:"line-color","default-value":"rgba(0,0,0,1)",type:"color","default-meaning":"black and fully opaque (alpha = 1), same as rgb(0,0,0)",doc:"The color of a drawn line"},"stroke-width":{css:"line-width","default-value":1,type:"float",doc:"The width of a line in pixels"},"stroke-opacity":{css:"line-opacity","default-value":1,type:"float","default-meaning":"opaque",doc:"The opacity of a line"},"stroke-linejoin":{css:"line-join","default-value":"miter",type:["miter","round","bevel"],doc:"The behavior of lines when joining"},"stroke-linecap":{css:"line-cap","default-value":"butt",type:["butt","round","square"],doc:"The display of line endings"}},markers:{file:{css:"marker-file",doc:"An SVG file that this marker shows at each placement. If no file is given, the marker will show an ellipse.","default-value":"","default-meaning":"An ellipse or circle, if width equals height",type:"uri"},opacity:{css:"marker-opacity",doc:"The overall opacity of the marker, if set, overrides both the opacity of both the fill and stroke","default-value":1,"default-meaning":"The stroke-opacity and fill-opacity will be used",type:"float"},"fill-opacity":{css:"marker-fill-opacity",doc:"The fill opacity of the marker","default-value":1,"default-meaning":"opaque",type:"float"},stroke:{css:"marker-line-color",doc:"The color of the stroke around a marker shape.","default-value":"black",type:"color"},"stroke-width":{css:"marker-line-width",doc:"The width of the stroke around a marker shape, in pixels. This is positioned on the boundary, so high values can cover the area itself.",type:"float"},"stroke-opacity":{css:"marker-line-opacity","default-value":1,"default-meaning":"opaque",doc:"The opacity of a line",type:"float"},fill:{css:"marker-fill","default-value":"blue",doc:"The color of the area of the marker.",type:"color"},"marker-type":{css:"marker-type",type:["rectangle","ellipse"],"default-value":"ellipse",doc:"The default marker-type. If a SVG file is not given as the marker-file parameter, the renderer provides either an rectangle or an ellipse (a circle if height is equal to width)"},width:{css:"marker-width","default-value":10,doc:"The width of the marker, if using one of the default types.",type:"float"}},point:{file:{css:"point-file",type:"uri",required:!1,"default-value":"none",doc:"Image file to represent a point"},opacity:{css:"point-opacity",type:"float","default-value":1,"default-meaning":"Fully opaque",doc:"A value from 0 to 1 to control the opacity of the point"}}},colors:{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],
darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50],transparent:[0,0,0,0]}};e.exports={version:{latest:i,"1.0.0":i}}},{}],28:[function(t,e,n){(function(n){function i(){}var o=n.carto||t("carto");i.prototype={},i.optionsFromLayer=function(t){var e={};if(!t)return e;var n={"buffer-size":"buffer-size","-torque-frame-count":"steps","-torque-resolution":"resolution","-torque-animation-duration":"animationDuration","-torque-aggregation-function":"countby","-torque-time-attribute":"column","-torque-data-aggregation":"data_aggregation"};for(var i in n){var o=t.eval(i);if(void 0!==o){var r=n[i];e[r]=o}}return e},i.optionsFromCartoCSS=function(t){var e=(new o.RendererJS).render(t),n=e.findLayer({name:"Map"});return i.optionsFromLayer(n)},e.exports.TorqueLayer=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{carto:54}],29:[function(t,e,n){(function(t){function n(){for(var t=arguments,e=t[0],n=1;n<t.length;++n){var i=t[n];for(var o in i)e[o]=i[o]}return e}function i(t){return n({},t)}function o(t){return"function"==typeof t||!1}function r(t){return t&&"object"==typeof t&&"[object Array]"==Object.prototype.toString.call(t)}function s(){return!!document.createElement("canvas")}function a(){return"undefined"!=typeof navigator?navigator.userAgent:""}var l={};l.on=function(t,e){var n=this._evt_callbacks=this._evt_callbacks||{},i=n[t]||(n[t]=[]);return i.push(e),this},l.trigger=function(t){for(var e=this._evt_callbacks&&this._evt_callbacks[t],n=0;e&&n<e.length;++n)e[n].apply(this,Array.prototype.slice.call(arguments,1));return this},l.fire=l.trigger,l.off=function(t,e){var n=this._evt_callbacks&&this._evt_callbacks[t];if(n&&!e)return delete this._evt_callbacks[t],this;for(var i=[],o=0;n&&o<n.length;++o)n[o]===e&&i.push(o);for(;void 0!==(o=i.pop());)n.splice(o,1);return this},l.callbacks=function(t){return this._evt_callbacks&&this._evt_callbacks[t]||[]};var u={Uint8Array:"undefined"!=typeof t.Uint8Array?t.Uint8Array:Array,Uint32Array:"undefined"!=typeof t.Uint32Array?t.Uint32Array:Array,Int16Array:"undefined"!=typeof t.Int16Array?t.Int16Array:Array,Int32Array:"undefined"!=typeof t.Int32Array?t.Int32Array:Array},c={sprites_to_images:-1===a().indexOf("Safari")};e.exports={Event:l,extend:n,clone:i,isFunction:o,isArray:r,types:u,isBrowserSupported:s,flags:c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],30:[function(t,e,n){function i(t){function e(t,e){return function(){e.apply(t)}}this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=i.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var n=document.createElement("canvas");n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.pointerEvents="none",this.canvas=n,this.repositionFunction_=e(this,this.repositionCanvas_),this.resizeFunction_=e(this,this.resize_),this.requestUpdateFunction_=e(this,this.update_),t&&this.setOptions(t)}i.prototype=new google.maps.OverlayView,i.DEFAULT_PANE_NAME_="overlayLayer",i.CSS_TRANSFORM_=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],n=0;n<e.length;n++){var i=e[n];if(void 0!==t.style[i])return i}return e[0]}(),i.prototype.requestAnimFrame_=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},i.prototype.cancelAnimFrame_=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){},i.prototype.setOptions=function(t){void 0!==t.animate&&this.setAnimate(t.animate),void 0!==t.paneName&&this.setPane(t.paneName),void 0!==t.updateHandler&&this.setUpdateHandler(t.updateHandler),void 0!==t.resizeHandler&&this.setResizeHandler(t.resizeHandler),t.readyHandler&&(this.readyHandler=t.readyHandler)},i.prototype.setAnimate=function(t){this.isAnimated_=!!t,this.isAnimated_&&this.scheduleUpdate()},i.prototype.isAnimated=function(){return this.isAnimated_},i.prototype.setPaneName=function(t){this.paneName_=t,this.setPane_()},i.prototype.getPaneName=function(){return this.paneName_},i.prototype.setPane_=function(){if(this.isAdded_){var t=this.getPanes();if(!t[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');t[this.paneName_].appendChild(this.canvas)}},i.prototype.setResizeHandler=function(t){this.resizeHandler_=t},i.prototype.setUpdateHandler=function(t){this.updateHandler_=t},i.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_(),this.readyHandler&&this.readyHandler())},i.prototype.onRemove=function(){this.isAdded_&&(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(window,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},i.prototype.resize_=function(){if(this.isAdded_){var t=this.getMap(),e=t.getDiv().offsetWidth,n=t.getDiv().offsetHeight,i=this.canvas.width,o=this.canvas.height;(i!==e||o!==n)&&(this.canvas.width=e,this.canvas.height=n,this.canvas.style.width=e+"px",this.canvas.style.height=n+"px",this.needsResize_=!0,this.scheduleUpdate())}},i.prototype.draw=function(){this.repositionCanvas_()},i.prototype.repositionCanvas_=function(){var t=this.getMap().getBounds();this.topLeft_=new google.maps.LatLng(t.getNorthEast().lat(),t.getSouthWest().lng());var e=this.getProjection(),n=e.fromLatLngToDivPixel(this.topLeft_),o=256*(1<<this.getMap().getZoom());Math.abs(n.x)>o&&(n.x-=o),this.canvas.style[i.CSS_TRANSFORM_]="translate("+Math.round(n.x)+"px,"+Math.round(n.y)+"px)",this.scheduleUpdate()},i.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},i.prototype.getTopLeft=function(){return this.topLeft_},i.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(window,this.requestUpdateFunction_))},e.exports=i},{}],31:[function(t,e,n){function i(t,e){this.tileSize=new google.maps.Size(256,256),this.maxZoom=19,this.name="Tile #s",this.alt="Canvas tile layer",this.tiles={},this.canvas_setup=t,this.render=e,e||(this.render=t)}i.prototype.create_tile_canvas=function(t,e,n){var i=n.createElement("canvas"),o=n.createElement("canvas");i.style.border=o.style.border="none",i.style.margin=o.style.margin="0",i.style.padding=o.style.padding="0";var r=i.getContext("2d");r.width=i.width=this.tileSize.width,r.height=i.height=this.tileSize.height;var s=o.getContext("2d");o.width=s.width=this.tileSize.width,o.height=s.height=this.tileSize.height;var a=t.x+"_"+t.y+"_"+e;return i.setAttribute("id",a),o.setAttribute("id",a),a in this.tiles&&delete this.tiles[a],this.tiles[a]={canvas:i,ctx:r,hit_canvas:o,hit_ctx:s,coord:t,zoom:e,primitives:null},this.canvas_setup&&this.canvas_setup(this.tiles[a],t,e),i},i.prototype.each=function(t){for(var e in this.tiles){var n=this.tiles[e];t(n)}},i.prototype.recreate=function(){for(var t in this.tiles){var e=this.tiles[t];this.canvas_setup(e,e.coord,e.zoom)}},i.prototype.redraw_tile=function(t){this.render(t,t.coord,t.zoom)},i.prototype.redraw=function(){for(var t in this.tiles){var e=this.tiles[t];this.render(e,e.coord,e.zoom)}},i.prototype.getTile=function(t,e,n){return this.create_tile_canvas(t,e,n)},i.prototype.releaseTile=function(t){var e=t.getAttribute("id");delete this.tiles[e]},e.exports=i},{}],32:[function(t,e,n){function i(){}i.prototype={_initTileLoader:function(t,e){this._map=t,this._projection=e,this._tiles={},this._tilesLoading={},this._tilesToLoad=0,this._updateTiles=this._updateTiles.bind(this),this._listeners=[],this._listeners.push(google.maps.event.addListener(this._map,"dragend",this._updateTiles),google.maps.event.addListener(this._map,"zoom_changed",this._updateTiles)),this.tileSize=256,this._updateTiles()},_removeTileLoader:function(){for(var t in this._listeners)google.maps.event.removeListener(this._listeners[t]);this._removeTiles()},_removeTiles:function(){for(var t in this._tiles)this._removeTile(t)},_reloadTiles:function(){this._removeTiles(),this._updateTiles()},_updateTiles:function(){if(this._map){var t=this._map.getBounds(),e=this._map.getZoom(),n=this.tileSize,i=1<<e,o=new google.maps.LatLng(t.getNorthEast().lat(),t.getSouthWest().lng()),r=new google.maps.LatLng(t.getSouthWest().lat(),t.getNorthEast().lng());this._projection=this._map.getProjection();var s=this._projection.fromLatLngToPoint(o),a=this._projection.fromLatLngToPoint(r),l=new google.maps.Point(Math.floor(s.x*i/n),Math.floor(s.y*i/n)),u=new google.maps.Point(Math.floor(a.x*i/n),Math.floor(a.y*i/n));this._addTilesFromCenterOut(l,u),this._removeOtherTiles(l,u)}},_removeOtherTiles:function(t,e){var n,i,o,r,s=this._map.getZoom();for(r in this._tiles)this._tiles.hasOwnProperty(r)&&(n=r.split(":"),i=parseInt(n[0],10),o=parseInt(n[1],10),z=parseInt(n[2],10),(z!==s||i<t.x||i>e.x||o<t.y||o>e.y)&&this._removeTile(r))},_removeTile:function(t){this.onTileRemoved&&this.onTileRemoved(this._tiles[t]),delete this._tiles[t],delete this._tilesLoading[t]},_tileKey:function(t){return t.x+":"+t.y+":"+t.zoom},_tileShouldBeLoaded:function(t){var e=this._tileKey(t);return!(e in this._tiles||e in this._tilesLoading)},_tileLoaded:function(t,e){this._tilesToLoad--;var n=t.x+":"+t.y+":"+t.zoom;this._tiles[n]=e,delete this._tilesLoading[n],0===this._tilesToLoad&&this.onTilesLoaded&&this.onTilesLoaded()},getTilePos:function(t){var e=1<<this._map.getZoom();t={x:(t.x%e+e)%e,y:t.y},t=new google.maps.Point(t.x*this.tileSize,t.y*this.tileSize);var n=this._map.getBounds(),i=new google.maps.LatLng(n.getNorthEast().lat(),n.getSouthWest().lng()),o=this._map.getProjection().fromLatLngToPoint(i);return zoom=1<<this._map.getZoom(),o.x=o.x*zoom,o.y=o.y*zoom,new google.maps.Point(t.x-o.x,t.y-o.y)},_addTilesFromCenterOut:function(t,e){function n(t){var e=t.x-a.x,n=t.y-a.y;return e*e+n*n}var i,o,r,s=[],a=new google.maps.Point(.5*(t.x+e.x),.5*(t.y+e.y)),l=this._map.getZoom();for(i=t.y;i<=e.y;i++)for(o=t.x;o<=e.x;o++)r=new google.maps.Point(o,i),r.zoom=l,this._tileShouldBeLoaded(r)&&s.push(r);var u=s.length;if(0!==u){for(s.sort(function(t,e){return n(t)-n(e)}),this._tilesToLoad+=u,o=0;u>o;o++){var c=s[o],h=this._tileKey(c);this._tilesLoading[h]=c,this.onTileAdded&&this.onTileAdded(c)}this.onTilesLoading&&this.onTilesLoading()}}},e.exports=i},{}],33:[function(t,e,n){var i={};"undefined"!=typeof google&&"undefined"!=typeof google.maps&&(i=t("./torque"),i.GMapsTileLoader=t("./gmaps_tileloader_mixin")),e.exports=i},{"./gmaps_tileloader_mixin":32,"./torque":34}],34:[function(t,e,n){(function(n){function i(t){var e=this;if(!s.isBrowserSupported())throw new Error("browser is not supported by torque");this.key=0,this.shader=null,this.ready=!1,this.options=s.extend({},t),this.options=s.extend({provider:"windshaft",renderer:"point",resolution:2,steps:100,visible:!0},this.options),t.cartocss&&s.extend(this.options,s.common.TorqueLayer.optionsFromCartoCSS(t.cartocss)),this.hidden=!this.options.visible,this.animator=new s.Animator(function(t){var n=0|t;e.key!==n&&e.setKey(n)},s.clone(this.options)),this.play=this.animator.start.bind(this.animator),this.stop=this.animator.stop.bind(this.animator),this.pause=this.animator.pause.bind(this.animator),this.toggle=this.animator.toggle.bind(this.animator),this.setDuration=this.animator.duration.bind(this.animator),this.isRunning=this.animator.isRunning.bind(this.animator),a.call(this,{map:this.options.map,animate:!1,updateHandler:this.render,readyHandler:this.initialize})}function o(t){this.options=s.extend({},t),l.call(this,this._loadTile.bind(this),this.drawTile.bind(this)),this.initialize(t)}var r=n.carto||t("carto"),s=t("../"),a=t("./CanvasLayer"),l=t("./canvas_tile_layer"),u=t("./gmaps_tileloader_mixin");i.prototype=s.extend({},a.prototype,u.prototype,s.Event,{providers:{sql_api:s.providers.json,url_template:s.providers.jsonarray,windshaft:s.providers.windshaft},renderers:{point:s.renderer.Point,pixel:s.renderer.Rectangle},initialize:function(){var t=this;this.onTileAdded=this.onTileAdded.bind(this),this.options.ready=function(){t.fire("change:bounds",{bounds:t.provider.getBounds()}),t.animator.steps(t.provider.getSteps()),t.animator.rescale(),t.fire("change:steps",{steps:t.provider.getSteps()}),t.setKey(t.key)},this.provider=new this.providers[this.options.provider](this.options),this.renderer=new this.renderers[this.options.renderer](this.getCanvas(),this.options),this._cacheListener=google.maps.event.addListener(this.options.map,"zoom_changed",function(){t.renderer&&t.renderer.clearSpriteCache()}),this._initTileLoader(this.options.map,this.getProjection()),this.shader&&this.renderer.setShader(this.shader)},hide:function(){return this.hidden?this:(this.pause(),this.clear(),this.hidden=!0,this)},show:function(){return this.hidden?(this.hidden=!1,this.play(),this):this},setSQL:function(t){if(!this.provider||!this.provider.setSQL)throw new Error("this provider does not support SQL");return this.provider.setSQL(t),this._reloadTiles(),this},setBlendMode:function(t){this.renderer&&this.renderer.setBlendMode(t),this.redraw()},setSteps:function(t){this.provider&&this.provider.setSteps(t),this.animator&&this.animator.steps(t),this._reloadTiles()},setColumn:function(t,e){this.provider&&this.provider.setColumn(t,e),this._reloadTiles()},getTimeBounds:function(){return this.provider&&this.provider.getKeySpan()},getCanvas:function(){return this.canvas},onTileAdded:function(t){var e=this;this.provider.getTileData(t,t.zoom,function(n){t.zoom===e.options.map.getZoom()&&(e._tileLoaded(t,n),n&&e.redraw())})},clear:function(){var t=this.canvas;t.width=t.width},render:function(){if(!this.hidden){var t,e,n,i=this.canvas;this.renderer.clearCanvas();var o=i.getContext("2d");for(t in this._tiles)e=this._tiles[t],e&&(n=this.getTilePos(e.coord),o.setTransform(1,0,0,1,n.x,n.y),this.renderer.renderTile(e,this.key))}},getActivePointsBBox:function(t){{var e=[];this.options.resolution*(256/this.options.resolution-1)}for(var n in this._tiles){var i=this._tiles[n];e=e.concat(this.renderer.getActivePointsBBox(i,t))}return e},setKey:function(t){this.key=t,this.animator.step(t),this.redraw(),this.fire("change:time",{time:this.getTime(),step:this.key})},setStep:function(t){if(void 0===t||void 0!==t.length)throw new Error("setTime only accept scalars");this.setKey(t)},stepToTime:function(t){if(!this.provider)return 0;var e=this.provider.getKeySpan(),n=e.start+(e.end-e.start)*(t/this.provider.getSteps());return new Date(n)},timeToStep:function(t){if("Date"==typeof t&&(t=t.getTime()),!this.provider)return 0;var e=this.provider.getKeySpan(),n=this.provider.getSteps()*(t-e.start)/(e.end-e.start);return n},getStep:function(){return this.key},getTime:function(){return this.stepToTime(this.key)},setCartoCSS:function(t){var e=(new r.RendererJS).render(t);this.shader=e,this.renderer&&this.renderer.setShader(e);var n=s.common.TorqueLayer.optionsFromLayer(e.findLayer({name:"Map"}));return this.provider&&this.provider.setCartoCSS&&this.provider.setCartoCSS(t),this.provider&&this.provider.setOptions(n)&&this._reloadTiles(),s.extend(this.options,n),n.animationDuration&&this.animator.duration(n.animationDuration),this.redraw(),this},redraw:function(){this.scheduleUpdate()},onRemove:function(){a.prototype.onRemove.call(this),this.animator.stop(),this._removeTileLoader(),google.maps.event.removeListener(this._cacheListener)}}),o.prototype=s.extend({},l.prototype,{providers:{sql_api:s.providers.json,url_template:s.providers.JsonArray},renderers:{point:s.renderer.Point,pixel:s.renderer.Rectangle},initialize:function(t){this.key=0,this.options.renderer=this.options.renderer||"pixel",this.options.provider=this.options.provider||"sql_api",this.provider=new this.providers[this.options.provider](t),this.renderer=new this.renderers[this.options.renderer](null,t)},_tileLoaded:function(t,e){t.data=e,this.drawTile(t)},_loadTile:function(t,e,n){var i=this,o=1<<n,r={x:(e.x%o+o)%o,y:e.y};this.provider.getTileData(r,n,function(e){i._tileLoaded(t,e)})},drawTile:function(t){var e=t.canvas;if(t.data){e.width=e.width,this.renderer.setCanvas(e);var n=this.renderer.accumulate(t.data,this.key);this.renderer.renderTileAccum(n,0,0)}},setKey:function(t){this.key=t,this.redraw()},setCartoCSS:function(t){if(!this.renderer)throw new Error("renderer is not valid");return this.renderer.setCartoCSS(t)}}),e.exports={GMapsTiledTorqueLayer:o,GMapsTorqueLayer:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../":35,"./CanvasLayer":30,"./canvas_tile_layer":31,"./gmaps_tileloader_mixin":32,carto:54}],35:[function(t,e,n){e.exports=t("./core"),e.exports.Animator=t("./animator"),e.exports.cartocss_reference=t("./cartocss_reference"),e.exports.common=t("./common"),e.exports.math=t("./math"),e.exports.Mercator=t("./mercator"),e.exports.net=t("./request"),e.exports.renderer=t("./renderer"),e.exports.providers=t("./provider"),t("./leaflet");var i=t("./gmaps");e.exports.GMapsTileLoader=i.GMapsTileLoader,e.exports.GMapsTorqueLayer=i.GMapsTorqueLayer,e.exports.GMapsTiledTorqueLayer=i.GMapsTiledTorqueLayer},{"./animator":26,"./cartocss_reference":27,"./common":28,"./core":29,"./gmaps":33,"./leaflet":37,"./math":40,"./mercator":41,"./provider":43,"./renderer":48,"./request":52}],36:[function(t,e,n){t("./leaflet_tileloader_mixin"),L.CanvasLayer=L.Class.extend({includes:[L.Mixin.Events,L.Mixin.TileLoader],options:{minZoom:0,maxZoom:28,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:L.Browser.mobile,updateWhenIdle:L.Browser.mobile,tileLoader:!1,zoomAnimation:!0},initialize:function(t){t=t||{},this.render=this.render.bind(this),L.Util.setOptions(this,t),this._canvas=this._createCanvas(),this.options.zoomAnimation&&(this._backCanvas=this._createCanvas()),this._ctx=this._canvas.getContext("2d"),this.currentAnimationFrame=-1,this.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},this.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(t){clearTimeout(t)}},_createCanvas:function(){var t;t=document.createElement("canvas"),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.pointerEvents="none",t.style.zIndex=this.options.zIndex||0;var e="leaflet-tile-container";return this.options.zoomAnimation&&(e+=" leaflet-zoom-animated"),t.setAttribute("class",e),t},onAdd:function(t){this._map=t;var e=this._map._panes.tilePane,n=L.DomUtil.create("div","leaflet-layer");n.appendChild(this._canvas),this.options.zoomAnimation&&(n.appendChild(this._backCanvas),this._backCanvas.style.display="none"),e.appendChild(n),this._container=n,t.dragging._draggable.on("predrag",function(){var e=t.dragging._draggable;L.DomUtil.setPosition(this._canvas,{x:-e._newPos.x,y:-e._newPos.y})},this),t.on({viewreset:this._reset},this),t.on("move",this.render,this),t.on("resize",this._reset,this),this.options.zoomAnimation&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim,moveend:this._reset},this),this.options.tileLoader&&this._initTileLoader(),this._reset()},_animateZoom:function(t){this._animating||(this._animating=!0);var e=this._backCanvas;e.width=this._canvas.width,e.height=this._canvas.height;var n=this._canvas._leaflet_pos||{x:0,y:0};e.getContext("2d").drawImage(this._canvas,0,0),L.DomUtil.setPosition(e,L.DomUtil.getPosition(this._canvas)),this._canvas.style.display="none",e.style.display="block";var i=this._map,o=(i.getZoomScale(t.zoom),i._latLngToNewLayerPoint(i.getCenter(),t.zoom,t.center)),r=i._latLngToNewLayerPoint(t.center,t.zoom,t.center),s={x:o.x-r.x+n.x,y:o.y-r.y+n.y},a=e,l=L.DomUtil.TRANSFORM;setTimeout(function(){a.style[l]=L.DomUtil.getTranslateString(s)+" scale("+t.scale+") "},0)},_endZoomAnim:function(){this._animating=!1,this._canvas.style.display="block",this._backCanvas.style.display="none",this._backCanvas.style[L.DomUtil.TRANSFORM]=""},getCanvas:function(){return this._canvas},getAttribution:function(){return this.options.attribution},draw:function(){return this._reset()},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,move:this._render,moveend:this._reset,resize:this._reset,zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){this._canvas.style.zIndex=t,this.options.zoomAnimation&&(this._backCanvas.style.zIndex=t)},bringToFront:function(){return this},bringToBack:function(){return this},_reset:function(){var t=this._map.getSize();this._canvas.width=t.x,this._canvas.height=t.y;var e=L.DomUtil.getPosition(this._map.getPanes().mapPane);e&&L.DomUtil.setPosition(this._canvas,{x:-e.x,y:-e.y}),this.onResize(),this._render()},_updateOpacity:function(){},_render:function(){this.currentAnimationFrame>=0&&this.cancelAnimationFrame.call(window,this.currentAnimationFrame),this.currentAnimationFrame=this.requestAnimationFrame.call(window,this.render)},redraw:function(t){t?this.render():this._render()},onResize:function(){},render:function(){throw new Error("render function should be implemented")}})},{"./leaflet_tileloader_mixin":38}],37:[function(t,e,n){"undefined"!=typeof L&&t("./torque")},{"./torque":39}],38:[function(t,e,n){L.Mixin.TileLoader={_initTileLoader:function(){this._tiles={},this._tilesLoading={},this._tilesToLoad=0,this._map.on({moveend:this._updateTiles},this),this._updateTiles()},_removeTileLoader:function(){this._map.off({moveend:this._updateTiles},this),this._removeTiles()},_updateTiles:function(){if(this._map){var t=this._map.getPixelBounds(),e=this._map.getZoom(),n=this.options.tileSize;if(!(e>this.options.maxZoom||e<this.options.minZoom)){var i=new L.Point(Math.floor(t.min.x/n),Math.floor(t.min.y/n)),o=new L.Point(Math.floor(t.max.x/n),Math.floor(t.max.y/n)),r=new L.Bounds(i,o);this._addTilesFromCenterOut(r),this._removeOtherTiles(r)}}},_removeTiles:function(t){for(var e in this._tiles)this._removeTile(e)},_reloadTiles:function(){this._removeTiles(),this._updateTiles()},_removeOtherTiles:function(t){var e,n,i,o,r,s=this._map.getZoom();for(r in this._tiles)this._tiles.hasOwnProperty(r)&&(e=r.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),o=parseInt(e[2],10),(s!==o||n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(r))},_removeTile:function(t){this.fire("tileRemoved",this._tiles[t]),delete this._tiles[t],delete this._tilesLoading[t]},_tileKey:function(t){return t.x+":"+t.y+":"+t.zoom},_tileShouldBeLoaded:function(t){var e=this._tileKey(t);return!(e in this._tiles||e in this._tilesLoading)},_tileLoaded:function(t,e){this._tilesToLoad--;var n=t.x+":"+t.y+":"+t.zoom;this._tiles[n]=e,delete this._tilesLoading[n],0===this._tilesToLoad&&this.fire("tilesLoaded")},getTilePos:function(t){t=new L.Point(t.x,t.y);var e=this._map._getNewTopLeftPoint(this._map.getCenter()),n=this.options.tileSize;return t.multiplyBy(n).subtract(e)},_addTilesFromCenterOut:function(t){var e,n,i,o=[],r=t.getCenter(),s=this._map.getZoom();for(e=t.min.y;e<=t.max.y;e++)for(n=t.min.x;n<=t.max.x;n++)i=new L.Point(n,e),i.zoom=s,this._tileShouldBeLoaded(i)&&o.push(i);var a=o.length;if(0!==a){for(o.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)}),this._tilesToLoad+=a,n=0;a>n;n++){var l=o[n],u=this._tileKey(l);this._tilesLoading[u]=l,this.fire("tileAdded",l)}this.fire("tilesLoading")}}}},{}],39:[function(t,e,n){(function(e){var n=e.carto||t("carto"),i=t("../");t("./canvas_layer"),L.TorqueLayer=L.CanvasLayer.extend({providers:{sql_api:i.providers.json,url_template:i.providers.jsonarray,windshaft:i.providers.windshaft},renderers:{point:i.renderer.Point,pixel:i.renderer.Rectangle},initialize:function(t){var e=this;if(!i.isBrowserSupported())throw new Error("browser is not supported by torque");t.tileLoader=!0,this.key=0,this.prevRenderedKey=0,t.cartocss&&i.extend(t,i.common.TorqueLayer.optionsFromCartoCSS(t.cartocss)),t.resolution=t.resolution||2,t.steps=t.steps||100,t.visible=void 0===t.visible?!0:t.visible,this.hidden=!t.visible,this.animator=new i.Animator(function(t){var n=0|t;e.key!==n&&e.setKey(n,{direct:!0})},i.extend(i.clone(t),{onPause:function(){e.fire("pause")},onStop:function(){e.fire("stop")},onStart:function(){e.fire("play")}})),this.play=this.animator.start.bind(this.animator),this.stop=this.animator.stop.bind(this.animator),this.pause=this.animator.pause.bind(this.animator),this.toggle=this.animator.toggle.bind(this.animator),this.setDuration=this.animator.duration.bind(this.animator),this.isRunning=this.animator.isRunning.bind(this.animator),L.CanvasLayer.prototype.initialize.call(this,t),this.options.renderer=this.options.renderer||"point",this.options.provider=this.options.provider||"windshaft",t.ready=function(){e.fire("change:bounds",{bounds:e.provider.getBounds()}),e.animator.steps(e.provider.getSteps()),e.animator.rescale(),e.fire("change:steps",{steps:e.provider.getSteps()}),e.setKey(e.key)},this.provider=new this.providers[this.options.provider](t),this.renderer=new this.renderers[this.options.renderer](this.getCanvas(),t),this.renderer.on("allIconsLoaded",this.render.bind(this)),this.on("tileAdded",function(t){this.provider.getTileData(t,t.zoom,function(n){t.zoom===e._map.getZoom()&&(e._tileLoaded(t,n),e._clearTileCaches(),n&&e.redraw())})},this)},_clearTileCaches:function(){var t,e;for(t in this._tiles)e=this._tiles[t],e&&e._tileCache&&(e._tileCache=null)},_clearCaches:function(){this.renderer&&this.renderer.clearSpriteCache(),this._clearTileCaches()},onAdd:function(t){t.on({zoomend:this._clearCaches,zoomstart:this._pauseOnZoom},this),t.on({zoomend:this._resumeOnZoom},this),L.CanvasLayer.prototype.onAdd.call(this,t)},onRemove:function(t){this._removeTileLoader(),t.off({zoomend:this._clearCaches,zoomstart:this._pauseOnZoom},this),t.off({zoomend:this._resumeOnZoom},this),L.CanvasLayer.prototype.onRemove.call(this,t)},_pauseOnZoom:function(){this.wasRunning=this.isRunning(),this.wasRunning&&this.pause()},_resumeOnZoom:function(){this.wasRunning&&this.play()},hide:function(){return this.hidden?this:(this.pause(),this.clear(),this.hidden=!0,this)},show:function(){return this.hidden?(this.hidden=!1,this.play(),this):this},setSQL:function(t){if(!this.provider||!this.provider.setSQL)throw new Error("this provider does not support SQL");return this.provider.setSQL(t),this._reloadTiles(),this},setBlendMode:function(t){this.renderer.setBlendMode(t),this.redraw()},setSteps:function(t){this.provider.setSteps(t),this._reloadTiles()},setColumn:function(t,e){this.provider.setColumn(t,e),this._reloadTiles()},getTimeBounds:function(){return this.provider&&this.provider.getKeySpan()},clear:function(){var t=this.getCanvas();t.width=t.width},render:function(){if(!this.hidden){var t,e,n,i=this.getCanvas();this.renderer.clearCanvas();var o=i.getContext("2d");for(t in this._tiles)e=this._tiles[t],e&&(this.animator.isRunning()&&(e._tileCache=null),n=this.getTilePos(e.coord),o.setTransform(1,0,0,1,n.x,n.y),e._tileCache?this.renderer._ctx.drawImage(e._tileCache,0,0):this.renderer.renderTile(e,this.key));if(this.renderer.applyFilters(),!this.animator.isRunning()&&this.key===this.prevRenderedKey){var r=this.renderer.TILE_SIZE;for(t in this._tiles)if(e=this._tiles[t],e&&!e._tileCache){var s=e._tileCache=document.createElement("canvas");s.width=s.height=r,n=this.getTilePos(e.coord);var a=Math.max(0,n.x),l=Math.max(0,n.y),u=Math.min(r,this.getCanvas().width-a),c=Math.min(r,this.getCanvas().height-l);u>0&&c>0&&s.getContext("2d").drawImage(this.getCanvas(),a,l,u,c,a-n.x,l-n.y,u,c)}}this.prevRenderedKey=this.key}},setKey:function(t,e){this.key=t,this.animator.step(t),this._clearTileCaches(),this.redraw(e&&e.direct),this.fire("change:time",{time:this.getTime(),step:this.key})},setStep:function(t){if(void 0===t||void 0!==t.length)throw new Error("setTime only accept scalars");this.setKey(t)},stepToTime:function(t){var e=this.provider.getKeySpan(),n=e.start+(e.end-e.start)*(t/this.provider.getSteps());return new Date(n)},timeToStep:function(t){if("Date"==typeof t&&(t=t.getTime()),!this.provider)return 0;var e=this.provider.getKeySpan(),n=this.provider.getSteps()*(t-e.start)/(e.end-e.start);return n},getStep:function(){
return this.key},getTime:function(){return this.stepToTime(this.key)},getTimeSpan:function(){return this.provider.getKeySpan()},setCartoCSS:function(t){if(!this.renderer)throw new Error("renderer is not valid");var e=(new n.RendererJS).render(t);this.renderer.setShader(e);var o=i.common.TorqueLayer.optionsFromLayer(e.findLayer({name:"Map"}));return this.provider.setCartoCSS&&this.provider.setCartoCSS(t),this.provider.setOptions(o)&&this._reloadTiles(),i.extend(this.options,o),o.animationDuration&&this.animator.duration(o.animationDuration),this._clearCaches(),this.redraw(),this},getActivePointsBBox:function(t){var e=[];for(var n in this._tiles){var i=this._tiles[n];e=e.concat(this.renderer.getActivePointsBBox(i,t))}return e},getValueForPos:function(t,e,n){n=void 0===n?this.key:n;var i,o,r,s,a,l=null;for(i in this._tiles)if(o=this._tiles[i],r=this.getTilePos(o.coord),s=t-r.x,a=e-r.y,s>=0&&a>=0&&s<this.renderer.TILE_SIZE&&a<=this.renderer.TILE_SIZE&&(l=this.renderer.getValueFor(o,n,s,a)),null!==l)return l;return null},invalidate:function(){this.provider.reload()}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../":35,"./canvas_layer":36,carto:54}],40:[function(t,e,n){function i(t,e){return function(n){return Math.max(Math.min(n,e),t)}}function o(t,e){var n=i(0,1);return function(i){return n((i-t)/(e-t))}}function r(t,e){function n(n){return r(t*(1-n)+n*e)}var r=i(t,e);return n.invert=function(){return o(t,e)},n}e.exports={clamp:i,linear:r,invLinear:o}},{}],41:[function(t,e,n){function i(t,e,n){return null!==e&&(t=Math.max(t,e)),null!==n&&(t=Math.min(t,n)),t}function o(t){return t*(Math.PI/180)}function r(t){return t/(Math.PI/180)}var s=function(t,e){this.x=t||0,this.y=e||0},a=function(){this._tileSize=256,this._pixelOrigin=new s(this._tileSize/2,this._tileSize/2),this._pixelsPerLonDegree=this._tileSize/360,this._pixelsPerLonRadian=this._tileSize/(2*Math.PI)};a.prototype._fromLatLonToPoint=function(t,e){var n=new s(0,0),r=this._pixelOrigin;n.x=r.x+e*this._pixelsPerLonDegree;var a=i(Math.sin(o(t)),-.9999,.9999);return n.y=r.y+.5*Math.log((1+a)/(1-a))*-this._pixelsPerLonRadian,n},a.prototype._fromPointToLatLon=function(t){var e=this,n=e._pixelOrigin,i=(t.x-n.x)/e._pixelsPerLonDegree,o=(t.y-n.y)/-e._pixelsPerLonRadian,s=r(2*Math.atan(Math.exp(o))-Math.PI/2);return{lat:s,lon:i}},a.prototype._tilePixelPos=function(t,e){return{x:t*this._tileSize,y:e*this._tileSize}},a.prototype.tilePixelBBox=function(t,e,n,i,o,r){r=r||1;var a=1<<n,l=r/a;return i=(t*this._tileSize+i)/a,o=(e*this._tileSize+o)/a,[this._fromPointToLatLon(new s(i,o+l)),this._fromPointToLatLon(new s(i+l,o))]},a.prototype.tileBBox=function(t,e,n,i){var o=1<<n;i=i||0;var r=(this._tileSize+2*i)/o,a=(t*this._tileSize-i)/o,l=(e*this._tileSize-i)/o;return[this._fromPointToLatLon(new s(a,l+r)),this._fromPointToLatLon(new s(a+r,l))]},a.prototype.latLonToTilePoint=function(t,e,n,i,o){var r=1<<o,a=this._fromLatLonToPoint(t,e),l=new s(a.x*r,a.y*r),u=this._tilePixelPos(n,i);return new s(Math.round(l.x-u.x),Math.round(l.y-u.y))},e.exports=a},{}],42:[function(t,e,n){function i(){}function o(t){this.t0=null,this.name=t,this.count=0}var r=1024;i.metrics={},i.get=function(t){return i.metrics[t]||{max:0,min:Number.MAX_VALUE,avg:0,total:0,count:0,history:"undefined"!=typeof Float32Array?new Float32Array(r):[]}},i.new_value=function(t,e){var n=i.metrics[t]=i.get(t);n.max=Math.max(n.max,e),n.min=Math.min(n.min,e),n.total+=e,++n.count,n.avg=n.total/n.count,n.history[n.count%r]=e},i.print_stats=function(){for(k in i.metrics){var t=i.metrics[k];console.log(" === "+k+" === "),console.log(" max: "+t.max),console.log(" min: "+t.min),console.log(" avg: "+t.avg),console.log(" count: "+t.count),console.log(" total: "+t.total)}},o.prototype={start:function(){return this.t0=+new Date,this},_elapsed:function(){return+new Date-this.t0},end:function(){null!==this.t0&&(i.new_value(this.name,this._elapsed()),this.t0=null)},inc:function(t){t=void 0===t?1:t,i.new_value(this.name,i.get(this.name).count+(t?t:0))},dec:function(t){t=void 0===t?1:t,this.inc(-t)},mark:function(){if(++this.count,null===this.t0)return void this.start();var t=this._elapsed();t>1&&(i.new_value(this.name,this.count),this.count=0,this.start())}},i.metric=function(t){return new o(t)},e.exports=i},{}],43:[function(t,e,n){e.exports={json:t("./json"),JsonArray:t("./jsonarray"),windshaft:t("./windshaft")}},{"./json":44,"./jsonarray":45,"./windshaft":46}],44:[function(t,e,n){function i(t){for(var e=1;e<arguments.length;++e){var n=arguments[e];for(var i in n)t=t.replace(RegExp("\\{"+i+"\\}","g"),n[i])}return t}var o=t("../"),r=t("../profiler"),s=o.types.Uint8Array,a=o.types.Int32Array,l=o.types.Uint32Array,u=function(t){if(this._ready=!1,this._tileQueue=[],this.options=t,this.options.is_time=void 0===this.options.is_time?!0:this.options.is_time,this.options.tiler_protocol=t.tiler_protocol||"http",this.options.tiler_domain=t.tiler_domain||"cartodb.com",this.options.tiler_port=t.tiler_port||80,this.options.data_aggregation&&(this.options.cumulative="cumulative"===this.options.data_aggregation),void 0===t.resolution)throw new Error("resolution should be provided");if(void 0===t.steps)throw new Error("steps should be provided");void 0===t.start?this._fetchKeySpan():this._setReady(!0)};u.prototype={proccessTile:function(t,e,n){var i,o=new s(t.length),u=new s(t.length),c=r.metric("ProviderJSON:mem"),h=r.metric("ProviderJSON:point_count"),d=r.metric("ProviderJSON:process_time").start(),f=0,p=-1;for(i=0;i<t.length;++i){var m=t[i];f+=m.dates__uint16.length;for(var g=0;g<m.dates__uint16.length;++g)p=Math.max(p,m.dates__uint16[g])}this.options.cumulative&&(f=(1+p)*t.length);var v=this.options.cumulative?l:s,y=new a(p+1),_=new a(p+1),b=new(this.options.valueDataType||v)(f),w=new l(f);c.inc(4*p+4*p+f+4*f),h.inc(t.length);for(var x={},i=0;i<t.length;++i){var m=t[i];o[i]=m.x__uint8*this.options.resolution,u[i]=-1===m.y__uint8?0:m.y__uint8*this.options.resolution;var f=m.dates__uint16,L=m.vals__uint8;if(this.options.cumulative){for(var T={},S=0,k=f.length;k>S;++S)T[f[S]]=L[S];for(var P=0,S=f[0];p>=S;++S){var C=x[S]||(x[S]=[]),E=T[S];E&&(P+=E),C.push([i,P])}}else for(var S=0,k=f.length;k>S;++S){var C=x[f[S]]||(x[f[S]]=[]);this.options.cumulative&&(L[S]+=prev_val),prev_val=L[S],C.push([i,L[S]])}}for(var D=0,M=0,A=0,A=0;p>=A;++A){var z=0,I=x[A];if(I)for(var i=0;i<I.length;++i){var C=I[i];++z,w[D]=C[0],b[D]=C[1],++D}y[A]=M,_[A]=z,M+=z}return d.end(),{x:o,y:u,z:n,coord:{x:e.x,y:e.y,z:n},timeCount:_,timeIndex:y,renderDataPos:w,renderData:b,maxDate:p}},_host:function(){var t=this.options,e=t.sql_api_port,n=(t.user_name||t.user)+"."+(t.sql_api_domain||"cartodb.com")+(e?":"+e:""),i=t.sql_api_protocol||"http";return this.options.url||i+"://"+n+"/api/v2/sql"},url:function(t){var e=this.options,n=e.sql_api_protocol||"http";if(!this.options.cdn_url)return this._host();var i=n+"://";t&&(i+=t+".");var o=e.cdn_url;if(!o.http&&!o.https)throw new Error("cdn_host should contain http and/or https entries");return i+=o[n]+"/"+(e.user_name||e.user)+"/api/v2/sql"},_hash:function(t){var e=0;if(!t||0==t.length)return e;for(var n=0,i=t.length;i>n;++n)e=(e<<5)-e+t.charCodeAt(n)|0;return e},_extraParams:function(){if(this.options.extra_params){var t=[];for(var e in this.options.extra_params){var n=this.options.extra_params[e];n&&t.push(e+"="+encodeURIComponent(n))}return t.join("&")}return null},isHttps:function(){return this.options.sql_api_protocol&&"https"===this.options.sql_api_protocol},sql:function(t,e,n){n=n||{};var i=this.options.subdomains||"0123";this.isHttps()&&(i=[null]);var r;r=n.no_cdn?this._host():this.url(i[Math.abs(this._hash(t))%i.length]);var s=this._extraParams();o.net.get(r+"?q="+encodeURIComponent(t)+(s?"&"+s:""),function(t){n.parseJSON&&(t=JSON.parse(t&&t.responseText)),e&&e(t)})},getTileData:function(t,e,n){this._ready?this._getTileData(t,e,n):this._tileQueue.push([t,e,n])},_setReady:function(t){this._ready=!0,this._processQueue(),this.options.ready&&this.options.ready()},_processQueue:function(){for(var t;t=this._tileQueue.pop();)this._getTileData.apply(this,t)},_getTileData:function(t,e,n){var o=r.metric("ProviderJSON:tile_fetch_time").start();this.table=this.options.table;var s=this.options.column;this.options.is_time&&(s=i("date_part('epoch', {column})",this.options));var a="WITH par AS (  SELECT CDB_XYZ_Resolution({zoom})*{resolution} as res,  256/{resolution} as tile_size, CDB_XYZ_Extent({x}, {y}, {zoom}) as ext ),cte AS (   SELECT ST_SnapToGrid(i.the_geom_webmercator, p.res) g, {countby} c, floor(({column_conv} - {start})/{step}) d  FROM ({_sql}) i, par p   WHERE i.the_geom_webmercator && p.ext   GROUP BY g, d) SELECT (st_x(g)-st_xmin(p.ext))/p.res x__uint8,        (st_y(g)-st_ymin(p.ext))/p.res y__uint8, array_agg(c) vals__uint8, array_agg(d) dates__uint16 FROM cte, par p where (st_y(g)-st_ymin(p.ext))/p.res < tile_size and (st_x(g)-st_xmin(p.ext))/p.res < tile_size GROUP BY x__uint8, y__uint8",l=i(a,this.options,{zoom:e,x:t.x,y:t.y,column_conv:s,_sql:this.getSQL()}),u=this;this.sql(l,function(i){if(i){var r=JSON.parse(i.responseText).rows;n(u.proccessTile(r,t,e))}else n(null);o.end()})},getKeySpan:function(){return{start:1e3*this.options.start,end:1e3*this.options.end,step:this.options.step,steps:this.options.steps,columnType:this.options.is_time?"date":"number"}},setColumn:function(t,e){this.options.column=t,this.options.is_time=void 0===e?!0:!1,this.reload()},setResolution:function(t){this.options.resolution=t},setOptions:function(t){var e=!1;if(void 0!==t.resolution&&t.resolution!==this.options.resolution&&(this.options.resolution=t.resolution,e=!0),void 0!==t.steps&&t.steps!==this.options.steps&&(this.setSteps(t.steps,{silent:!0}),e=!0),void 0!==t.column&&t.column!==this.options.column&&(this.options.column=t.column,e=!0),void 0!==t.countby&&t.countby!==this.options.countby&&(this.options.countby=t.countby,e=!0),void 0!==t.data_aggregation){var n="cumulative"===t.data_aggregation;this.options.cumulative!==n&&(this.options.cumulative=n,e=!0)}return e&&this.reload(),e},reload:function(){this._ready=!1,this._fetchKeySpan()},setSQL:function(t){this.options.sql!=t&&(this.options.sql=t,this.reload())},getSteps:function(){return Math.min(this.options.steps,this.options.data_steps)},setSteps:function(t,e){e=e||{},this.options.steps!==t&&(this.options.steps=t,this.options.step=(this.options.end-this.options.start)/this.getSteps(),this.options.step=this.options.step||1,e.silent||this.reload())},getBounds:function(){return this.options.bounds},getSQL:function(){return this.options.sql||"select * from "+this.options.table},_tilerHost:function(){var t=this.options,e=t.user_name||t.user;return t.tiler_protocol+"://"+(e?e+".":"")+t.tiler_domain+(""!=t.tiler_port?":"+t.tiler_port:"")},_fetchUpdateAt:function(t){var e=this,n={version:"1.0.1",stat_tag:this.options.stat_tag||"torque",layers:[{type:"cartodb",options:{cartocss_version:"2.1.1",cartocss:"#layer {}",sql:this.getSQL()}}]},r=this._tilerHost()+"/tiles/layergroup",s=this._extraParams();s&&(s=s.replace("api_key=","map_key=")),r=r+"?config="+encodeURIComponent(JSON.stringify(n))+"&callback=?"+(s?"&"+s:""),o.net.jsonp(r,function(n){var o=i("select * from ({sql}) __torque_wrap_sql limit 0",{sql:e.getSQL()});e.sql(o,function(e){n&&t({updated_at:n.last_updated,fields:e.fields})},{parseJSON:!0})})},_fetchKeySpan:function(){var t,e,n,o,r=this;this._fetchUpdateAt(function(s){if(s){r.options.extra_params=r.options.extra_params||{},r.options.extra_params.last_updated=s.updated_at||0,r.options.extra_params.cache_policy="persist",r.options.is_time="date"===s.fields[r.options.column].type;var a=r.options.column;r.options.is_time?(n="date_part('epoch', max({column}))",o="date_part('epoch', min({column}))",a=i("date_part('epoch', {column})",r.options)):(n="max({column})",o="min({column})"),t=i(n,{column:r.options.column}),e=i(o,{column:r.options.column});var l=" SELECT st_xmax(st_envelope(st_collect(the_geom))) xmax, st_ymax(st_envelope(st_collect(the_geom))) ymax, st_xmin(st_envelope(st_collect(the_geom))) xmin, st_ymin(st_envelope(st_collect(the_geom))) ymin, count(*) as num_steps, {max_col} max_date, {min_col} min_date FROM  ({sql}) __torque_wrap_sql ",u=i(l,{max_col:t,min_col:e,column:a,sql:r.getSQL()});r.sql(u,function(t){t=t.rows[0],r.options.start=t.min_date,r.options.end=t.max_date,r.options.step=(t.max_date-t.min_date)/Math.min(r.options.steps,t.num_steps>>0),r.options.data_steps=t.num_steps>>0,r.options.step=r.options.step||1,r.options.bounds=[[t.ymin,t.xmin],[t.ymax,t.xmax]],r._setReady(!0)},{parseJSON:!0,no_cdn:!0})}},{parseJSON:!0,no_cdn:!0})}},e.exports=u},{"../":35,"../profiler":42}],45:[function(t,e,n){var i=t("../"),o=t("../profiler"),s=i.types.Uint8Array,a=i.types.Int32Array,l=i.types.Uint32Array,u=function(t){this.options=t};u.prototype={aggregateByKey:function(t){function e(t){for(var e=3,n=t.data[2],i={},o=0;n>o;++o)i[t.data[e+o]]=t.data[e+n+o];return i}var n={};for(r=0;r<t.length;++r){var i=e(t[r]);for(var o in i)n[o]=n[o]||0,n[o]+=i[o]}return n},proccessTile:function(t,e,n){function i(t){for(var e=3,n={x:t.data[0]*c.options.resolution,y:t.data[1]*c.options.resolution,valuesCount:t.data[2],times:[],values:[]},i=0;i<n.valuesCount;++i)n.times.push(t.data[e+i]),n.values.push(t.data[e+n.valuesCount+i]);if(c.options.cumulative)for(var i=1;i<n.valuesCount;++i)n.values[i]+=n.values[i-1];return n}var o,r=new s(t.length),u=new s(t.length),c=this;for(o=0;o<t.length;++o)t[o]=i(t[o]);var h=0,d=0;for(o=0;o<t.length;++o){var f=t[o];h+=f.times.length;for(var p=0;p<f.times.length;++p)d=Math.max(d,f.times[p])}for(var m=new a(d+1),g=new a(d+1),v=new(this.options.valueDataType||s)(h),y=new l(h),_={},o=0;o<t.length;++o){var f=t[o];r[o]=f.x,u[o]=f.y;for(var h=f.times,b=f.values,w=0,x=h.length;x>w;++w){var L=_[h[w]]||(_[h[w]]=[]);L.push([o,b[w]])}}for(var T=0,S=0,k=0,k=0;d>=k;++k){var P=0,C=_[k];if(C)for(var o=0;o<C.length;++o){var L=C[o];++P,y[T]=L[0],v[T]=L[1],++T}m[k]=S,g[k]=P,S+=P}return{x:r,y:u,coord:{x:e.x,y:e.y,z:n},timeCount:g,timeIndex:m,renderDataPos:y,renderData:v}},url:function(){return this.options.url},tileUrl:function(t,e){var n=this.url(),i=(this.options.subdomains||"abcd")[(t.x+t.y+e)%4];return n.replace("{x}",t.x).replace("{y}",t.y).replace("{z}",e).replace("{s}",i)},getTile:function(t,e,n){var r=this.tileUrl(t,e),s=o.metric("jsonarray:fetch time");s.start(),i.net.get(r,function(t){s.end(),t&&(t=JSON.parse(t.responseText)),n(t)})},getTileData:function(t,e,n){var r=this.tileUrl(t,e),s=this,a=o.metric("jsonarray:fetch time");a.start(),i.net.get(r,function(i){a.end();var r=null,l=o.metric("jsonarray:processing time"),u=o.metric("jsonarray:parsing time");try{l.start(),u.start();var c=JSON.parse(i.responseText||i.response).rows;u.end(),r=s.proccessTile(c,t,e),l.end()}catch(h){console.error("problem parsing JSON on ",t,e)}n(r)})}},e.exports=u},{"../":35,"../profiler":42}],46:[function(t,e,n){var i=t("../"),o=t("../profiler"),r=i.types.Uint8Array,s=i.types.Int32Array,a=i.types.Uint32Array,l=function(t){if(this._ready=!1,this._tileQueue=[],this.options=t,this.options.is_time=void 0===this.options.is_time?!0:this.options.is_time,this.options.tiler_protocol=t.tiler_protocol||"http",this.options.tiler_domain=t.tiler_domain||"cartodb.com",this.options.tiler_port=t.tiler_port||80,this.options.coordinates_data_type=this.options.coordinates_data_type||r,this.options.data_aggregation&&(this.options.cumulative="cumulative"===this.options.data_aggregation),this.options.auth_token){var e=this.options.extra_params||(this.options.extra_params={});e.auth_token=this.options.auth_token}this.options.no_fetch_map||this._fetchMap()};l.prototype={proccessTile:function(t,e,n){var i,l=new this.options.coordinates_data_type(t.length),u=new this.options.coordinates_data_type(t.length),c=o.metric("torque.provider.windshaft.mem"),h=o.metric("torque.provider.windshaft.points"),d=o.metric("torque.provider.windshaft.process_time").start(),f=0,p=-1;for(i=0;i<t.length;++i){var m=t[i];f+=m.dates__uint16.length;for(var g=0;g<m.dates__uint16.length;++g)p=Math.max(p,m.dates__uint16[g])}this.options.cumulative&&(f=(1+p)*t.length);var v=this.options.cumulative?a:r,y=new s(p+1),_=new s(p+1),b=new(this.options.valueDataType||v)(f),w=new a(f);c.inc(4*p+4*p+f+4*f),h.inc(t.length);for(var x={},i=0;i<t.length;++i){var m=t[i];l[i]=m.x__uint8*this.options.resolution,u[i]=m.y__uint8*this.options.resolution;var f=m.dates__uint16,L=m.vals__uint8;if(this.options.cumulative){for(var T={},S=0,k=f.length;k>S;++S)T[f[S]]=L[S];for(var P=0,S=f[0];p>=S;++S){var C=x[S]||(x[S]=[]),E=T[S];E&&(P+=E),C.push([i,P])}}else for(var S=0,k=f.length;k>S;++S){var C=x[f[S]]||(x[f[S]]=[]);this.options.cumulative&&(L[S]+=prev_val),prev_val=L[S],C.push([i,L[S]])}}for(var D=0,M=0,A=0,A=0;p>=A;++A){var z=0,I=x[A];if(I)for(var i=0;i<I.length;++i){var C=I[i];++z,w[D]=C[0],b[D]=C[1],++D}y[A]=M,_[A]=z,M+=z}return d.end(),{x:l,y:u,z:n,coord:{x:e.x,y:e.y,z:n},timeCount:_,timeIndex:y,renderDataPos:w,renderData:b,maxDate:p}},setSteps:function(t,e){e=e||{},this.options.steps!==t&&(this.options.steps=t,this.options.step=(this.options.end-this.options.start)/this.getSteps(),this.options.step=this.options.step||1,e.silent||this.reload())},setOptions:function(t){var e=!1;if(void 0!==t.resolution&&t.resolution!==this.options.resolution&&(this.options.resolution=t.resolution,e=!0),void 0!==t.steps&&t.steps!==this.options.steps&&(this.setSteps(t.steps,{silent:!0}),e=!0),void 0!==t.column&&t.column!==this.options.column&&(this.options.column=t.column,e=!0),void 0!==t.countby&&t.countby!==this.options.countby&&(this.options.countby=t.countby,e=!0),void 0!==t.data_aggregation){var n="cumulative"===t.data_aggregation;this.options.cumulative!==n&&(this.options.cumulative=n,e=!0)}return e&&this.reload(),e},_extraParams:function(t){if(t=i.extend(i.extend({},t),this.options.extra_params)){var e=[];for(var n in t){var o=t[n];if(o)if(i.isArray(o))for(var r=0,s=o.length;s>r;r++)e.push(n+"[]="+encodeURIComponent(o[r]));else e.push(n+"="+encodeURIComponent(o))}return e.join("&")}return null},getTileData:function(t,e,n){this._ready?this._getTileData(t,e,n):this._tileQueue.push([t,e,n])},_setReady:function(t){this._ready=!0,this._processQueue(),this.options.ready&&this.options.ready()},_processQueue:function(){for(var t;t=this._tileQueue.pop();)this._getTileData.apply(this,t)},_getTileData:function(t,e,n){var r=this,s=o.metric("torque.provider.windshaft.tile.fetch").start(),a=this.options.subdomains||"0123",l=Math.pow(2,e),u=(t.x%l+l)%l,c=Math.abs(u+t.y)%a.length,h=this.templateUrl.replace("{x}",u).replace("{y}",t.y).replace("{z}",e).replace("{s}",a[c]),d=this._extraParams();i.net.get(h+(d?"?"+d:""),function(i){if(s.end(),i&&i.responseText){var a=JSON.parse(i.responseText);n(r.proccessTile(a,t,e))}else o.metric("torque.provider.windshaft.tile.error").inc(),n(null)})},getKeySpan:function(){return{start:this.options.start,end:this.options.end,step:this.options.step,steps:this.options.steps,columnType:this.options.column_type}},setColumn:function(t,e){this.options.column=t,this.options.is_time=void 0===e?!0:!1,this.reload()},reload:function(){this._ready=!1,this._fetchMap()},getSteps:function(){return Math.min(this.options.steps,this.options.data_steps)},getBounds:function(){return this.options.bounds},getSQL:function(){return this.options.sql||"select * from "+this.options.table},setSQL:function(t){this.options.sql!=t&&(this.options.sql=t,this.reload())},_tilerHost:function(){var t=this.options,e=t.user_name||t.user;return t.tiler_protocol+"://"+(e?e+".":"")+t.tiler_domain+(""!=t.tiler_port?":"+t.tiler_port:"")},url:function(){var t=this.options,e=t.tiler_protocol||"http";if(!this.options.cdn_url||this.options.no_cdn)return this._tilerHost();var n=e+"://";"http"===e&&(n+="{s}.");var i=t.cdn_url;if(!i.http&&!i.https)throw new Error("cdn_host should contain http and/or https entries");return n+=i[e]+"/"+(t.user_name||t.user)},_generateCartoCSS:function(){var t={"-torque-frame-count":this.options.steps,"-torque-resolution":this.options.resolution,"-torque-aggregation-function":"'"+this.options.countby+"'","-torque-time-attribute":"'"+this.options.column+"'","-torque-data-aggregation":this.options.cumulative?"cumulative":"linear"},e="Map{";for(var n in t)e+=n+":"+t[n]+";";return e+"}"},_fetchMap:function(t){var e=this,n={},r=this.options.dynamic_cdn?this.url().replace("{s}","0"):this._tilerHost(),s=r+"/api/v1/map",a=this.options.named_map,l={};a?(s=r+"/api/v1/map/named/"+a.name+"/jsonp","undefined"!=typeof a.params&&(n=a.params)):n={version:"1.0.1",stat_tag:this.options.stat_tag||"torque",layers:[{type:"torque",options:{cartocss_version:"1.0.0",cartocss:this._generateCartoCSS(),sql:this.getSQL()}}]},this.options.stat_tag&&(l.stat_tag=this.options.stat_tag),extra=this._extraParams(l),extra&&(extra=extra.replace("api_key=","map_key=")),s=s+"?config="+encodeURIComponent(JSON.stringify(n))+"&callback=?"+(extra?"&"+extra:"");var u=o.metric("torque.provider.windshaft.layergroup.time").start();i.net.jsonp(s,function(t){if(u.end(),t){var n=Object.keys(t.metadata.torque)[0],i=t.metadata.torque[n];for(var r in i)e.options[r]=i[r];if(t.cdn_url){var s=e.options.cdn_url=e.options.cdn_url||{};s.http=t.cdn_url.http||s.http,s.https=t.cdn_url.https||s.https}e.templateUrl=e.url()+"/api/v1/map/"+t.layergroupid+"/"+n+"/{z}/{x}/{y}.json.torque",e._setReady(!0)}else o.metric("torque.provider.windshaft.layergroup.error").inc()},{callbackName:e.options.instanciateCallback})}},e.exports=l},{"../":35,"../profiler":42}],47:[function(t,e,n){function i(t,e){t.fillStyle=e["marker-fill"];var n=e["marker-width"];t.beginPath(),t.arc(0,0,n,0,s,!0,!0),t.closePath(),e["marker-fill"]&&((void 0!==e["marker-fill-opacity"]||void 0!==e["marker-opacity"])&&(t.globalAlpha=e["marker-fill-opacity"]||e["marker-opacity"]),t.fill()),t.globalAlpha=1,e["marker-line-color"]&&e["marker-line-width"]&&e["marker-line-width"]>a&&(void 0!==e["marker-line-opacity"]&&(t.globalAlpha=e["marker-line-opacity"]),void 0!==e["marker-line-width"]&&(t.lineWidth=e["marker-line-width"]),t.strokeStyle=e["marker-line-color"],t.globalAlpha>0&&t.stroke())}function o(t,e){t.fillStyle=e["marker-fill"];var n=e["marker-width"],i=2*n;e["marker-fill"]&&((void 0!==e["marker-fill-opacity"]||void 0!==e["marker-opacity"])&&(t.globalAlpha=e["marker-fill-opacity"]||e["marker-opacity"]),t.fillRect(-n,-n,i,i)),t.globalAlpha=1,e["marker-line-color"]&&e["marker-line-width"]&&(e["marker-line-opacity"]&&(t.globalAlpha=e["marker-line-opacity"]),e["marker-line-width"]&&(t.lineWidth=e["marker-line-width"]),t.strokeStyle=e["marker-line-color"],t.globalAlpha>0&&t.strokeRect(-n,-n,i,i))}function r(t,e,n){e.complete&&((void 0!==n["marker-fill-opacity"]||void 0!==n["marker-opacity"])&&(t.globalAlpha=n["marker-fill-opacity"]||n["marker-opacity"]),t.drawImage(e,0,0,e.width,e.height))}var s=2*Math.PI,a=.05;e.exports={renderPoint:i,renderSprite:r,renderRectangle:o}},{}],48:[function(t,e,n){e.exports={cartocss:t("./cartocss_render"),Point:t("./point"),Rectangle:t("./rectangle")}},{"./cartocss_render":47,"./point":49,"./rectangle":50}],49:[function(t,e,n){(function(n){function i(t){return h[t]||t}function o(t,e){if(!t)throw new Error("canvas can't be undefined");this.options=e,this._canvas=t,this._ctx=t.getContext("2d"),this._sprites=[],this._shader=null,this._icons={},this._iconsToLoad=0,this._filters=new u(this._canvas,{canvasClass:e.canvasClass}),this.setCartoCSS(this.options.cartocss||c),this.TILE_SIZE=256,this._style=null,this._gradients={},this._forcePoints=!1}var r=t("../"),s=t("./cartocss_render"),a=t("../profiler"),l=n.carto||t("carto"),u=t("./torque_filters"),c=(2*Math.PI,["#layer {","  marker-fill: #662506;","  marker-width: 4;","  [value > 1] { marker-fill: #FEE391; }","  [value > 2] { marker-fill: #FEC44F; }","  [value > 3] { marker-fill: #FE9929; }","  [value > 4] { marker-fill: #EC7014; }","  [value > 5] { marker-fill: #CC4C02; }","  [value > 6] { marker-fill: #993404; }","  [value > 7] { marker-fill: #662506; }","}"].join("\n")),h={src:"source-over","src-over":"source-over","dst-over":"destination-over","src-in":"source-in","dst-in":"destination-in","src-out":"source-out","dst-out":"destination-out","src-atop":"source-atop","dst-atop":"destination-atop",xor:"xor",darken:"darken",lighten:"lighten"};r.extend(o.prototype,r.Event,{clearCanvas:function(){var t=this._canvas,e=this._Map["-torque-clear-color"];if("rgba(255, 255, 255, 0)"!==e&&e){var n=this._ctx;n.setTransform(1,0,0,1,0,0);var o=this._Map["comp-op"];n.globalCompositeOperation=i(o),n.fillStyle=e,n.fillRect(0,0,t.width,t.height)}else this._canvas.width=this._canvas.width},setCanvas:function(t){this._canvas=t,this._ctx=t.getContext("2d")},setCartoCSS:function(t){this.setShader((new l.RendererJS).render(t))},setShader:function(t){this._sprites=[],this._shader=t,this._Map=this._shader.getDefault().getStyle({},{zoom:0});var e=this._shader.getImageURLs();this._preloadIcons(e)},clearSpriteCache:function(){this._sprites=[]},generateSprite:function(t,e,n){var i=a.metric("torque.renderer.point.generateSprite").start(),o=t.getStyle({value:e},n);(null===this._style||this._style!==o)&&(this._style=o);var l=o["marker-width"];if(!l)return null;if(0===o["marker-opacity"]&&!o["marker-line-opacity"])return null;var u=this._createCanvas(),c=u.getContext("2d"),h=o["marker-file"]||o["point-file"],d=h&&this._qualifyURL(h);if(d&&this._iconsToLoad<=0&&this._icons[d]){var f=this._icons[d],p=2*o["marker-width"]||f.width,m=(o["marker-height"]||p)*(f.width/f.height);u.width=c.width=p,u.height=c.height=m,c.scale(p/f.width,m/f.height),s.renderSprite(c,f,o)}else{var g=(o["marker-line-width"]||0)+2*l,v=c.width=u.width=c.height=u.height=Math.ceil(g);c.translate(v/2,v/2);var y=o["marker-type"];y&&"rectangle"===y?s.renderRectangle(c,o):s.renderPoint(c,o)}if(i.end(!0),r.flags.sprites_to_images){var _=this._createImage();return _.src=u.toDataURL(),_}return u},renderTile:function(t,e,n){if(this._iconsToLoad>0)return this.on("allIconsLoaded",function(){this.renderTile.apply(this,[t,e,n])}),!1;for(var i=a.metric("torque.renderer.point.renderLayers").start(),o=this._shader.getLayers(),r=0,s=o.length;s>r;++r){var l=o[r];if("Map"!==l.name())for(var u=this._sprites[r]||(this._sprites[r]={}),c=0;c<l.frames().length;++c){var h=l.frames()[c],d=u[h]||(u[h]=[]);this._renderTile(t,e-h,h,d,l)}}return i.end(!0),n&&n(null)},_createCanvas:function(){return this.options.canvasClass?new this.options.canvasClass:document.createElement("canvas")},_createImage:function(){return this.options.imageClass?new this.options.imageClass:new Image},_setImageSrc:function(t,e,n){this.options.setImageSrc?this.options.setImageSrc(t,e,n):(t.onload=function(){n(null)},t.onerror=function(){n(new Error("Could not load image"))},t.src=e)},_qualifyURL:function(t){if("undefined"!=typeof this.options.qualifyURL)return this.options.qualifyURL(t);var e=document.createElement("a");return e.href=t,e.href},_renderTile:function(t,e,n,o,s,l){if(this._canvas){var u=a.metric("torque.renderer.point.renderTile").start(),c=this._ctx,h=i(s.eval("comp-op"))||this.options.blendmode;h&&(c.globalCompositeOperation=h),this.options.cumulative&&e>t.maxDate&&(e=t.maxDate);var d=this.options.resolution*(this.TILE_SIZE/this.options.resolution-1),f=t.timeCount[e],p=this.options.resolution/2;if(f)for(var m=t.timeIndex[e],g=0;f>g;++g){var v=t.renderDataPos[m+g],y=t.renderData[m+g];if(y){var _=o[y];if(void 0===_&&(_=o[y]=this.generateSprite(s,y,r.extend({zoom:t.z,"frame-offset":n},l))),_){var b=t.x[v]-(_.width>>1)+p,w=d-t.y[v]+p;c.drawImage(_,b,w-(_.height>>1))}}}u.end(!0)}},setBlendMode:function(t){this.options.blendmode=t},getActivePointsBBox:function(t,e){for(var n=[],i=new r.Mercator,o=this.options.resolution*(this.TILE_SIZE/this.options.resolution-1),s=t.timeCount[e],a=t.timeIndex[e],l=0;s>l;++l){var u=t.renderDataPos[a+l],c=t.renderData[a+l];if(c){var h=t.x[u],d=o-t.y[u];n.push(i.tilePixelBBox(t.coord.x,t.coord.y,t.coord.z,h,d))}}return n},getValueFor:function(t,e,n,i){for(var o=new r.Mercator,s=this.options.resolution,a=s>>1,l=this.options.resolution*(this.TILE_SIZE/this.options.resolution-1),u=t.timeCount[e],c=t.timeIndex[e],h=0;u>h;++h){var d=t.renderDataPos[c+h],f=t.renderData[c+h];if(f){var p=t.x[d],m=l-t.y[d],g=n+a-p,v=i+a-m;if(g>=0&&s>g&&v>=0&&s>v)return{value:f,bbox:o.tilePixelBBox(t.coord.x,t.coord.y,t.coord.z,p-a,m-a,s)}}}return null},_preloadIcons:function(t){var e=this;if(t.length>0&&!this._forcePoints){var n=Object.keys(t.reduce(function(t,n){var i=e._qualifyURL(n);return e._icons[i]||(t[i]=!0),t},{})),i=e._shader.getLayers().some(function(t){return"undefined"!=typeof t.shader["image-filters"]});this._iconsToLoad+=n.length,n.forEach(function(t){e._icons[t]=null;var n=e._createImage();i&&(n.crossOrigin="Anonymous"),e._setImageSrc(n,t,function(o){o?(e._forcePoints=!0,e.clearSpriteCache(),e._iconsToLoad=0,e.fire("allIconsLoaded"),i&&console.info("Only CORS-enabled, or same domain image-files can be used in combination with image-filters"),console.error("Couldn't get marker-file "+t)):(e._icons[t]=n,e._iconsToLoad--,e._iconsToLoad<=0&&(e.clearSpriteCache(),e.fire("allIconsLoaded")))})})}else this.fire("allIconsLoaded")},applyFilters:function(){function t(t){for(var e="",n=0;n<t.args.length;n++){var i=t.args[n].rgb;e+=i[0]+":"+i[1]+":"+i[2]}return e}function e(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function n(t,n,i){return"#"+e(t)+e(n)+e(i)}if(this._style&&this._style["image-filters"]){var i=this._gradients[t(this._style["image-filters"])];if(!i){i={};for(var o=this._style["image-filters"].args,r=1/o.length,s=0;s<o.length;s++){var a=r*s+r,l=o[s].rgb,u=n(l[0],l[1],l[2]);i[a]=u}this._gradients[t(this._style["image-filters"])]=i}this._filters.gradient(i),this._filters.draw()}}}),e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../":35,"../profiler":42,"./cartocss_render":47,"./torque_filters":51,carto:54}],50:[function(t,e,n){(function(n){function i(t,e){this.options=e,o.tree.Reference.set(torque["torque-reference"]),this.setCanvas(t),this.setCartoCSS(this.options.cartocss||r)}{var o=n.carto||t("carto"),r=["#layer {","  polygon-fill: #FFFF00;","  [value > 10] { polygon-fill: #FFFF00; }","  [value > 100] { polygon-fill: #FFCC00; }","  [value > 1000] { polygon-fill: #FE9929; }","  [value > 10000] { polygon-fill: #FF6600; }","  [value > 100000] { polygon-fill: #FF3300; }","}"].join("\n");2*Math.PI}i.prototype={setCartoCSS:function(t){if(this._cartoCssStyle=(new o.RendererJS).render(t),this._cartoCssStyle.getLayers().length>1)throw new Error("only one CartoCSS layer is supported");this._shader=this._cartoCssStyle.getLayers()[0].shader},setCanvas:function(t){t&&(this._canvas=t,this._ctx=t.getContext("2d"))},accumulate:function(t,e){var n,i,o,r,s,a,l,u,c=Profiler.metric("RectangleRender:accumulate").start(),h=this.options.resolution,d=256/h,f=new Float32Array(d*d);for("object"!=typeof e&&(e=[e]),s=0;s<e.length;++s)if(a=e[s],l=t.timeCount[a])for(u=t.timeIndex[a],r=0;l>r;++r)o=t.renderDataPos[u+r],n=t.x[o]/h,i=t.y[o]/h,f[n*d+i]+=t.renderData[u+r];return c.end(),f},renderTileAccum:function(t,e,n){{var i,o,r,s,a=Profiler.metric("RectangleRender:renderTileAccum").start(),l=this.options.resolution,u=this._ctx,c=256/l|0,h=c*c;this._colors}this.options.blendmode&&(u.globalCompositeOperation=this.options.blendmode);for(var d=this._shader["polygon-opacity"]||function(){return 1},f=0;h>f;++f){var p=f,m=t[f];m&&(o=p/c|0,r=p%c,i=this._shader["polygon-fill"]({value:m},{zoom:0}),u.fillStyle=i,s=d({value:m},{zoom:0}),null===s&&(s=1),u.globalAlpha=s,u.fillRect(o*l,256-l-r*l,l,l))}a.end()},renderTile:function(t,e,n){if(this._canvas){var i=this.options.resolution,o=this._ctx,r=this._colors,s=t.timeCount[e];if(s)for(var a=(this._canvas.width,this._canvas.height,t.timeIndex[e]),l=0;l<activePixels;++l){var u=t.renderDataPos[a+l],c=t.renderData[a+l];if(c){var h=r[Math.min(c,r.length-1)],d=t.x[u],f=t.y[u];

o.fillStyle=h,o.fillRect(d,f,i,i)}}return n&&n(null)}}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{carto:54}],51:[function(t,e,n){"use strict";function i(t,e){return this instanceof i?(e=e||{},this._canvas=t="string"==typeof t?document.getElementById(t):t,this._ctx=t.getContext("2d"),this._width=t.width,this._height=t.height,this._max=1,this._data=[],void(this.canvasClass=e.canvasClass)):new i(t,e)}i.prototype={defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},gradient:function(t){var e=this._createCanvas(),n=e.getContext("2d"),i=n.createLinearGradient(0,0,0,256);e.width=1,e.height=256;for(var o in t)i.addColorStop(+o,t[o]);return n.fillStyle=i,n.fillRect(0,0,1,256),this._grad=n.getImageData(0,0,1,256).data,this},draw:function(){this._grad||this.gradient(this.defaultGradient);var t=this._ctx,e=t.getImageData(0,0,this._canvas.width,this._canvas.height);return this._colorize(e.data,this._grad),t.putImageData(e,0,0),this},_colorize:function(t,e){for(var n,i=3,o=t.length;o>i;i+=4)n=4*t[i],n&&(t[i-3]=e[n],t[i-2]=e[n+1],t[i-1]=e[n+2])},_createCanvas:function(){return this.canvasClass?new this.canvasClass:document.createElement("canvas")}},e.exports=i},{}],52:[function(t,e,n){(function(n){function i(t,e,n){function i(){o.removeChild(r),clearTimeout(l),delete window[a]}n=n||{},n.timeout=void 0===n.timeout?1e4:n.timeout;var o=document.getElementsByTagName("head")[0],r=document.createElement("script"),a=n.callbackName||"torque_"+Date.now();s.isFunction(a)&&(a=a()),window[a]=function(){i(),e.apply(window,arguments)};var l=setTimeout(function(){i(),e.call(window,null)},n.timeout);t=t.replace("callback=?","callback="+a),r.type="text/javascript",r.src=t,r.async=!0,setTimeout(function(){o.appendChild(r)},0)}function o(t,e,i){function o(){var t=s.status,n="arraybuffer"===i.responseType?s.response:s.responseText;e(!t&&n||t>=200&&300>t||304===t?s:null)}i=i||{method:"GET",data:null,responseType:"text"},a={url:t,callback:e};var r=XMLHttpRequest;!n.XDomainRequest||"withCredentials"in r||!/^(http(s)?:)?\/\//.test(t)||(r=XDomainRequest);var s=new r;return s.open(i.method,t,!0),"onload"in s?s.onload=s.onerror=o:s.onreadystatechange=function(){s.readyState>3&&o()},s.onprogress=function(){},s.responseType=i.responseType,i.data&&(s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("Accept","*")),s.send(i.data),s}function r(t,e,n){return o(t,n,{data:e,method:"POST"})}var s=t("./core"),a=null;e.exports={get:o,post:r,jsonp:i,lastCall:function(){return a}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./core":29}],53:[function(t,e,n){!function(t){function e(e){return t.functions.hsla(e.h,e.s,e.l,e.a)}function n(e){return e instanceof t.Dimension?parseFloat("%"==e.unit?e.value/100:e.value):"number"==typeof e?e:0/0}function i(t){return Math.min(1,Math.max(0,t))}t.functions={rgb:function(t,e,n){return this.rgba(t,e,n,1)},rgba:function(e,i,o,r){var s=[e,i,o].map(function(t){return n(t)});return r=n(r),s.some(isNaN)||isNaN(r)?null:new t.Color(s,r)},stop:function(t){var e,n;return arguments.length>1&&(e=arguments[1]),arguments.length>2&&(n=arguments[2]),{is:"tag",val:t,color:e,mode:n,toString:function(i){return'\n	<stop value="'+t.ev(i)+'"'+(e?' color="'+e.ev(i)+'" ':"")+(n?' mode="'+n.ev(i)+'" ':"")+"/>"}}},hsl:function(t,e,n){return this.hsla(t,e,n,1)},hsla:function(t,e,i,o){function r(t){return t=0>t?t+1:t>1?t-1:t,1>6*t?a+(s-a)*t*6:1>2*t?s:2>3*t?a+(s-a)*(2/3-t)*6:a}if(t=n(t)%360/360,e=n(e),i=n(i),o=n(o),[t,e,i,o].some(isNaN))return null;var s=.5>=i?i*(e+1):i+e-i*e,a=2*i-s;return this.rgba(255*r(t+1/3),255*r(t),255*r(t-1/3),o)},hue:function(e){return"toHSL"in e?new t.Dimension(Math.round(e.toHSL().h)):null},saturation:function(e){return"toHSL"in e?new t.Dimension(Math.round(100*e.toHSL().s),"%"):null},lightness:function(e){return"toHSL"in e?new t.Dimension(Math.round(100*e.toHSL().l),"%"):null},alpha:function(e){return"toHSL"in e?new t.Dimension(e.toHSL().a):null},saturate:function(t,n){if(!("toHSL"in t))return null;var o=t.toHSL();return o.s+=n.value/100,o.s=i(o.s),e(o)},desaturate:function(t,n){if(!("toHSL"in t))return null;var o=t.toHSL();return o.s-=n.value/100,o.s=i(o.s),e(o)},lighten:function(t,n){if(!("toHSL"in t))return null;var o=t.toHSL();return o.l+=n.value/100,o.l=i(o.l),e(o)},darken:function(t,n){if(!("toHSL"in t))return null;var o=t.toHSL();return o.l-=n.value/100,o.l=i(o.l),e(o)},fadein:function(t,n){if(!("toHSL"in t))return null;var o=t.toHSL();return o.a+=n.value/100,o.a=i(o.a),e(o)},fadeout:function(t,n){if(!("toHSL"in t))return null;var o=t.toHSL();return o.a-=n.value/100,o.a=i(o.a),e(o)},spin:function(t,n){if(!("toHSL"in t))return null;var i=t.toHSL(),o=(i.h+n.value)%360;return i.h=0>o?360+o:o,e(i)},replace:function(t,e,n){return"field"===t.is?t.toString+".replace("+e.toString()+", "+n.toString()+")":t.replace(e,n)},mix:function(e,n,i){var o=i.value/100,r=2*o-1,s=e.toHSL().a-n.toHSL().a,a=((r*s==-1?r:(r+s)/(1+r*s))+1)/2,l=1-a,u=[e.rgb[0]*a+n.rgb[0]*l,e.rgb[1]*a+n.rgb[1]*l,e.rgb[2]*a+n.rgb[2]*l],c=e.alpha*o+n.alpha*(1-o);return new t.Color(u,c)},greyscale:function(e){return this.desaturate(e,new t.Dimension(100))},"%":function(e){for(var n=Array.prototype.slice.call(arguments,1),i=e.value,o=0;o<n.length;o++)i=i.replace(/%s/,n[o].value).replace(/%[da]/,n[o].toString());return i=i.replace(/%%/g,"%"),new t.Quoted(i)}};for(var o=["emboss","blur","gray","sobel","edge-detect","x-gradient","y-gradient","sharpen"],r=0;r<o.length;r++){var s=o[r];t.functions[s]=function(e){return function(){return new t.ImageFilter(e)}}(s)}t.functions["agg-stack-blur"]=function(e,n){return new t.ImageFilter("agg-stack-blur",[e,n])},t.functions["scale-hsla"]=function(e,n,i,o,r,s,a,l){return new t.ImageFilter("scale-hsla",[e,n,i,o,r,s,a,l])}}(t("./tree"))},{"./tree":59}],54:[function(t,e,n){(function(e,i){function o(){if(e.browser)return t("../../package.json").version.split(".");if(parseInt(e.version.split(".")[1],10)>4)return t("../../package.json").version.split(".");var n=JSON.parse(a.readFileSync(l.join(i,"../../package.json")));return n.version.split(".")}function r(t,e){var n={bold:[1,22],inverse:[7,27],underline:[4,24],yellow:[33,39],green:[32,39],red:[31,39],grey:[90,39]};return"["+n[e][0]+"m"+t+"["+n[e][1]+"m"}var s=t("util"),a=t("fs"),l=t("path"),u={version:o(),Parser:t("./parser").Parser,Renderer:t("./renderer").Renderer,tree:t("./tree"),RendererJS:t("./renderer_js"),default_reference:t("./torque-reference"),writeError:function(t,e){var n="",i=t.extract,o=[];if(e=e||{},!e.silent){if(e.indent=e.indent||"",!("index"in t&&i))return s.error(e.indent+(t.stack||t.message));"string"==typeof i[0]&&o.push(r(t.line-1+" "+i[0],"grey")),""===i[1]&&"undefined"==typeof i[2]&&(i[1]="¬∂"),o.push(t.line+" "+i[1].slice(0,t.column)+r(r(i[1][t.column],"bold")+i[1].slice(t.column+1),"yellow")),"string"==typeof i[2]&&o.push(r(t.line+1+" "+i[2],"grey")),o=e.indent+o.join("\n"+e.indent)+"[0m\n",n=e.indent+n+r(t.message,"red"),t.filename&&(n+=r(" in ","red")+t.filename),s.error(n,o),t.callLine&&(s.error(r("from ","red")+(t.filename||"")),s.error(r(t.callLine,"grey")+" "+t.callExtract)),t.stack&&s.error(r(t.stack,"red"))}}};t("./tree/call"),t("./tree/color"),t("./tree/comment"),t("./tree/definition"),t("./tree/dimension"),t("./tree/element"),t("./tree/expression"),t("./tree/filterset"),t("./tree/filter"),t("./tree/field"),t("./tree/keyword"),t("./tree/layer"),t("./tree/literal"),t("./tree/operation"),t("./tree/quoted"),t("./tree/imagefilter"),t("./tree/reference"),t("./tree/rule"),t("./tree/ruleset"),t("./tree/selector"),t("./tree/style"),t("./tree/url"),t("./tree/value"),t("./tree/variable"),t("./tree/zoom"),t("./tree/invalid"),t("./tree/fontset"),t("./tree/frame_offset"),t("./functions");for(var c in u)n[c]=u[c]}).call(this,t("_process"),"/node_modules/torque.js/node_modules/carto/lib/carto")},{"../../package.json":90,"./functions":53,"./parser":55,"./renderer":56,"./renderer_js":57,"./torque-reference":58,"./tree":59,"./tree/call":60,"./tree/color":61,"./tree/comment":62,"./tree/definition":63,"./tree/dimension":64,"./tree/element":65,"./tree/expression":66,"./tree/field":67,"./tree/filter":68,"./tree/filterset":69,"./tree/fontset":70,"./tree/frame_offset":71,"./tree/imagefilter":72,"./tree/invalid":73,"./tree/keyword":74,"./tree/layer":75,"./tree/literal":76,"./tree/operation":77,"./tree/quoted":78,"./tree/reference":79,"./tree/rule":80,"./tree/ruleset":81,"./tree/selector":82,"./tree/style":83,"./tree/url":84,"./tree/value":85,"./tree/variable":86,"./tree/zoom":87,_process:17,fs:13,path:16,util:19}],55:[function(t,e,n){(function(e){var i=n,o=t("./tree"),r=e._||t("underscore");i.Parser=function(t){function e(){f=g[d],p=h,v=h}function n(){g[d]=f,h=p,v=h}function i(){h>v&&(g[d]=g[d].slice(h-v),v=h)}function s(t){var e,n,o,r;if(t instanceof Function)return t.call(y.parsers);if("string"==typeof t)e=c.charAt(h)===t?t:null,n=1,i();else{if(i(),e=t.exec(g[d]),!e)return null;n=e[0].length}if(e){var s=h+=n;for(r=h+g[d].length-n;r>h&&(o=c.charCodeAt(h),32===o||10===o||9===o);)h++;return g[d]=g[d].slice(n+(h-s)),v=h,0===g[d].length&&d<g.length-1&&d++,"string"==typeof e?e:1===e.length?e[0]:e}}function a(t){return"string"==typeof t?c.charAt(h)===t:!!t.test(g[d])}function l(t,e){return(t.slice(0,e).match(/\n/g)||"").length+1}function u(e){var n;r(e).defaults({index:m,filename:t.filename,message:"Parse error.",line:0,column:-1}),n=e.filename&&_.env.inputs&&_.env.inputs[e.filename]?_.env.inputs[e.filename]:c,e.line=l(n,e.index);for(var i=e.index;i>=0&&"\n"!==n.charAt(i);i--)e.column++;return new Error(r("<%=filename%>:<%=line%>:<%=column%> <%=message%>").template(e))}var c,h,d,f,p,m,g,v,y,_=this;return this.env=t=t||{},this.env.filename=this.env.filename||null,this.env.inputs=this.env.inputs||{},y={extractErrorLine:l,parse:function(e){var n,i=null;h=d=v=m=0,g=[],c=e.replace(/\r\n/g,"\n"),t.filename&&(_.env.inputs[t.filename]=c);if(g=function(t){for(var e,n,o,r,s=0,a=/(?:@\{[\w-]+\}|[^"'`\{\}\/\(\)\\])+/g,l=/\/\*(?:[^*]|\*+[^\/*])*\*+\/|\/\/.*/g,u=/"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'|`((?:[^`]|\\.)*)`/g,h=0,d=t[0],f=0;f<c.length;)if(a.lastIndex=f,(e=a.exec(c))&&e.index===f&&(f+=e[0].length,d.push(e[0])),o=c.charAt(f),l.lastIndex=u.lastIndex=f,(e=u.exec(c))&&e.index===f)f+=e[0].length,d.push(e[0]);else if(n||"/"!==o||(r=c.charAt(f+1),"/"!==r&&"*"!==r||!(e=l.exec(c))||e.index!==f)){switch(o){case"{":if(!n){h++,d.push(o);break}case"}":if(!n){h--,d.push(o),t[++s]=d=[];break}case"(":if(!n){n=!0,d.push(o);break}case")":if(n){n=!1,d.push(o);break}default:d.push(o)}f++}else f+=e[0].length,d.push(e[0]);return 0!==h&&(i={index:f-1,type:"Parse",message:h>0?"missing closing `}`":"missing opening `{`"}),t.map(function(t){return t.join("")})}([[]]),i)throw u(i);n=new o.Ruleset([],s(this.parsers.primary)),n.root=!0,n.toList=function(){return function(t){t.error=function(e){t.errors||(t.errors=new Error("")),t.errors.message?t.errors.message+="\n"+u(e).message:t.errors.message=u(e).message},t.frames=t.frames||[];var e=this.flatten([],[],t);return e.sort(r),e}}();var r=function(t,e){var n=t.specificity,i=e.specificity;return n[0]!=i[0]?i[0]-n[0]:n[1]!=i[1]?i[1]-n[1]:n[2]!=i[2]?i[2]-n[2]:i[3]-n[3]};return n},parsers:{primary:function(){for(var t,e=[];(t=s(this.rule)||s(this.ruleset)||s(this.comment))||s(/^[\s\n]+/)||(t=s(this.invalid));)t&&e.push(t);return e},invalid:function(){var t=s(/^[^;\n]*[;\n]/);return t?new o.Invalid(t,p):void 0},comment:function(){var t;if("/"===c.charAt(h))return"/"===c.charAt(h+1)?new o.Comment(s(/^\/\/.*/),!0):(t=s(/^\/\*(?:[^*]|\*+[^\/*])*\*+\/\n?/))?new o.Comment(t):void 0},entities:{quoted:function(){if('"'===c.charAt(h)||"'"===c.charAt(h)){var t=s(/^"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'/);return t?new o.Quoted(t[1]||t[2]):void 0}},field:function(){if(s("[")){var t=s(/(^[^\]]+)/);if(s("]"))return t?new o.Field(t[1]):void 0}},comparison:function(){var t=s(/^=~|=|!=|<=|>=|<|>/);return t?t:void 0},keyword:function(){var t=s(/^[A-Za-z-]+[A-Za-z-0-9_]*/);return t?new o.Keyword(t):void 0},call:function(){var t,e;if(t=/^([\w\-]+|%)\(/.exec(g[d])){if(t=t[1],"url"===t)return null;if(h+=t.length,s("("),e=s(this.entities.arguments),s(")"))return t?new o.Call(t,e,h):void 0}},arguments:function(){for(var t,e=[];(t=s(this.expression))&&(e.push(t),s(",")););return e},literal:function(){return s(this.entities.dimension)||s(this.entities.keywordcolor)||s(this.entities.hexcolor)||s(this.entities.quoted)},url:function(){var t;if("u"===c.charAt(h)&&s(/^url\(/))return t=s(this.entities.quoted)||s(this.entities.variable)||s(/^[\-\w%@$\/.&=:;#+?~]+/)||"",s(")")?new o.URL("undefined"!=typeof t.value||t instanceof o.Variable?t:new o.Quoted(t)):new o.Invalid(t,p,"Missing closing ) in URL.")},variable:function(){var e,n=h;return"@"===c.charAt(h)&&(e=s(/^@[\w-]+/))?new o.Variable(e,n,t.filename):void 0},hexcolor:function(){var t;return"#"===c.charAt(h)&&(t=s(/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})/))?new o.Color(t[1]):void 0},keywordcolor:function(){var t=g[d].match(/^[a-z]+/);return t&&t[0]in o.Reference.data.colors?new o.Color(o.Reference.data.colors[s(/^[a-z]+/)]):void 0},dimension:function(){var t=c.charCodeAt(h);if(!(t>57||45>t||47===t)){var e=s(/^(-?\d*\.?\d+(?:[eE][-+]?\d+)?)(\%|\w+)?/);return e?new o.Dimension(e[1],e[2],p):void 0}}},variable:function(){var t;return"@"===c.charAt(h)&&(t=s(/^(@[\w-]+)\s*:/))?t[1]:void 0},entity:function(){return s(this.entities.call)||s(this.entities.literal)||s(this.entities.field)||s(this.entities.variable)||s(this.entities.url)||s(this.entities.keyword)},end:function(){return s(";")||a("}")},element:function(){var t=s(/^(?:[.#][\w\-]+|\*|Map)/);return t?new o.Element(t):void 0},attachment:function(){var t=s(/^::([\w\-]+(?:\/[\w\-]+)*)/);return t?t[1]:void 0},selector:function(){var t,e,n,i,r,a=[],l=new o.Filterset,d=[],f=o.FrameOffset.none;for(segments=0,conditions=0;(n=s(this.element))||(r=s(this.zoom))||(fo=s(this.frame_offset))||(i=s(this.filter))||(t=s(this.attachment));){if(segments++,n)a.push(n);else if(r)d.push(r),conditions++;else if(fo)f=fo,conditions++;else if(i){var m=l.add(i);if(m)throw u({message:m,index:h-1});conditions++}else{if(e)throw u({message:"Encountered second attachment name.",index:h-1});e=t}var g=c.charAt(h);if("{"===g||"}"===g||";"===g||","===g)break}return segments?new o.Selector(l,d,f,a,e,conditions,p):void 0},filter:function(){e();var n,i,r;if(s("[")&&(n=s(/^[a-zA-Z0-9\-_]+/)||s(this.entities.quoted)||s(this.entities.variable)||s(this.entities.keyword)||s(this.entities.field))&&(n instanceof o.Quoted&&(n=new o.Field(n.toString())),(i=s(this.entities.comparison))&&(r=s(this.entities.quoted)||s(this.entities.variable)||s(this.entities.dimension)||s(this.entities.keyword)||s(this.entities.field)))){if(!s("]"))throw u({message:"Missing closing ] of filter.",index:p-1});return n.is||(n=new o.Field(n)),new o.Filter(n,i,r,p,t.filename)}},frame_offset:function(){e();var t,n;return s(/^\[\s*frame-offset/g)&&(t=s(this.entities.comparison))&&(n=s(/^\d+/))&&s("]")?o.FrameOffset(t,n,p):void 0},zoom:function(){e();var t,i;return s(/^\[\s*zoom/g)&&(t=s(this.entities.comparison))&&(i=s(this.entities.variable)||s(this.entities.dimension))&&s("]")?new o.Zoom(t,i,p):void n()},block:function(){var t;return s("{")&&(t=s(this.primary))&&s("}")?t:void 0},ruleset:function(){var t,i,r=[];for(e();t=s(this.selector);){for(r.push(t);s(this.comment););if(!s(","))break;for(;s(this.comment););}if(t)for(;s(this.comment););if(r.length>0&&(i=s(this.block))){if(1===r.length&&r[0].elements.length&&"Map"===r[0].elements[0].value){var a=new o.Ruleset(r,i);return a.isMap=!0,a}return new o.Ruleset(r,i)}n()},rule:function(){var i,r,a=c.charAt(h);if(e(),"."!==a&&"#"!==a&&(i=s(this.variable)||s(this.property))){if(r=s(this.value),r&&s(this.end))return new o.Rule(i,r,p,t.filename);m=h,n()}},font:function(){for(var t,e=[],n=[];t=s(this.entity);)n.push(t);if(e.push(new o.Expression(n)),s(","))for(;(t=s(this.expression))&&(e.push(t),s(",")););return new o.Value(e)},value:function(){for(var t,e=[];(t=s(this.expression))&&(e.push(t),s(",")););return e.length>1?new o.Value(e.map(function(t){return t.value[0]})):1===e.length?new o.Value(e):void 0},sub:function(){var t;return s("(")&&(t=s(this.expression))&&s(")")?t:void 0},multiplication:function(){var t,e,n,i;if(t=s(this.operand)){for(;(n=s("/")||s("*")||s("%"))&&(e=s(this.operand));)i=new o.Operation(n,[i||t,e],p);return i||t}},addition:function(){var t,e,n,i;if(t=s(this.multiplication)){for(;(n=s(/^[-+]\s+/)||" "!=c.charAt(h-1)&&(s("+")||s("-")))&&(e=s(this.multiplication));)i=new o.Operation(n,[i||t,e],p);return i||t}},operand:function(){return s(this.sub)||s(this.entity)},expression:function(){for(var t,e=[];t=s(this.addition)||s(this.entity);)e.push(t);return e.length>0?new o.Expression(e):void 0},property:function(){var t=s(/^(([a-z][-a-z_0-9]*\/)?\*?-?[-a-z_0-9]+)\s*:/);return t?t[1]:void 0}}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./tree":59,underscore:89}],56:[function(t,e,n){(function(n){function i(t,e,n,i){for(var o,r,s,a=e.filters,l=e.rules,u=0;u<t.length;u++)o=t[u].filters.cloneWith(a),o?(s=n[o],s?s.addRules(l):(r=t[u].clone(o),r.addRules(l)&&(n[o]=r,t.splice(u,0,r),u++))):null===o&&(t[u]=t[u].clone(),t[u].addRules(l));return t}function o(t,e){var n,o,r=+new Date,s={},a={},l=[];t.forEach(function(t){t.filters.ev(e)});for(var u=0;u<t.length;u++){o=t[u].attachment,n=[t[u]],s[o]||(s[o]=[],s[o].attachment=o,a[o]={},l.push(s[o]));for(var c=u+1;c<t.length;c++)t[c].attachment===o&&(n=i(n,t[c],a[o],e));for(var h=0;h<n.length;h++)a[o][n[h].filters]=n[h],s[o].push(n[h])}return e.benchmark&&console.warn("Inheritance time: "+(new Date-r)+"ms"),l}function r(t,e){return e.index-t.index}function s(t,e){for(var n=0;n<t.length;n++){var i=t[n];i.index=1/0;for(var o=0;o<i.length;o++)for(var s=i[o].rules,a=0;a<s.length;a++){var l=s[a];l.index<i.index&&(i.index=l.index)}}var u=t.slice();return u.sort(r),u}function a(t,e,n){var i={},o=u.tree.Reference.data.symbolizers.map;return l(t).each(function(t,e){e in o&&(i[e]=e+'="'+t+'"')}),e.filter(function(t){return"Map"===t.elements.join("")}).forEach(function(t){for(var e=0;e<t.rules.length;e++){var r=t.rules[e].name;r in o||n.error({message:"Rule "+r+" not allowed for Map.",index:t.rules[e].index}),i[r]=t.rules[e].ev(n).toXML(n)}}),i}var l=n._||t("underscore"),u=t("./index");u.Renderer=function(t,e){this.env=t||{},this.options=e||{},this.options.mapnik_version=this.options.mapnik_version||"3.0.0"},u.Renderer.prototype.renderMSS=function(t){var e=l(this.env).defaults({benchmark:!1,validation_data:!1,effects:[]});if(!u.tree.Reference.setVersion(this.options.mapnik_version))throw new Error("Could not set mapnik version to "+this.options.mapnik_version);var n=[],i=[];e.benchmark&&console.time("Parsing MSS");var r=u.Parser(e).parse(t);e.benchmark&&console.timeEnd("Parsing MSS"),e.benchmark&&console.time("Rule generation");var a=r.toList(e);e.benchmark&&console.timeEnd("Rule generation"),e.benchmark&&console.time("Rule inheritance");var c=o(a,e);e.benchmark&&console.timeEnd("Rule inheritance"),e.benchmark&&console.time("Style sort");var h=s(c,e);e.benchmark&&console.timeEnd("Style sort"),e.benchmark&&console.time("Total Style generation");for(var d,f,p=0;p<h.length;p++){d=h[p],f="style"+("__default__"!==d.attachment?"-"+d.attachment:""),i.push(f);var m='	Style "'+f+'" (#'+p+") toXML";e.benchmark&&console.time(m),n.push(u.tree.StyleXML(f,d.attachment,d,e)),e.benchmark&&console.timeEnd(m)}if(e.benchmark&&console.timeEnd("Total Style generation"),e.errors)throw e.errors;return n.join("\n")},u.Renderer.prototype.render=function(t){function e(t,e){return function(t){return t.appliesTo(r.name,e)}}var n=l(this.env).defaults({benchmark:!1,validation_data:!1,effects:[],ppi:90.714});if(!u.tree.Reference.setVersion(this.options.mapnik_version))throw new Error("Could not set mapnik version to "+this.options.mapnik_version);for(var i,r,c,h,d,f,p=[],m=l(t.Stylesheet).chain().map(function(t){if("string"==typeof t)throw new Error("Stylesheet object is expected not a string: '"+t+"'");n=l(n).extend({filename:t.id});var e=+new Date,i=u.Parser(n).parse(t.data);return n.benchmark&&console.warn("Parsing time: "+(new Date-e)+"ms"),i.toList(n)}).flatten().value(),g=0;g<t.Layer.length;g++){r=t.Layer[g],i=[],c={},n.benchmark&&console.warn("processing layer: "+r.id);for(var v=(r["class"]||"").split(/\s+/g),y=0;y<v.length;y++)c[v[y]]=!0;f=m.filter(e(r.name,c)),h=o(f,n),d=s(h,n);for(var _,b,w=0;w<d.length;w++){_=d[w],b=r.name+("__default__"!==_.attachment?"-"+_.attachment:"");var x=u.tree.StyleXML(b,_.attachment,_,n);x&&(p.push(x),i.push(b))}p.push(u.tree.LayerXML(r,i))}p.unshift(n.effects.map(function(t){return t.toXML(n)}).join("\n"));var L=a(t,m,n);if(n.errors)throw n.errors;var T=l(t).reduce(function(t,e,n){if(!e&&0!==e)return t;switch(n){case"srs":case"Layer":case"Stylesheet":break;case"bounds":case"center":case"minzoom":case"maxzoom":case"version":t.push('  <Parameter name="'+n+'">'+e+"</Parameter>");break;case"name":case"description":case"legend":case"attribution":case"template":t.push('  <Parameter name="'+n+'"><![CDATA['+e+"]]></Parameter>");break;case"format":t.push('  <Parameter name="'+n+'">'+e+"</Parameter>");break;case"interactivity":t.push('  <Parameter name="interactivity_layer">'+e.layer+"</Parameter>"),t.push('  <Parameter name="interactivity_fields">'+e.fields+"</Parameter>");break;default:"string"==typeof e?t.push('  <Parameter name="'+n+'"><![CDATA['+e+"]]></Parameter>"):"number"==typeof e?t.push('  <Parameter name="'+n+'">'+e+"</Parameter>"):"boolean"==typeof e&&t.push('  <Parameter name="'+n+'">'+e+"</Parameter>")}return t},[]);T.length&&p.unshift("<Parameters>\n"+T.join("\n")+"\n</Parameters>\n");var S=l(L).map(function(t){return" "+t}).join("");return p.unshift('<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE Map[]>\n<Map'+S+">\n"),p.push("</Map>"),p.join("\n")},e.exports=u,e.exports.addRules=i,e.exports.inheritDefinitions=o,e.exports.sortStyles=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./index":54,underscore:89}],57:[function(require,module,exports){(function(global){!function(carto){function CartoCSS(t,e){this.options=e||{},this.imageURLs=[],t&&this.setStyle(t)}var tree=require("./tree"),_=global._||require("underscore");CartoCSS.Layer=function(t,e){this.options=e,this.shader=t},CartoCSS.Layer.prototype={fullName:function(){return this.shader.attachment},name:function(){return this.fullName().split("::")[0]},frames:function(){return this.shader.frames},attachment:function(){return this.fullName().split("::")[1]},eval:function(t){var e=this.shader[t];if(e&&e.style)return e.style({},{zoom:0,"frame-offset":0})},getStyle:function(t,e){var n={};for(var i in this.shader)"attachment"!==i&&"zoom"!==i&&"frames"!==i&&"symbolizers"!==i&&(n[i]=this.shader[i].style(t,e));return n},getSymbolizers:function(){return this.shader.symbolizers},isVariable:function(){for(var t in this.shader)if("attachment"!==t&&"zoom"!==t&&"frames"!==t&&"symbolizers"!==t&&!this.shader[t].constant)return!0;return!1},getShader:function(){return this.shader},filter:function(t,e,n){for(var i in this.shader){var o=this.shader[i](e,n);if(o)return!0}return!1},transformGeometry:function(t){return t},transformGeometries:function(t){return t}},CartoCSS.prototype={setStyle:function(t){var e=this.parse(t);if(!e)throw new Error(this.parse_env.errors);this.layers=e.map(function(t){return new CartoCSS.Layer(t)})},getLayers:function(){return this.layers},getDefault:function(){return this.findLayer({attachment:"__default__"})},findLayer:function(t){return _.find(this.layers,function(e){for(var n in t){var i=e[n];if("function"==typeof i&&(i=i.call(e)),t[n]!==i)return!1}return!0})},_createFn:function(t){var e=t.join("\n");return this.options.debug&&console.log(e),Function("data","ctx","var _value = null; "+e+"; return _value; ")},_compile:function(shader){"string"==typeof shader&&(shader=eval("(function() { return "+shader+"; })()")),this.shader_src=shader;for(var attr in shader){var c=mapper[attr];c&&(this.compiled[c]=eval("(function() { return shader[attr]; })();"))}},getImageURLs:function(){return this.imageURLs},parse:function(t){function e(t){return t.elements[0]+"::"+t.attachment}var n={frames:[],errors:[],error:function(t){this.errors.push(t)}};this.parse_env=n;var i=null;try{i=new carto.Parser(n).parse(t)}catch(o){return void n.errors.push(o.message)}if(i){var r=i.toList(n);r.reverse();for(var s={},a=0;a<r.length;++a){for(var l=r[a],u=e(l),c=s[u]=s[u]||{symbolizers:[]},h=0;h<l.rules.length;h++)if("marker-file"===l.rules[h].name||"point-file"===l.rules[h].name){var d=l.rules[h].value.value[0].value[0].value.value;this.imageURLs.push(d)}c.frames=[],c.zoom=tree.Zoom.all;var f=l.toJS(n);this.options.debug&&console.log("props",f);for(var p in f){var m=c[p]=c[p]||{constant:!1,symbolizer:null,js:[],index:0};m.js.push(f[p].map(function(t){return t.js}).join("\n")),m.symbolizer=_.first(f[p].map(function(t){return t.symbolizer})),m.index=_.max(f[p].map(function(t){return t.index}).concat(m.index)),m.constant=!_.any(f[p].map(function(t){return!t.constant}))}}var g=[];this.options.debug&&console.log(s);for(var v={},a=0;a<r.length;++a){var l=r[a],y=e(l),c=s[y];if(!v[y]){this.options.debug&&console.log("**",y);for(var b in c)"zoom"!==b&&"frames"!==b&&"symbolizers"!==b&&(this.options.debug&&console.log("*",b),c[b].style=this._createFn(c[b].js),c.symbolizers.push(c[b].symbolizer),c.symbolizers=_.uniq(c.symbolizers));c.attachment=y,g.push(c),v[y]=!0}c.zoom|=l.zoom,c.frames.push(l.frame_offset)}for(a=0;a<g.length;++a)g[a].frames=_.uniq(g[a].frames);return g}return null}},carto.RendererJS=function(t){this.options=t||{},this.options.mapnik_version=this.options.mapnik_version||"latest"},carto.RendererJS.prototype.render=function(t,e){var n=require("./torque-reference");return tree.Reference.setData(n.version.latest),new CartoCSS(t,this.options)},"undefined"!=typeof module&&(module.exports=carto.RendererJS)}(require("../carto"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../carto":54,"./torque-reference":58,"./tree":59,underscore:89}],58:[function(t,e,n){var i={version:"2.1.1",style:{"filter-mode":{type:["all","first"],doc:"Control the processing behavior of Rule filters within a Style. If 'all' is used then all Rules are processed sequentially independent of whether any previous filters matched. If 'first' is used then it means processing ends after the first match (a positive filter evaluation) and no further Rules in the Style are processed ('first' is usually the default for CSS implementations on top of Mapnik to simplify translation from CSS to Mapnik XML)","default-value":"all","default-meaning":"All Rules in a Style are processed whether they have filters or not and whether or not the filter conditions evaluate to true."},"image-filters":{css:"image-filters","default-value":"none","default-meaning":"no filters",type:"functions",functions:[["agg-stack-blur",2],["emboss",0],["blur",0],["gray",0],["sobel",0],["edge-detect",0],["x-gradient",0],["y-gradient",0],["invert",0],["sharpen",0],["colorize-alpha",-1],["color-to-alpha",1],["scale-hsla",8]],doc:"A list of image filters."},"comp-op":{css:"comp-op","default-value":"src-over","default-meaning":"add the current layer on top of other layers",doc:"Composite operation. This defines how this layer should behave relative to layers atop or below it.",type:["clear","src","dst","src-over","source-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","lighter","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]},opacity:{css:"opacity",type:"float",doc:"An alpha value for the style (which means an alpha applied to all features in separate buffer and then composited back to main buffer)","default-value":1,"default-meaning":"no separate buffer will be used and no alpha will be applied to the style after rendering"}},layer:{name:{"default-value":"",type:"string",required:!0,"default-meaning":"No layer name has been provided",doc:"The name of a layer. Can be anything you wish and is not strictly validated, but ideally unique  in the map"},srs:{"default-value":"",type:"string","default-meaning":"No srs value is provided and the value will be inherited from the Map's srs",doc:"The spatial reference system definition for the layer, aka the projection. Can either be a proj4 literal string like '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs' or, if the proper proj4 epsg/nad/etc identifier files are installed, a string that uses an id like: '+init=epsg:4326'"},status:{"default-value":!0,type:"boolean","default-meaning":"This layer will be marked as active and available for processing",doc:"A property that can be set to false to disable this layer from being processed"},minzoom:{"default-value":"0",type:"float","default-meaning":"The layer will be visible at the minimum possible scale",doc:"The minimum scale denominator that this layer will be visible at. A layer's visibility is determined by whether its status is true and if the Map scale >= minzoom - 1e-6 and scale < maxzoom + 1e-6"},maxzoom:{"default-value":"1.79769e+308",type:"float","default-meaning":"The layer will be visible at the maximum possible scale",doc:"The maximum scale denominator that this layer will be visible at. The default is the numeric limit of the C++ double type, which may vary slightly by system, but is likely a massive number like 1.79769e+308 and ensures that this layer will always be visible unless the value is reduced. A layer's visibility is determined by whether its status is true and if the Map scale >= minzoom - 1e-6 and scale < maxzoom + 1e-6"},queryable:{"default-value":!1,type:"boolean","default-meaning":"The layer will not be available for the direct querying of data values",doc:"This property was added for GetFeatureInfo/WMS compatibility and is rarely used. It is off by default meaning that in a WMS context the layer will not be able to be queried unless the property is explicitly set to true"},"clear-label-cache":{"default-value":!1,type:"boolean","default-meaning":"The renderer's collision detector cache (used for avoiding duplicate labels and overlapping markers) will not be cleared immediately before processing this layer",doc:"This property, by default off, can be enabled to allow a user to clear the collision detector cache before a given layer is processed. This may be desirable to ensure that a given layers data shows up on the map even if it normally would not because of collisions with previously rendered labels or markers"},"group-by":{"default-value":"",type:"string","default-meaning":"No special layer grouping will be used during rendering",doc:"https://github.com/mapnik/mapnik/wiki/Grouped-rendering"},"buffer-size":{"default-value":"0",type:"float","default-meaning":"No buffer will be used",doc:"Extra tolerance around the Layer extent (in pixels) used to when querying and (potentially) clipping the layer data during rendering"},"maximum-extent":{"default-value":"none",type:"bbox","default-meaning":"No clipping extent will be used",doc:"An extent to be used to limit the bounds used to query this specific layer data during rendering. Should be minx, miny, maxx, maxy in the coordinates of the Layer."}},symbolizers:{"*":{"image-filters":{css:"image-filters","default-value":"none","default-meaning":"no filters",type:"functions",functions:[["agg-stack-blur",2],["emboss",0],["blur",0],["gray",0],["sobel",0],["edge-detect",0],["x-gradient",0],["y-gradient",0],["invert",0],["sharpen",0],["colorize-alpha",-1],["color-to-alpha",1],["scale-hsla",8]],
doc:"A list of image filters."},"comp-op":{css:"comp-op","default-value":"src-over","default-meaning":"add the current layer on top of other layers",doc:"Composite operation. This defines how this layer should behave relative to layers atop or below it.",type:["clear","src","dst","src-over","source-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","lighter","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]},opacity:{css:"opacity",type:"float",doc:"An alpha value for the style (which means an alpha applied to all features in separate buffer and then composited back to main buffer)","default-value":1,"default-meaning":"no separate buffer will be used and no alpha will be applied to the style after rendering"}},map:{"background-color":{css:"background-color","default-value":"none","default-meaning":"transparent",type:"color",doc:"Map Background color"},"background-image":{css:"background-image",type:"uri","default-value":"","default-meaning":"transparent",doc:"An image that is repeated below all features on a map as a background.",description:"Map Background image"},srs:{css:"srs",type:"string","default-value":"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs","default-meaning":"The proj4 literal of EPSG:4326 is assumed to be the Map's spatial reference and all data from layers within this map will be plotted using this coordinate system. If any layers do not declare an srs value then they will be assumed to be in the same srs as the Map and not transformations will be needed to plot them in the Map's coordinate space",doc:"Map spatial reference (proj4 string)"},"buffer-size":{css:"buffer-size","default-value":"0",type:"float","default-meaning":"No buffer will be used",doc:'Extra tolerance around the map (in pixels) used to ensure labels crossing tile boundaries are equally rendered in each tile (e.g. cut in each tile). Not intended to be used in combination with "avoid-edges".'},"maximum-extent":{css:"","default-value":"none",type:"bbox","default-meaning":"No clipping extent will be used",doc:"An extent to be used to limit the bounds used to query all layers during rendering. Should be minx, miny, maxx, maxy in the coordinates of the Map."},base:{css:"base","default-value":"","default-meaning":"This base path defaults to an empty string meaning that any relative paths to files referenced in styles or layers will be interpreted relative to the application process.",type:"string",doc:"Any relative paths used to reference files will be understood as relative to this directory path if the map is loaded from an in memory object rather than from the filesystem. If the map is loaded from the filesystem and this option is not provided it will be set to the directory of the stylesheet."},"paths-from-xml":{css:"","default-value":!0,"default-meaning":"Paths read from XML will be interpreted from the location of the XML",type:"boolean",doc:"value to control whether paths in the XML will be interpreted from the location of the XML or from the working directory of the program that calls load_map()"},"minimum-version":{css:"","default-value":"none","default-meaning":"Mapnik version will not be detected and no error will be thrown about compatibility",type:"string",doc:"The minumum Mapnik version (e.g. 0.7.2) needed to use certain functionality in the stylesheet"},"font-directory":{css:"font-directory",type:"uri","default-value":"none","default-meaning":"No map-specific fonts will be registered",doc:"Path to a directory which holds fonts which should be registered when the Map is loaded (in addition to any fonts that may be automatically registered)."}},polygon:{fill:{css:"polygon-fill",type:"color","default-value":"rgba(128,128,128,1)","default-meaning":"gray and fully opaque (alpha = 1), same as rgb(128,128,128)",doc:"Fill color to assign to a polygon"},"fill-opacity":{css:"polygon-opacity",type:"float",doc:"The opacity of the polygon","default-value":1,"default-meaning":"opaque"},gamma:{css:"polygon-gamma",type:"float","default-value":1,"default-meaning":"fully antialiased",range:"0-1",doc:"Level of antialiasing of polygon edges"},"gamma-method":{css:"polygon-gamma-method",type:["power","linear","none","threshold","multiply"],"default-value":"power","default-meaning":"pow(x,gamma) is used to calculate pixel gamma, which produces slightly smoother line and polygon antialiasing than the 'linear' method, while other methods are usually only used to disable AA",doc:"An Antigrain Geometry specific rendering hint to control the quality of antialiasing. Under the hood in Mapnik this method is used in combination with the 'gamma' value (which defaults to 1). The methods are in the AGG source at https://github.com/mapnik/mapnik/blob/master/deps/agg/include/agg_gamma_functions.h"},clip:{css:"polygon-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},smooth:{css:"polygon-smooth",type:"float","default-value":0,"default-meaning":"no smoothing",range:"0-1",doc:"Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."},"geometry-transform":{css:"polygon-geometry-transform",type:"functions","default-value":"none","default-meaning":"geometry will not be transformed",doc:"Allows transformation functions to be applied to the geometry.",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]]},"comp-op":{css:"polygon-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},line:{stroke:{css:"line-color","default-value":"rgba(0,0,0,1)",type:"color","default-meaning":"black and fully opaque (alpha = 1), same as rgb(0,0,0)",doc:"The color of a drawn line"},"stroke-width":{css:"line-width","default-value":1,type:"float",doc:"The width of a line in pixels"},"stroke-opacity":{css:"line-opacity","default-value":1,type:"float","default-meaning":"opaque",doc:"The opacity of a line"},"stroke-linejoin":{css:"line-join","default-value":"miter",type:["miter","round","bevel"],doc:"The behavior of lines when joining"},"stroke-linecap":{css:"line-cap","default-value":"butt",type:["butt","round","square"],doc:"The display of line endings"},"stroke-gamma":{css:"line-gamma",type:"float","default-value":1,"default-meaning":"fully antialiased",range:"0-1",doc:"Level of antialiasing of stroke line"},"stroke-gamma-method":{css:"line-gamma-method",type:["power","linear","none","threshold","multiply"],"default-value":"power","default-meaning":"pow(x,gamma) is used to calculate pixel gamma, which produces slightly smoother line and polygon antialiasing than the 'linear' method, while other methods are usually only used to disable AA",doc:"An Antigrain Geometry specific rendering hint to control the quality of antialiasing. Under the hood in Mapnik this method is used in combination with the 'gamma' value (which defaults to 1). The methods are in the AGG source at https://github.com/mapnik/mapnik/blob/master/deps/agg/include/agg_gamma_functions.h"},"stroke-dasharray":{css:"line-dasharray",type:"numbers",doc:"A pair of length values [a,b], where (a) is the dash length and (b) is the gap length respectively. More than two values are supported for more complex patterns.","default-value":"none","default-meaning":"solid line"},"stroke-dashoffset":{css:"line-dash-offset",type:"numbers",doc:"valid parameter but not currently used in renderers (only exists for experimental svg support in Mapnik which is not yet enabled)","default-value":"none","default-meaning":"solid line"},"stroke-miterlimit":{css:"line-miterlimit",type:"float",doc:"The limit on the ratio of the miter length to the stroke-width. Used to automatically convert miter joins to bevel joins for sharp angles to avoid the miter extending beyond the thickness of the stroking path. Normally will not need to be set, but a larger value can sometimes help avoid jaggy artifacts.","default-value":4,"default-meaning":"Will auto-convert miters to bevel line joins when theta is less than 29 degrees as per the SVG spec: 'miterLength / stroke-width = 1 / sin ( theta / 2 )'"},clip:{css:"line-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},smooth:{css:"line-smooth",type:"float","default-value":0,"default-meaning":"no smoothing",range:"0-1",doc:"Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."},offset:{css:"line-offset",type:"float","default-value":0,"default-meaning":"no offset",doc:"Offsets a line a number of pixels parallel to its actual path. Postive values move the line left, negative values move it right (relative to the directionality of the line)."},rasterizer:{css:"line-rasterizer",type:["full","fast"],"default-value":"full",doc:"Exposes an alternate AGG rendering method that sacrifices some accuracy for speed."},"geometry-transform":{css:"line-geometry-transform",type:"functions","default-value":"none","default-meaning":"geometry will not be transformed",doc:"Allows transformation functions to be applied to the geometry.",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]]},"comp-op":{css:"line-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},markers:{file:{css:"marker-file",doc:"An SVG file that this marker shows at each placement. If no file is given, the marker will show an ellipse.","default-value":"","default-meaning":"An ellipse or circle, if width equals height",type:"uri"},opacity:{css:"marker-opacity",doc:"The overall opacity of the marker, if set, overrides both the opacity of both the fill and stroke","default-value":1,"default-meaning":"The stroke-opacity and fill-opacity will be used",type:"float"},"fill-opacity":{css:"marker-fill-opacity",doc:"The fill opacity of the marker","default-value":1,"default-meaning":"opaque",type:"float"},stroke:{css:"marker-line-color",doc:"The color of the stroke around a marker shape.","default-value":"black",type:"color"},"stroke-width":{css:"marker-line-width",doc:"The width of the stroke around a marker shape, in pixels. This is positioned on the boundary, so high values can cover the area itself.",type:"float"},"stroke-opacity":{css:"marker-line-opacity","default-value":1,"default-meaning":"opaque",doc:"The opacity of a line",type:"float"},placement:{css:"marker-placement",type:["point","line","interior"],"default-value":"point","default-meaning":"Place markers at the center point (centroid) of the geometry",doc:"Attempt to place markers on a point, in the center of a polygon, or if markers-placement:line, then multiple times along a line. 'interior' placement can be used to ensure that points placed on polygons are forced to be inside the polygon interior"},"multi-policy":{css:"marker-multi-policy",type:["each","whole","largest"],"default-value":"each","default-meaning":"If a feature contains multiple geometries and the placement type is either point or interior then a marker will be rendered for each",doc:"A special setting to allow the user to control rendering behavior for 'multi-geometries' (when a feature contains multiple geometries). This setting does not apply to markers placed along lines. The 'each' policy is default and means all geometries will get a marker. The 'whole' policy means that the aggregate centroid between all geometries will be used. The 'largest' policy means that only the largest (by bounding box areas) feature will get a rendered marker (this is how text labeling behaves by default)."},"marker-type":{css:"marker-type",type:["arrow","ellipse","rectangle"],"default-value":"ellipse",doc:"The default marker-type. If a SVG file is not given as the marker-file parameter, the renderer provides either an arrow or an ellipse (a circle if height is equal to width)"},width:{css:"marker-width","default-value":10,doc:"The width of the marker, if using one of the default types.",type:"float",expression:!0},height:{css:"marker-height","default-value":10,doc:"The height of the marker, if using one of the default types.",type:"float",expression:!0},fill:{css:"marker-fill","default-value":"blue",doc:"The color of the area of the marker.",type:"color"},"allow-overlap":{css:"marker-allow-overlap",type:"boolean","default-value":!1,doc:"Control whether overlapping markers are shown or hidden.","default-meaning":"Do not allow makers to overlap with each other - overlapping markers will not be shown."},"ignore-placement":{css:"marker-ignore-placement",type:"boolean","default-value":!1,"default-meaning":"do not store the bbox of this geometry in the collision detector cache",doc:"value to control whether the placement of the feature will prevent the placement of other features"},spacing:{css:"marker-spacing",doc:"Space between repeated labels","default-value":100,type:"float"},"max-error":{css:"marker-max-error",type:"float","default-value":.2,doc:"The maximum difference between actual marker placement and the marker-spacing parameter. Setting a high value can allow the renderer to try to resolve placement conflicts with other symbolizers."},transform:{css:"marker-transform",type:"functions",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]],"default-value":"","default-meaning":"No transformation",doc:"SVG transformation definition"},clip:{css:"marker-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},smooth:{css:"marker-smooth",type:"float","default-value":0,"default-meaning":"no smoothing",range:"0-1",doc:"Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."},"geometry-transform":{css:"marker-geometry-transform",type:"functions","default-value":"none","default-meaning":"geometry will not be transformed",doc:"Allows transformation functions to be applied to the geometry.",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]]},"comp-op":{css:"marker-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},shield:{name:{css:"shield-name",type:"string",expression:!0,serialization:"content",doc:'Value to use for a shield"s text label. Data columns are specified using brackets like [column_name]'},file:{css:"shield-file",required:!0,type:"uri","default-value":"none",doc:"Image file to render behind the shield text"},"face-name":{css:"shield-face-name",type:"string",validate:"font",doc:"Font name and style to use for the shield text","default-value":"",required:!0},"unlock-image":{css:"shield-unlock-image",type:"boolean",doc:"This parameter should be set to true if you are trying to position text beside rather than on top of the shield image","default-value":!1,"default-meaning":"text alignment relative to the shield image uses the center of the image as the anchor for text positioning."},size:{css:"shield-size",type:"float",doc:"The size of the shield text in pixels"},fill:{css:"shield-fill",type:"color",doc:"The color of the shield text"},placement:{css:"shield-placement",type:["point","line","vertex","interior"],"default-value":"point",doc:"How this shield should be placed. Point placement attempts to place it on top of points, line places along lines multiple times per feature, vertex places on the vertexes of polygons, and interior attempts to place inside of polygons."},"avoid-edges":{css:"shield-avoid-edges",doc:"Tell positioning algorithm to avoid labeling near intersection edges.",type:"boolean","default-value":!1},"allow-overlap":{css:"shield-allow-overlap",type:"boolean","default-value":!1,doc:"Control whether overlapping shields are shown or hidden.","default-meaning":"Do not allow shields to overlap with other map elements already placed."},"minimum-distance":{css:"shield-min-distance",type:"float","default-value":0,doc:"Minimum distance to the next shield symbol, not necessarily the same shield."},spacing:{css:"shield-spacing",type:"float","default-value":0,doc:"The spacing between repeated occurrences of the same shield on a line"},"minimum-padding":{css:"shield-min-padding","default-value":0,doc:"Determines the minimum amount of padding that a shield gets relative to other shields",type:"float"},"wrap-width":{css:"shield-wrap-width",type:"unsigned","default-value":0,doc:"Length of a chunk of text in characters before wrapping text"},"wrap-before":{css:"shield-wrap-before",type:"boolean","default-value":!1,doc:"Wrap text before wrap-width is reached. If false, wrapped lines will be a bit longer than wrap-width."},"wrap-character":{css:"shield-wrap-character",type:"string","default-value":" ",doc:"Use this character instead of a space to wrap long names."},"halo-fill":{css:"shield-halo-fill",type:"color","default-value":"#FFFFFF","default-meaning":"white",doc:"Specifies the color of the halo around the text."},"halo-radius":{css:"shield-halo-radius",doc:"Specify the radius of the halo in pixels","default-value":0,"default-meaning":"no halo",type:"float"},"character-spacing":{css:"shield-character-spacing",type:"unsigned","default-value":0,doc:"Horizontal spacing between characters (in pixels). Currently works for point placement only, not line placement."},"line-spacing":{css:"shield-line-spacing",doc:"Vertical spacing between lines of multiline labels (in pixels)",type:"unsigned"},dx:{css:"shield-text-dx",type:"float",doc:"Displace text within shield by fixed amount, in pixels, +/- along the X axis.  A positive value will shift the text right","default-value":0},dy:{css:"shield-text-dy",type:"float",doc:"Displace text within shield by fixed amount, in pixels, +/- along the Y axis.  A positive value will shift the text down","default-value":0},"shield-dx":{css:"shield-dx",type:"float",doc:"Displace shield by fixed amount, in pixels, +/- along the X axis.  A positive value will shift the text right","default-value":0},"shield-dy":{css:"shield-dy",type:"float",doc:"Displace shield by fixed amount, in pixels, +/- along the Y axis.  A positive value will shift the text down","default-value":0},opacity:{css:"shield-opacity",type:"float",doc:"(Default 1.0) - opacity of the image used for the shield","default-value":1},"text-opacity":{css:"shield-text-opacity",type:"float",doc:"(Default 1.0) - opacity of the text placed on top of the shield","default-value":1},"horizontal-alignment":{css:"shield-horizontal-alignment",type:["left","middle","right","auto"],doc:"The shield's horizontal alignment from its centerpoint","default-value":"auto"},"vertical-alignment":{css:"shield-vertical-alignment",type:["top","middle","bottom","auto"],doc:"The shield's vertical alignment from its centerpoint","default-value":"middle"},"text-transform":{css:"shield-text-transform",type:["none","uppercase","lowercase","capitalize"],doc:"Transform the case of the characters","default-value":"none"},"justify-alignment":{css:"shield-justify-alignment",type:["left","center","right","auto"],doc:"Define how text in a shield's label is justified","default-value":"auto"},clip:{css:"shield-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},"comp-op":{css:"shield-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},"line-pattern":{file:{css:"line-pattern-file",type:"uri","default-value":"none",required:!0,doc:"An image file to be repeated and warped along a line"},clip:{css:"line-pattern-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},smooth:{css:"line-pattern-smooth",type:"float","default-value":0,"default-meaning":"no smoothing",range:"0-1",doc:"Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."},"geometry-transform":{css:"line-pattern-geometry-transform",type:"functions","default-value":"none","default-meaning":"geometry will not be transformed",doc:"Allows transformation functions to be applied to the geometry.",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]]},"comp-op":{css:"line-pattern-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},"polygon-pattern":{file:{css:"polygon-pattern-file",type:"uri","default-value":"none",required:!0,doc:"Image to use as a repeated pattern fill within a polygon"},alignment:{css:"polygon-pattern-alignment",type:["local","global"],"default-value":"local",doc:"Specify whether to align pattern fills to the layer or to the map."},gamma:{css:"polygon-pattern-gamma",type:"float","default-value":1,"default-meaning":"fully antialiased",range:"0-1",doc:"Level of antialiasing of polygon pattern edges"},opacity:{css:"polygon-pattern-opacity",type:"float",doc:"(Default 1.0) - Apply an opacity level to the image used for the pattern","default-value":1,"default-meaning":"The image is rendered without modifications"},clip:{css:"polygon-pattern-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},smooth:{css:"polygon-pattern-smooth",type:"float","default-value":0,"default-meaning":"no smoothing",range:"0-1",doc:"Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."},"geometry-transform":{css:"polygon-pattern-geometry-transform",type:"functions","default-value":"none","default-meaning":"geometry will not be transformed",doc:"Allows transformation functions to be applied to the geometry.",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]]},"comp-op":{css:"polygon-pattern-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},raster:{opacity:{css:"raster-opacity","default-value":1,"default-meaning":"opaque",type:"float",doc:"The opacity of the raster symbolizer on top of other symbolizers."},"filter-factor":{css:"raster-filter-factor","default-value":-1,"default-meaning":"Allow the datasource to choose appropriate downscaling.",type:"float",doc:"This is used by the Raster or Gdal datasources to pre-downscale images using overviews. Higher numbers can sometimes cause much better scaled image output, at the cost of speed."},scaling:{css:"raster-scaling",type:["near","fast","bilinear","bilinear8","bicubic","spline16","spline36","hanning","hamming","hermite","kaiser","quadric","catrom","gaussian","bessel","mitchell","sinc","lanczos","blackman"],"default-value":"near",doc:"The scaling algorithm used to making different resolution versions of this raster layer. Bilinear is a good compromise between speed and accuracy, while lanczos gives the highest quality."},"mesh-size":{css:"raster-mesh-size","default-value":16,"default-meaning":"Reprojection mesh will be 1/16 of the resolution of the source image",type:"unsigned",doc:"A reduced resolution mesh is used for raster reprojection, and the total image size is divided by the mesh-size to determine the quality of that mesh. Values for mesh-size larger than the default will result in faster reprojection but might lead to distortion."},"comp-op":{css:"raster-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},point:{file:{css:"point-file",type:"uri",required:!1,"default-value":"none",doc:"Image file to represent a point"},"allow-overlap":{css:"point-allow-overlap",type:"boolean","default-value":!1,doc:"Control whether overlapping points are shown or hidden.","default-meaning":"Do not allow points to overlap with each other - overlapping markers will not be shown."},"ignore-placement":{css:"point-ignore-placement",type:"boolean","default-value":!1,"default-meaning":"do not store the bbox of this geometry in the collision detector cache",doc:"value to control whether the placement of the feature will prevent the placement of other features"},opacity:{css:"point-opacity",type:"float","default-value":1,"default-meaning":"Fully opaque",doc:"A value from 0 to 1 to control the opacity of the point"},placement:{css:"point-placement",type:["centroid","interior"],doc:"How this point should be placed. Centroid calculates the geometric center of a polygon, which can be outside of it, while interior always places inside of a polygon.","default-value":"centroid"},transform:{css:"point-transform",type:"functions",functions:[["matrix",6],["translate",2],["scale",2],["rotate",3],["skewX",1],["skewY",1]],"default-value":"","default-meaning":"No transformation",doc:"SVG transformation definition"},"comp-op":{css:"point-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},text:{name:{css:"text-name",type:"string",expression:!0,required:!0,"default-value":"",serialization:"content",doc:"Value to use for a text label. Data columns are specified using brackets like [column_name]"},"face-name":{css:"text-face-name",type:"string",validate:"font",doc:"Font name and style to render a label in",required:!0},size:{css:"text-size",type:"float","default-value":10,doc:"Text size in pixels"},"text-ratio":{css:"text-ratio",doc:"Define the amount of text (of the total) present on successive lines when wrapping occurs","default-value":0,type:"unsigned"},"wrap-width":{css:"text-wrap-width",doc:"Length of a chunk of text in characters before wrapping text","default-value":0,type:"unsigned"},"wrap-before":{css:"text-wrap-before",type:"boolean","default-value":!1,doc:"Wrap text before wrap-width is reached. If false, wrapped lines will be a bit longer than wrap-width."},"wrap-character":{css:"text-wrap-character",type:"string","default-value":" ",doc:"Use this character instead of a space to wrap long text."},spacing:{css:"text-spacing",type:"unsigned",doc:"Distance between repeated text labels on a line (aka. label-spacing)"},"character-spacing":{css:"text-character-spacing",type:"float","default-value":0,doc:"Horizontal spacing adjustment between characters in pixels"},"line-spacing":{css:"text-line-spacing","default-value":0,type:"unsigned",doc:"Vertical spacing adjustment between lines in pixels"},"label-position-tolerance":{css:"text-label-position-tolerance","default-value":0,type:"unsigned",doc:"Allows the label to be displaced from its ideal position by a number of pixels (only works with placement:line)"},"max-char-angle-delta":{css:"text-max-char-angle-delta",type:"float","default-value":"22.5",doc:"The maximum angle change, in degrees, allowed between adjacent characters in a label. This value internally is converted to radians to the default is 22.5*math.pi/180.0. The higher the value the fewer labels will be placed around around sharp corners."},fill:{css:"text-fill",doc:"Specifies the color for the text","default-value":"#000000",
type:"color"},opacity:{css:"text-opacity",doc:"A number from 0 to 1 specifying the opacity for the text","default-value":1,"default-meaning":"Fully opaque",type:"float"},"halo-fill":{css:"text-halo-fill",type:"color","default-value":"#FFFFFF","default-meaning":"white",doc:"Specifies the color of the halo around the text."},"halo-radius":{css:"text-halo-radius",doc:"Specify the radius of the halo in pixels","default-value":0,"default-meaning":"no halo",type:"float"},dx:{css:"text-dx",type:"float",doc:"Displace text by fixed amount, in pixels, +/- along the X axis.  A positive value will shift the text right","default-value":0},dy:{css:"text-dy",type:"float",doc:"Displace text by fixed amount, in pixels, +/- along the Y axis.  A positive value will shift the text down","default-value":0},"vertical-alignment":{css:"text-vertical-alignment",type:["top","middle","bottom","auto"],doc:"Position of label relative to point position.","default-value":"auto","default-meaning":'Default affected by value of dy; "bottom" for dy>0, "top" for dy<0.'},"avoid-edges":{css:"text-avoid-edges",doc:"Tell positioning algorithm to avoid labeling near intersection edges.","default-value":!1,type:"boolean"},"minimum-distance":{css:"text-min-distance",doc:"Minimum permitted distance to the next text symbolizer.",type:"float"},"minimum-padding":{css:"text-min-padding",doc:"Determines the minimum amount of padding that a text symbolizer gets relative to other text",type:"float"},"minimum-path-length":{css:"text-min-path-length",type:"float","default-value":0,"default-meaning":"place labels on all paths",doc:"Place labels only on paths longer than this value."},"allow-overlap":{css:"text-allow-overlap",type:"boolean","default-value":!1,doc:"Control whether overlapping text is shown or hidden.","default-meaning":"Do not allow text to overlap with other text - overlapping markers will not be shown."},orientation:{css:"text-orientation",type:"float",expression:!0,doc:"Rotate the text."},placement:{css:"text-placement",type:["point","line","vertex","interior"],"default-value":"point",doc:"Control the style of placement of a point versus the geometry it is attached to."},"placement-type":{css:"text-placement-type",doc:'Re-position and/or re-size text to avoid overlaps. "simple" for basic algorithm (using text-placements string,) "dummy" to turn this feature off.',type:["dummy","simple"],"default-value":"dummy"},placements:{css:"text-placements",type:"string","default-value":"",doc:'If "placement-type" is set to "simple", use this "POSITIONS,[SIZES]" string. An example is `text-placements: "E,NE,SE,W,NW,SW";` '},"text-transform":{css:"text-transform",type:["none","uppercase","lowercase","capitalize"],doc:"Transform the case of the characters","default-value":"none"},"horizontal-alignment":{css:"text-horizontal-alignment",type:["left","middle","right","auto"],doc:"The text's horizontal alignment from its centerpoint","default-value":"auto"},"justify-alignment":{css:"text-align",type:["left","right","center","auto"],doc:"Define how text is justified","default-value":"auto","default-meaning":"Auto alignment means that text will be centered by default except when using the `placement-type` parameter - in that case either right or left justification will be used automatically depending on where the text could be fit given the `text-placements` directives"},clip:{css:"text-clip",type:"boolean","default-value":!0,"default-meaning":"geometry will be clipped to map bounds before rendering",doc:"geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."},"comp-op":{css:"text-comp-op","default-value":"src-over","default-meaning":"add the current symbolizer on top of other symbolizer",doc:"Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",type:["clear","src","dst","src-over","dst-over","src-in","dst-in","src-out","dst-out","src-atop","dst-atop","xor","plus","minus","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","contrast","invert","invert-rgb","grain-merge","grain-extract","hue","saturation","color","value"]}},building:{fill:{css:"building-fill","default-value":"#FFFFFF",doc:"The color of the buildings walls.",type:"color"},"fill-opacity":{css:"building-fill-opacity",type:"float",doc:"The opacity of the building as a whole, including all walls.","default-value":1},height:{css:"building-height",doc:"The height of the building in pixels.",type:"float",expression:!0,"default-value":"0"}},torque:{"-torque-clear-color":{css:"-torque-clear-color",type:"color","default-value":"rgba(255, 255, 255, 0)","default-meaning":"full clear",doc:"color used to clear canvas on each frame"},"-torque-frame-count":{css:"-torque-frame-count","default-value":"128",type:"float","default-meaning":"the data is broken into 128 time frames",doc:"Number of animation steps/frames used in the animation. If the data contains a fewere number of total frames, the lesser value will be used."},"-torque-resolution":{css:"-torque-resolution","default-value":"2",type:"float","default-meaning":"",doc:"Spatial resolution in pixels. A resolution of 1 means no spatial aggregation of the data. Any other resolution of N results in spatial aggregation into cells of NxN pixels. The value N must be power of 2"},"-torque-animation-duration":{css:"-torque-animation-duration","default-value":"30",type:"float","default-meaning":"the animation lasts 30 seconds",doc:"Animation duration in seconds"},"-torque-aggregation-function":{css:"-torque-aggregation-function","default-value":"count(cartodb_id)",type:"string","default-meaning":"the value for each cell is the count of points in that cell",doc:"A function used to calculate a value from the aggregate data for each cell. See -torque-resolution"},"-torque-time-attribute":{css:"-torque-time-attribute","default-value":"time",type:"string","default-meaning":"the data column in your table that is of a time based type",doc:"The table column that contains the time information used create the animation"},"-torque-data-aggregation":{css:"-torque-data-aggregation","default-value":"linear",type:["linear","cumulative"],"default-meaning":"previous values are discarded",doc:"A linear animation will discard previous values while a cumulative animation will accumulate them until it restarts"}}},colors:{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50],transparent:[0,0,0,0]},filter:{value:["true","false","null","point","linestring","polygon","collection"]}};e.exports={version:{latest:i,"2.1.1":i}}},{}],59:[function(t,e,n){"undefined"!=typeof e&&(e.exports.find=function(t,e){for(var n,i=0;i<t.length;i++)if(n=e.call(t,t[i]))return n;return null})},{}],60:[function(t,e,n){(function(e){!function(n){var i=e._||t("underscore");n.Call=function(t,e,n){this.name=t,this.args=e,this.index=n},n.Call.prototype={is:"call",ev:function(t){for(var e=this.args.map(function(e){return e.ev(t)}),o=0;o<e.length;o++)if("undefined"===e[o].is)return{is:"undefined",value:"undefined"};if(this.name in n.functions){if(n.functions[this.name].length<=e.length){var r=n.functions[this.name].apply(n.functions,e);return null===r?(t.error({message:"incorrect arguments given to "+this.name+"()",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"}):r}return t.error({message:"incorrect number of arguments for "+this.name+"(). "+n.functions[this.name].length+" expected.",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"}}var s=n.Reference.mapnikFunctions[this.name];if(void 0===s){var a=i.pairs(n.Reference.mapnikFunctions),l=this.name,u=a.map(function(t){return[t[0],n.Reference.editDistance(l,t[0]),t[1]]}).sort(function(t,e){return t[1]-e[1]});return t.error({message:"unknown function "+this.name+"(), did you mean "+u[0][0]+"("+u[0][2]+")",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"}}return s===e.length||Array.isArray(s)&&i.include(s,e.length)||-1===s?(this.args=e,this):(t.error({message:"function "+this.name+"() takes "+s+" arguments and was given "+e.length,index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"})},toString:function(t,e){return this.args.length?this.name+"("+this.args.join(",")+")":this.name}}}(t("../tree"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tree":59,underscore:89}],61:[function(t,e,n){!function(t){t.Color=function(t,e){this.rgb=Array.isArray(t)?t.slice(0,3):6==t.length?t.match(/.{2}/g).map(function(t){return parseInt(t,16)}):t.split("").map(function(t){return parseInt(t+t,16)}),this.alpha="number"==typeof e?e:4===t.length?t[3]:1},t.Color.prototype={is:"color",ev:function(){return this},toString:function(){return this.alpha<1?"rgba("+this.rgb.map(function(t){return Math.round(t)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(t){return t=Math.round(t),t=(t>255?255:0>t?0:t).toString(16),1===t.length?"0"+t:t}).join("")},operate:function(e,n,i){var o=[];i instanceof t.Color||(i=i.toColor());for(var r=0;3>r;r++)o[r]=t.operate(n,this.rgb[r],i.rgb[r]);return new t.Color(o)},toHSL:function(){var t,e,n=this.rgb[0]/255,i=this.rgb[1]/255,o=this.rgb[2]/255,r=this.alpha,s=Math.max(n,i,o),a=Math.min(n,i,o),l=(s+a)/2,u=s-a;if(s===a)t=e=0;else{switch(e=l>.5?u/(2-s-a):u/(s+a),s){case n:t=(i-o)/u+(o>i?6:0);break;case i:t=(o-n)/u+2;break;case o:t=(n-i)/u+4}t/=6}return{h:360*t,s:e,l:l,a:r}}}}(t("../tree"))},{"../tree":59}],62:[function(t,e,n){!function(t){t.Comment=function(t,e){this.value=t,this.silent=!!e},t.Comment.prototype={toString:function(t){return"<!--"+this.value+"-->"},ev:function(){return this}}}(t("../tree"))},{"../tree":59}],63:[function(t,e,n){(function(e){!function(n){function i(t){function e(t){return t[1].toUpperCase()}return t.charAt(0).toUpperCase()+t.slice(1).replace(/\-./,e)+"Symbolizer"}function o(t){return t.sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}var r=t("assert"),s=e._||t("underscore");n.Definition=function(t,e){this.elements=t.elements,r.ok(t.filters instanceof n.Filterset),this.rules=e,this.ruleIndex={};for(var i=0;i<this.rules.length;i++)"zoom"in this.rules[i]&&(this.rules[i]=this.rules[i].clone()),this.rules[i].zoom=t.zoom,this.ruleIndex[this.rules[i].updateID()]=!0;this.filters=t.filters,this.zoom=t.zoom,this.frame_offset=t.frame_offset,this.attachment=t.attachment||"__default__",this.specificity=t.specificity()},n.Definition.prototype.toString=function(){for(var t=this.filters.toString(),e=0;e<this.rules.length;e++)t+="\n    "+this.rules[e];return t},n.Definition.prototype.clone=function(t){t&&r.ok(t instanceof n.Filterset);var e=Object.create(n.Definition.prototype);return e.rules=this.rules.slice(),e.ruleIndex=s.clone(this.ruleIndex),e.filters=t?t:this.filters.clone(),e.attachment=this.attachment,e},n.Definition.prototype.addRules=function(t){for(var e=0,n=0;n<t.length;n++)this.ruleIndex[t[n].id]||(this.rules.push(t[n]),this.ruleIndex[t[n].id]=!0,e++);return e},n.Definition.prototype.appliesTo=function(t,e){for(var n=0,i=this.elements.length;i>n;n++){var o=this.elements[n];if(!(o.wildcard||"class"===o.type&&e[o.clean]||"id"===o.type&&t===o.clean))return!1}return!0},n.Definition.prototype.symbolizersToXML=function(t,e,r){var s=r.toXML(t).join("")+this.filters.toXML(t),a=[],l=[];for(var u in e){l=[];for(var c in e[u])l.push(e[u][c].index);var h=Math.min.apply(Math,l);a.push([u,h])}a=o(a);for(var d=0,f=0;f<a.length;f++){var p=e[a[f]],m=a[f].split("/").pop();if("*"!==m){d++;var g=n.Reference.requiredProperties(m,p);if(g){var v=p[Object.keys(p).shift()];t.error({message:g,index:v.index,filename:v.filename})}var y,_=i(m),b=!0;s+="    <"+_+" ";for(var w in p){"map"===m&&t.error({message:"Map properties are not permitted in other rules",index:p[w].index,filename:p[w].filename});var x=n.Reference.selector(p[w].name);x&&x.serialization&&"content"===x.serialization?(b=!1,y=p[w].ev(t).toXML(t,!0)):x&&x.serialization&&"tag"===x.serialization?(b=!1,y=p[w].ev(t).toXML(t,!0)):s+=p[w].ev(t).toXML(t)+" "}b?s+="/>\n":"undefined"!=typeof y&&(s+=-1!=y.indexOf("<")?">"+y+"</"+_+">\n":"><![CDATA["+y+"]]></"+_+">\n")}}return d&&s?"  <Rule>\n"+s+"  </Rule>\n":""},n.Definition.prototype.collectSymbolizers=function(t,e){for(var n,i={},o=e;o<this.rules.length;o++){n=this.rules[o];var r=n.instance+"/"+n.symbolizer;!(t.current&n.zoom)||r in i&&n.name in i[r]||(t.current&=n.zoom,r in i||(i[r]={}),i[r][n.name]=n)}return Object.keys(i).length?(t.rule&=t.available&=~t.current,i):void 0},n.Definition.prototype.toXML=function(t,e){var i=this.filters.toString();i in e||(e[i]=n.Zoom.all);for(var o,r=n.Zoom.all,s="",a={available:n.Zoom.all},l=0;l<this.rules.length&&r;l++)if(a.rule=this.rules[l].zoom,e[i]&a.rule)for(;a.current=a.rule&r;)if(o=this.collectSymbolizers(a,l)){if(!(e[i]&a.current))continue;s+=this.symbolizersToXML(t,o,(new n.Zoom).setZoom(e[i]&a.current)),e[i]&=~a.current}return s},n.Definition.prototype.toJS=function(t){var e={},i="("+this.zoom+" & (1 << ctx.zoom))",o=this.frame_offset,r=this.filters.toJS(t),a=[i];return r&&a.push(r),o&&a.push('ctx["frame-offset"] === '+o),r=a.join(" && "),s.each(this.rules,function(i){if(!(i instanceof n.Rule))throw new Error("Ruleset not supported");e[i.name]=e[i.name]||[];var o={index:i.index,symbolizer:i.symbolizer};o.js=r?"if("+r+"){"+i.value.toJS(t)+"}":i.value.toJS(t),o.constant="field"!==i.value.ev(t).is,o.filtered=!!r,e[i.name].push(o)}),e}}(t("../tree"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tree":59,assert:14,underscore:89}],64:[function(t,e,n){(function(e){!function(n){var i=e._||t("underscore");n.Dimension=function(t,e,n){this.value=parseFloat(t),this.unit=e||null,this.index=n},n.Dimension.prototype={is:"float",physical_units:["m","cm","in","mm","pt","pc"],screen_units:["px","%"],all_units:["m","cm","in","mm","pt","pc","px","%"],densities:{m:.0254,mm:25.4,cm:2.54,pt:72,pc:6},ev:function(t){if(this.unit&&!i.contains(this.all_units,this.unit))return t.error({message:"Invalid unit: '"+this.unit+"'",index:this.index}),{is:"undefined",value:"undefined"};if(this.unit&&i.contains(this.physical_units,this.unit)){if(!t.ppi)return t.error({message:"ppi is not set, so metric units can't be used",index:this.index}),{is:"undefined",value:"undefined"};this.value=this.value/this.densities[this.unit]*t.ppi,this.unit="px"}return this},round:function(){return this.value=Math.round(this.value),this},toColor:function(){return new n.Color([this.value,this.value,this.value])},round:function(){return this.value=Math.round(this.value),this},toString:function(){return this.value.toString()},operate:function(t,e,i){return"%"===this.unit&&"%"!==i.unit?(t.error({message:"If two operands differ, the first must not be %",index:this.index}),{is:"undefined",value:"undefined"}):"%"!==this.unit&&"%"===i.unit?"*"===e||"/"===e||"%"===e?(t.error({message:"Percent values can only be added or subtracted from other values",index:this.index}),{is:"undefined",value:"undefined"}):new n.Dimension(n.operate(e,this.value,this.value*i.value*.01),this.unit):new n.Dimension(n.operate(e,this.value,i.value),this.unit||i.unit)}}}(t("../tree"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tree":59,underscore:89}],65:[function(t,e,n){!function(t){t.Element=function(t){this.value=t.trim(),"#"===this.value[0]&&(this.type="id",this.clean=this.value.replace(/^#/,"")),"."===this.value[0]&&(this.type="class",this.clean=this.value.replace(/^\./,"")),-1!==this.value.indexOf("*")&&(this.type="wildcard")},t.Element.prototype.specificity=function(){return["id"===this.type?1:0,"class"===this.type?1:0]},t.Element.prototype.toString=function(){return this.value}}(t("../tree"))},{"../tree":59}],66:[function(t,e,n){!function(t){t.Expression=function(t){this.value=t},t.Expression.prototype={is:"expression",ev:function(e){return this.value.length>1?new t.Expression(this.value.map(function(t){return t.ev(e)})):this.value[0].ev(e)},toString:function(t){return this.value.map(function(e){return e.toString(t)}).join(" ")}}}(t("../tree"))},{"../tree":59}],67:[function(t,e,n){!function(t){t.Field=function(t){this.value=t||""},t.Field.prototype={is:"field",toString:function(){return"["+this.value+"]"},ev:function(){return this}}}(t("../tree"))},{"../tree":59}],68:[function(t,e,n){!function(t){t.Filter=function(t,e,n,i,o){this.key=t,this.op=e,this.val=n,this.index=i,this.filename=o,this.id=this.key+this.op+this.val};var e={"<":[" &lt; ","numeric"],">":[" &gt; ","numeric"],"=":[" = ","both"],"!=":[" != ","both"],"<=":[" &lt;= ","numeric"],">=":[" &gt;= ","numeric"],"=~":[".match(","string",")"]};t.Filter.prototype.ev=function(t){return this.key=this.key.ev(t),this.val=this.val.ev(t),this},t.Filter.prototype.toXML=function(n){t.Reference.data.filter&&("keyword"===this.key.is&&-1===t.Reference.data.filter.value.indexOf(this.key.toString())&&n.error({message:this.key.toString()+" is not a valid keyword in a filter expression",index:this.index,filename:this.filename}),"keyword"===this.val.is&&-1===t.Reference.data.filter.value.indexOf(this.val.toString())&&n.error({message:this.val.toString()+" is not a valid keyword in a filter expression",index:this.index,filename:this.filename}));var i=this.key.toString(!1),o=this.val.toString("string"==this.val.is);return("numeric"==e[this.op][1]&&isNaN(o)&&"field"!==this.val.is||"string"==e[this.op][1]&&"'"!=o[0])&&n.error({message:'Cannot use operator "'+this.op+'" with value '+this.val,index:this.index,filename:this.filename}),i+e[this.op][0]+o+(e[this.op][2]||"")},t.Filter.prototype.toString=function(){return"["+this.id+"]"}}(t("../tree"))},{"../tree":59}],69:[function(t,e,n){(function(e){var n=t("../tree"),i=e._||t("underscore");n.Filterset=function(){this.filters={}},n.Filterset.prototype.toXML=function(t){var e=[];for(var n in this.filters)e.push("("+this.filters[n].toXML(t).trim()+")");return e.length?"    <Filter>"+e.join(" and ")+"</Filter>\n":""},n.Filterset.prototype.toString=function(){var t=[];for(var e in this.filters)t.push(this.filters[e].id);return t.sort().join("	")},n.Filterset.prototype.ev=function(t){for(var e in this.filters)this.filters[e].ev(t);return this},n.Filterset.prototype.clone=function(){var t=new n.Filterset;for(var e in this.filters)t.filters[e]=this.filters[e];return t},n.Filterset.prototype.cloneWith=function(t){var e=[];for(var i in t.filters){var o=this.addable(t.filters[i]);if(o===!1)return!1;o===!0&&e.push(t.filters[i])}if(!e.length)return null;var r=new n.Filterset;for(i in this.filters)r.filters[i]=this.filters[i];for(;i=e.shift();)r.add(i);return r},n.Filterset.prototype.toJS=function(t){var e={"=":"==="};return i.map(this.filters,function(t){var n=t.op;n in e&&(n=e[n]);var i=t.val;void 0!==t._val&&(i=t._val.toString(!0));var o="data";return o+"."+t.key.value+" "+n+" "+("string"===i.is?"'"+i+"'":i)}).join(" && ")},n.Filterset.prototype.addable=function(t){var e=t.key.toString(),n=t.val.toString();switch(n.match(/^[0-9]+(\.[0-9]*)?$/)&&(n=parseFloat(n)),t.op){case"=":return void 0!==this.filters[e+"="]?this.filters[e+"="].val.toString()!=n?!1:null:void 0!==this.filters[e+"!="+n]?!1:void 0!==this.filters[e+">"]&&this.filters[e+">"].val>=n?!1:void 0!==this.filters[e+"<"]&&this.filters[e+"<"].val<=n?!1:void 0!==this.filters[e+">="]&&this.filters[e+">="].val>n?!1:void 0!==this.filters[e+"<="]&&this.filters[e+"<="].val<n?!1:!0;case"=~":return!0;case"!=":return void 0!==this.filters[e+"="]?this.filters[e+"="].val==n?!1:null:void 0!==this.filters[e+"!="+n]?null:void 0!==this.filters[e+">"]&&this.filters[e+">"].val>=n?null:void 0!==this.filters[e+"<"]&&this.filters[e+"<"].val<=n?null:void 0!==this.filters[e+">="]&&this.filters[e+">="].val>n?null:void 0!==this.filters[e+"<="]&&this.filters[e+"<="].val<n?null:!0;case">":return e+"="in this.filters?this.filters[e+"="].val<=n?!1:null:void 0!==this.filters[e+"<"]&&this.filters[e+"<"].val<=n?!1:void 0!==this.filters[e+"<="]&&this.filters[e+"<="].val<=n?!1:void 0!==this.filters[e+">"]&&this.filters[e+">"].val>=n?null:void 0!==this.filters[e+">="]&&this.filters[e+">="].val>n?null:!0;case">=":return void 0!==this.filters[e+"="]?this.filters[e+"="].val<n?!1:null:void 0!==this.filters[e+"<"]&&this.filters[e+"<"].val<=n?!1:void 0!==this.filters[e+"<="]&&this.filters[e+"<="].val<n?!1:void 0!==this.filters[e+">"]&&this.filters[e+">"].val>=n?null:void 0!==this.filters[e+">="]&&this.filters[e+">="].val>=n?null:!0;case"<":return void 0!==this.filters[e+"="]?this.filters[e+"="].val>=n?!1:null:void 0!==this.filters[e+">"]&&this.filters[e+">"].val>=n?!1:void 0!==this.filters[e+">="]&&this.filters[e+">="].val>=n?!1:void 0!==this.filters[e+"<"]&&this.filters[e+"<"].val<=n?null:void 0!==this.filters[e+"<="]&&this.filters[e+"<="].val<n?null:!0;case"<=":return void 0!==this.filters[e+"="]?this.filters[e+"="].val>n?!1:null:void 0!==this.filters[e+">"]&&this.filters[e+">"].val>=n?!1:void 0!==this.filters[e+">="]&&this.filters[e+">="].val>n?!1:void 0!==this.filters[e+"<"]&&this.filters[e+"<"].val<=n?null:void 0!==this.filters[e+"<="]&&this.filters[e+"<="].val<=n?null:!0}},n.Filterset.prototype.conflict=function(t){var e=t.key.toString(),n=t.val.toString();return isNaN(parseFloat(n))||(n=parseFloat(n)),"="===t.op&&void 0!==this.filters[e+"="]&&n!=this.filters[e+"="].val.toString()||"!="===t.op&&void 0!==this.filters[e+"="]&&n==this.filters[e+"="].val.toString()||"="===t.op&&void 0!==this.filters[e+"!="]&&n==this.filters[e+"!="].val.toString()?t.toString()+" added to "+this.toString()+" produces an invalid filter":!1},n.Filterset.prototype.add=function(t,e){var n,i=t.key.toString(),o=t.op,r=this.conflict(t);if(r)return r;if("="===o){for(var s in this.filters)this.filters[s].key==i&&delete this.filters[s];this.filters[i+"="]=t}else if("!="===o)this.filters[i+"!="+t.val]=t;else if("=~"===o)this.filters[i+"=~"+t.val]=t;else if(">"===o){for(var a in this.filters)this.filters[a].key==i&&this.filters[a].val<=t.val&&delete this.filters[a];this.filters[i+">"]=t}else if(">="===o){for(var l in this.filters)n=+this.filters[l].val.toString(),this.filters[l].key==i&&n<t.val&&delete this.filters[l];void 0!==this.filters[i+"!="+t.val]?(delete this.filters[i+"!="+t.val],t.op=">",this.filters[i+">"]=t):this.filters[i+">="]=t}else if("<"===o){for(var u in this.filters)n=+this.filters[u].val.toString(),this.filters[u].key==i&&n>=t.val&&delete this.filters[u];this.filters[i+"<"]=t}else if("<="===o){for(var c in this.filters)n=+this.filters[c].val.toString(),this.filters[c].key==i&&n>t.val&&delete this.filters[c];void 0!==this.filters[i+"!="+t.val]?(delete this.filters[i+"!="+t.val],t.op="<",this.filters[i+"<"]=t):this.filters[i+"<="]=t}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tree":59,underscore:89}],70:[function(t,e,n){!function(t){t._getFontSet=function(e,n){var i=n.join("");if(e._fontMap&&e._fontMap[i])return e._fontMap[i];var o=new t.FontSet(e,n);return e.effects.push(o),e._fontMap||(e._fontMap={}),e._fontMap[i]=o,o},t.FontSet=function(t,e){this.fonts=e,this.name="fontset-"+t.effects.length},t.FontSet.prototype.toXML=function(t){return'<FontSet name="'+this.name+'">\n'+this.fonts.map(function(t){return'  <Font face-name="'+t+'"/>'}).join("\n")+"\n</FontSet>"}}(t("../tree"))},{"../tree":59}],71:[function(t,e,n){var i=t("../tree");i.FrameOffset=function(t,e,n){if(e=parseInt(e,10),e>i.FrameOffset.max||0>=e)throw{message:"Only frame-offset levels between 1 and "+i.FrameOffset.max+" supported.",index:n};if("="!==t)throw{message:"only = operator is supported for frame-offset",index:n};return e},i.FrameOffset.max=32,i.FrameOffset.none=0},{"../tree":59}],72:[function(t,e,n){!function(t){t.ImageFilter=function(t,e){this.filter=t,this.args=e||null},t.ImageFilter.prototype={is:"imagefilter",ev:function(){return this},toString:function(){return this.args?this.filter+"("+this.args.join(",")+")":this.filter}}}(t("../tree"))},{"../tree":59}],73:[function(t,e,n){!function(t){t.Invalid=function(t,e,n){this.chunk=t,this.index=e,this.type="syntax",this.message=n||"Invalid code: "+this.chunk},t.Invalid.prototype.is="invalid",t.Invalid.prototype.ev=function(t){return t.error({chunk:this.chunk,index:this.index,type:"syntax",message:this.message||"Invalid code: "+this.chunk}),{is:"undefined"}}}(t("../tree"))},{"../tree":59}],74:[function(t,e,n){!function(t){t.Keyword=function(t){this.value=t;var e={transparent:"color","true":"boolean","false":"boolean"};this.is=e[t]?e[t]:"keyword"},t.Keyword.prototype={ev:function(){return this},toString:function(){return this.value}}}(t("../tree"))},{"../tree":59}],75:[function(t,e,n){!function(t){t.LayerXML=function(e,n){var i=[];for(var o in e.Datasource)i.push('<Parameter name="'+o+'"><![CDATA['+e.Datasource[o]+"]]></Parameter>");var r="";for(var s in e.properties)r+="minzoom"===s?'  maxzoom="'+t.Zoom.ranges[e.properties[s]]+'"\n':"maxzoom"===s?'  minzoom="'+t.Zoom.ranges[e.properties[s]+1]+'"\n':"  "+s+'="'+e.properties[s]+'"\n';return'<Layer name="'+e.name+'"\n'+r+("undefined"==typeof e.status?"":'  status="'+e.status+'"\n')+("undefined"==typeof e.srs?"":'  srs="'+e.srs+'"')+">\n    "+n.reverse().map(function(t){return"<StyleName>"+t+"</StyleName>"}).join("\n    ")+(i.length?"\n    <Datasource>\n       "+i.join("\n       ")+"\n    </Datasource>\n":"")+"  </Layer>\n"}}(t("../tree"))},{"../tree":59}],76:[function(t,e,n){!function(t){t.Literal=function(t){this.value=t||"",this.is="field"},t.Literal.prototype={toString:function(){return this.value},ev:function(){return this}}}(t("../tree"))},{"../tree":59}],77:[function(t,e,n){!function(t){t.Operation=function(t,e,n){this.op=t.trim(),this.operands=e,this.index=n},t.Operation.prototype.is="operation",t.Operation.prototype.ev=function(e){var n,i=this.operands[0].ev(e),o=this.operands[1].ev(e);return"undefined"===i.is||"undefined"===o.is?{is:"undefined",value:"undefined"}:(i instanceof t.Dimension&&o instanceof t.Color&&("*"===this.op||"+"===this.op?(n=o,o=i,i=n):e.error({name:"OperationError",message:"Can't substract or divide a color from a number",index:this.index})),i instanceof t.Quoted&&o instanceof t.Quoted&&"+"!==this.op?(e.error({message:"Can't subtract, divide, or multiply strings.",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"}):i instanceof t.Field||o instanceof t.Field||i instanceof t.Literal||o instanceof t.Literal?"color"===i.is||"color"===o.is?(e.error({message:"Can't subtract, divide, or multiply colors in expressions.",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"}):new t.Literal(i.ev(e).toString(!0)+this.op+o.ev(e).toString(!0)):void 0===i.operate?(e.error({message:"Cannot do math with type "+i.is+".",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"}):i.operate(e,this.op,o))},t.operate=function(t,e,n){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"%":return e%n;case"/":return e/n}}}(t("../tree"))},{"../tree":59}],78:[function(t,e,n){!function(t){t.Quoted=function(t){this.value=t||""},t.Quoted.prototype={is:"string",toString:function(t){var e=this.value.replace(/&/g,"&amp;"),n=e.replace(/\'/g,"\\'").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/\>/g,"&gt;");return t===!0?"'"+n+"'":e},ev:function(){return this},operate:function(e,n,i){return new t.Quoted(t.operate(n,this.toString(),i.toString(this.contains_field)))}}}(t("../tree"))},{"../tree":59}],79:[function(t,e,n){(function(e){!function(n){function i(t){var e={};for(var n in t.symbolizers)for(var i in t.symbolizers[n])t.symbolizers[n][i].hasOwnProperty("css")&&(e[t.symbolizers[n][i].css]=[t.symbolizers[n][i],n,i]);return e}function o(t){var e={};for(var n in t.symbolizers)for(var i in t.symbolizers[n])if("functions"===t.symbolizers[n][i].type)for(var o=0;o<t.symbolizers[n][i].functions.length;o++){var r=t.symbolizers[n][i].functions[o];e[r[0]]=r[1]}return e}function r(t){var e={};for(var n in t.symbolizers){e[n]=[];for(var i in t.symbolizers[n])t.symbolizers[n][i].required&&e[n].push(t.symbolizers[n][i].css)}return e}function s(t,e){if("string"===t.value[0].is)return!0;for(var n in t.value)for(var i in t.value[n].value){if("call"!==t.value[n].value[i].is)return!1;var o=l.find(u.selector(e).functions,function(e){return e[0]==t.value[n].value[i].name});if(!(o&&-1==o[1]||o&&o[1]===t.value[n].value[i].args.length))return!1;

}return!0}function a(t,e){return"object"==typeof u.selector(e).type?-1!==u.selector(e).type.indexOf(t.value[0].value):"string"===u.selector(e).type}var l=e._||t("underscore"),u={};u.setData=function(t){u.data=t,u.selector_cache=i(t),u.mapnikFunctions=o(t),u.mapnikFunctions.matrix=[6],u.mapnikFunctions.translate=[1,2],u.mapnikFunctions.scale=[1,2],u.mapnikFunctions.rotate=[1,3],u.mapnikFunctions.skewX=[1],u.mapnikFunctions.skewY=[1],u.required_cache=r(t)},u.setVersion=function(e){var n=t("mapnik-reference");return n.version.hasOwnProperty(e)?(u.setData(n.version[e]),!0):!1},u.selectorData=function(t,e){return u.selector_cache[t]?u.selector_cache[t][e]:void 0},u.validSelector=function(t){return!!u.selector_cache[t]},u.selectorName=function(t){return u.selectorData(t,2)},u.selector=function(t){return u.selectorData(t,0)},u.symbolizer=function(t){return u.selectorData(t,1)},u.requiredProperties=function(t,e){var n=u.required_cache[t];for(var i in n)if(!(n[i]in e))return"Property "+n[i]+" required for defining "+t+" styles."},u._validateValue={font:function(t,e){return t.validation_data&&t.validation_data.fonts?-1!=t.validation_data.fonts.indexOf(e):!0}},u.isFont=function(t){return"font"==u.selector(t).validate},u.editDistance=function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;for(var n=[],i=0;i<=e.length;i++)n[i]=[i];for(var o=0;o<=t.length;o++)n[0][o]=o;for(i=1;i<=e.length;i++)for(o=1;o<=t.length;o++)n[i][o]=e.charAt(i-1)==t.charAt(o-1)?n[i-1][o-1]:Math.min(n[i-1][o-1]+1,Math.min(n[i][o-1]+1,n[i-1][o]+1));return n[e.length][t.length]},u.validValue=function(t,e,n){var i;if(u.selector(e)){if("keyword"==n.value[0].is)return a(n,e);if("undefined"==n.value[0].is)return!0;if("numbers"==u.selector(e).type){for(i in n.value)if("float"!==n.value[i].is)return!1;return!0}if("tags"==u.selector(e).type){if(!n.value)return!1;if(!n.value[0].value)return"tag"===n.value[0].is;for(i=0;i<n.value[0].value.length;i++)if("tag"!==n.value[0].value[i].is)return!1;return!0}if("functions"==u.selector(e).type)return s(n,e);if("unsigned"===u.selector(e).type)return"float"===n.value[0].is?(n.value[0].round(),!0):!1;if(u.selector(e).expression)return!0;if(u.selector(e).validate){var o=!1;for(i=0;i<n.value.length;i++)if(u.selector(e).type==n.value[i].is&&u._validateValue[u.selector(e).validate](t,n.value[i].value))return!0;return o}return u.selector(e).type==n.value[0].is}return!1},n.Reference=u}(t("../tree"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tree":59,"mapnik-reference":88,underscore:89}],80:[function(t,e,n){!function(t){function e(e){return Object.keys(t.Reference.selector_cache).map(function(n){return[n,t.Reference.editDistance(e,n)]}).sort(function(t,e){return t[1]-e[1]})}t.Rule=function(e,n,i,o){var r=e.split("/");this.name=r.pop(),this.instance=r.length?r[0]:"__default__",this.value=n instanceof t.Value?n:new t.Value([n]),this.index=i,this.symbolizer=t.Reference.symbolizer(this.name),this.filename=o,this.variable="@"===e.charAt(0)},t.Rule.prototype.is="rule",t.Rule.prototype.clone=function(){var e=Object.create(t.Rule.prototype);return e.name=this.name,e.value=this.value,e.index=this.index,e.instance=this.instance,e.symbolizer=this.symbolizer,e.filename=this.filename,e.variable=this.variable,e},t.Rule.prototype.updateID=function(){return this.id=this.zoom+"#"+this.instance+"#"+this.name},t.Rule.prototype.toString=function(){return"["+t.Zoom.toString(this.zoom)+"] "+this.name+": "+this.value},t.Rule.prototype.toXML=function(n,i,o,r){if(!t.Reference.validSelector(this.name)){var s=e(this.name),a="";return s[0][1]<3&&(a=". Did you mean "+s[0][0]+"?"),n.error({message:"Unrecognized rule: "+this.name+a,index:this.index,type:"syntax",filename:this.filename})}if(this.value instanceof t.Value&&!t.Reference.validValue(n,this.name,this.value)){if(t.Reference.selector(this.name)){var l;return l=t.Reference.selector(this.name).validate?t.Reference.selector(this.name).validate:"object"==typeof t.Reference.selector(this.name).type?"keyword (options: "+t.Reference.selector(this.name).type.join(", ")+")":t.Reference.selector(this.name).type,n.error({message:"Invalid value for "+this.name+", the type "+l+" is expected. "+this.value+" (of type "+this.value.value[0].is+")  was given.",index:this.index,type:"syntax",filename:this.filename})}return n.error({message:"Unrecognized property: "+this.name,index:this.index,type:"syntax",filename:this.filename})}if(this.variable)return"";if(t.Reference.isFont(this.name)&&this.value.value.length>1){var u=t._getFontSet(n,this.value.value);return'fontset-name="'+u.name+'"'}return i?this.value.toString(n,this.name,o):t.Reference.selectorName(this.name)+'="'+this.value.toString(n,this.name)+'"'},t.Rule.prototype.ev=function(e){return new t.Rule(this.name,this.value.ev(e),this.index,this.filename)}}(t("../tree"))},{"../tree":59}],81:[function(t,e,n){!function(t){t.Ruleset=function(t,e){this.selectors=t,this.rules=e,this._lookups={}},t.Ruleset.prototype={is:"ruleset",ev:function(e){var n,i=new t.Ruleset(this.selectors,this.rules.slice(0));for(i.root=this.root,e.frames.unshift(i),n=0,rule;n<i.rules.length;n++)rule=i.rules[n],i.rules[n]=rule.ev?rule.ev(e):rule;return e.frames.shift(),i},match:function(t){return!t||0===t.length},variables:function(){return this._variables?this._variables:this._variables=this.rules.reduce(function(e,n){return n instanceof t.Rule&&n.variable===!0&&(e[n.name]=n),e},{})},variable:function(t){return this.variables()[t]},rulesets:function(){return this._rulesets?this._rulesets:this._rulesets=this.rules.filter(function(e){return e instanceof t.Ruleset})},find:function(e,n){n=n||this;var i,o=[],r=e.toString();return r in this._lookups?this._lookups[r]:(this.rulesets().forEach(function(r){if(r!==n)for(var s=0;s<r.selectors.length;s++)if(i=e.match(r.selectors[s])){e.elements.length>1?Array.prototype.push.apply(o,r.find(new t.Selector(null,null,null,e.elements.slice(1)),n)):o.push(r);break}}),this._lookups[r]=o)},evZooms:function(e){for(var n=0;n<this.selectors.length;n++){for(var i=t.Zoom.all,o=0;o<this.selectors[n].zoom.length;o++)i&=this.selectors[n].zoom[o].ev(e).zoom;this.selectors[n].zoom=i}},flatten:function(e,n,i){var o,r,s=[];for(0===this.selectors.length&&(i.frames=i.frames.concat(this.rules)),this.evZooms(i),o=0;o<this.selectors.length;o++){var a=this.selectors[o];if(a.filters)if(n.length)for(r=0;r<n.length;r++){var l=n[r],u=l.filters.cloneWith(a.filters);if(null===u){if(l.zoom===(l.zoom&a.zoom)&&l.frame_offset===a.frame_offset&&l.attachment===a.attachment&&l.elements.join()===a.elements.join()){s.push(l);continue}u=l.filters}else if(!u)continue;var c=Object.create(t.Selector.prototype);c.filters=u,c.zoom=l.zoom&a.zoom,c.frame_offset=a.frame_offset,c.elements=l.elements.concat(a.elements),c.attachment=l.attachment&&a.attachment?l.attachment+"/"+a.attachment:a.attachment||l.attachment,c.conditions=l.conditions+a.conditions,c.index=a.index,s.push(c)}else s.push(a)}var h=[];for(o=0;o<this.rules.length;o++){var d=this.rules[o];d instanceof t.Ruleset?d.flatten(e,s,i):d instanceof t.Rule?h.push(d):d instanceof t.Invalid&&i.error(d)}var f=h.length?h[0].index:!1;for(o=0;o<s.length;o++)f!==!1&&(s[o].index=f),e.push(new t.Definition(s[o],h.slice()));return e}}}(t("../tree"))},{"../tree":59}],82:[function(t,e,n){!function(t){t.Selector=function(e,n,i,o,r,s,a){this.elements=o||[],this.attachment=r,this.filters=e||{},this.frame_offset=i,this.zoom="undefined"!=typeof n?n:t.Zoom.all,this.conditions=s,this.index=a},t.Selector.prototype.specificity=function(){return this.elements.reduce(function(t,e){var n=e.specificity();return t[0]+=n[0],t[1]+=n[1],t},[0,0,this.conditions,this.index])}}(t("../tree"))},{"../tree":59}],83:[function(t,e,n){(function(e){!function(n){var i=e._||t("underscore");n.StyleXML=function(t,e,n,o){for(var r={},s=[],a=[],l=[],u=[],c=[],h=0;h<n.length;h++)for(var d=0;d<n[h].rules.length;d++)"image-filters"===n[h].rules[d].name&&s.push(n[h].rules[d]),"image-filters-inflate"===n[h].rules[d].name&&a.push(n[h].rules[d]),"direct-image-filters"===n[h].rules[d].name&&l.push(n[h].rules[d]),"comp-op"===n[h].rules[d].name&&u.push(n[h].rules[d]),"opacity"===n[h].rules[d].name&&c.push(n[h].rules[d]);var f=n.map(function(t){return t.toXML(o,r)}),p="";s.length&&(p+=' image-filters="'+i.chain(s).uniq(function(t){return t.id}).map(function(t){return t.ev(o).toXML(o,!0,",","image-filter")}).value().join(",")+'"'),a.length&&(p+=' image-filters-inflate="'+a[0].value.ev(o).toString()+'"'),l.length&&(p+=' direct-image-filters="'+i.chain(l).uniq(function(t){return t.id}).map(function(t){return t.ev(o).toXML(o,!0,",","direct-image-filter")}).value().join(",")+'"'),u.length&&"src-over"!=u[0].value.ev(o).value&&(p+=' comp-op="'+u[0].value.ev(o).toString()+'"'),c.length&&1!=c[0].value.ev(o).value&&(p+=' opacity="'+c[0].value.ev(o).toString()+'"');var m=f.join("");return p||m?'<Style name="'+t+'" filter-mode="first"'+p+">\n"+m+"</Style>":""}}(t("../tree"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tree":59,underscore:89}],84:[function(t,e,n){!function(t){t.URL=function(t,e){this.value=t,this.paths=e},t.URL.prototype={is:"uri",toString:function(){return this.value.toString()},ev:function(e){return new t.URL(this.value.ev(e),this.paths)}}}(t("../tree"))},{"../tree":59}],85:[function(t,e,n){!function(t){t.Value=function(t){this.value=t},t.Value.prototype={is:"value",ev:function(e){return 1===this.value.length?this.value[0].ev(e):new t.Value(this.value.map(function(t){return t.ev(e)}))},toString:function(t,e,n,i){return this.value.map(function(e){return e.toString(t,i)}).join(n||", ")},clone:function(){var e=Object.create(t.Value.prototype);return e.value=Array.isArray(e)?this.value.slice():this.value,e.is=this.is,e},toJS:function(t){var e=this.ev(t),n=e.toString();return"color"===e.is||"uri"===e.is||"string"===e.is||"keyword"===e.is?n="'"+n+"'":"field"===e.is?n=n.replace(/\[(.*)\]/g,"data['$1']"):"call"===e.is&&(n=JSON.stringify({name:e.name,args:e.args})),"_value = "+n+";"}}}(t("../tree"))},{"../tree":59}],86:[function(t,e,n){!function(t){t.Variable=function(t,e,n){this.name=t,this.index=e,this.filename=n},t.Variable.prototype={is:"variable",toString:function(){return this.name},ev:function(t){this.name;if(this._css)return this._css;var e=t.frames.filter(function(t){return t.name==this.name}.bind(this));return e.length?e[0].value.ev(t):(t.error({message:"variable "+this.name+" is undefined",index:this.index,type:"runtime",filename:this.filename}),{is:"undefined",value:"undefined"})}}}(t("../tree"))},{"../tree":59}],87:[function(t,e,n){var i=t("../tree");i.Zoom=function(t,e,n){this.op=t,this.value=e,this.index=n},i.Zoom.prototype.setZoom=function(t){return this.zoom=t,this},i.Zoom.prototype.ev=function(t){var e=0,n=1/0,o=parseInt(this.value.ev(t).toString(),10),r=0;switch((o>i.Zoom.maxZoom||0>o)&&t.error({message:"Only zoom levels between 0 and "+i.Zoom.maxZoom+" supported.",index:this.index}),this.op){case"=":return this.zoom=1<<o,this;case">":e=o+1;break;case">=":e=o;break;case"<":n=o-1;break;case"<=":n=o}for(var s=0;s<=i.Zoom.maxZoom;s++)s>=e&&n>=s&&(r|=1<<s);return this.zoom=r,this},i.Zoom.prototype.toString=function(){return this.zoom},i.Zoom.all=8388607,i.Zoom.maxZoom=22,i.Zoom.ranges={0:1e9,1:5e8,2:2e8,3:1e8,4:5e7,5:25e6,6:125e5,7:65e5,8:3e6,9:15e5,10:75e4,11:4e5,12:2e5,13:1e5,14:5e4,15:25e3,16:12500,17:5e3,18:2500,19:1500,20:750,21:500,22:250,23:100},i.Zoom.prototype.toXML=function(){var t=[];if(this.zoom!=i.Zoom.all){for(var e=null,n=null,o=0;o<=i.Zoom.maxZoom;o++)this.zoom&1<<o&&(null===e&&(e=o),n=o);e>0&&t.push("    <MaxScaleDenominator>"+i.Zoom.ranges[e]+"</MaxScaleDenominator>\n"),22>n&&t.push("    <MinScaleDenominator>"+i.Zoom.ranges[n+1]+"</MinScaleDenominator>\n")}return t},i.Zoom.prototype.toString=function(){for(var t="",e=0;e<=i.Zoom.maxZoom;e++)t+=this.zoom&1<<e?"X":".";return t}},{"../tree":59}],88:[function(t,e,n){(function(n){var i=(t("fs"),t("path")),o=t("fs").existsSync||t("path").existsSync;e.exports.version={};var r=["2.0.0","2.0.1","2.0.2","2.1.0","2.1.1","2.2.0","2.3.0","3.0.0"];r.map(function(r){e.exports.version[r]=t(i.join(n,r,"reference.json"));var s=i.join(n,r,"datasources.json");o(s)&&(e.exports.version[r].datasources=t(s).datasources)})}).call(this,"/node_modules/torque.js/node_modules/carto/node_modules/mapnik-reference")},{fs:13,path:16}],89:[function(t,e,n){(function(){var t=this,i=t._,o={},r=Array.prototype,s=Object.prototype,a=Function.prototype,l=r.push,u=r.slice,c=r.concat,h=s.toString,d=s.hasOwnProperty,f=r.forEach,p=r.map,m=r.reduce,g=r.reduceRight,v=r.filter,y=r.every,_=r.some,b=r.indexOf,w=r.lastIndexOf,x=Array.isArray,L=Object.keys,T=a.bind,S=function(t){return t instanceof S?t:this instanceof S?void(this._wrapped=t):new S(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=S),n._=S):t._=S,S.VERSION="1.6.0";var k=S.each=S.forEach=function(t,e,n){if(null==t)return t;if(f&&t.forEach===f)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;r>i;i++)if(e.call(n,t[i],i,t)===o)return}else for(var s=S.keys(t),i=0,r=s.length;r>i;i++)if(e.call(n,t[s[i]],s[i],t)===o)return;return t};S.map=S.collect=function(t,e,n){var i=[];return null==t?i:p&&t.map===p?t.map(e,n):(k(t,function(t,o,r){i.push(e.call(n,t,o,r))}),i)};var P="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),m&&t.reduce===m)return i&&(e=S.bind(e,i)),o?t.reduce(e,n):t.reduce(e);if(k(t,function(t,r,s){o?n=e.call(i,n,t,r,s):(n=t,o=!0)}),!o)throw new TypeError(P);return n},S.reduceRight=S.foldr=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return i&&(e=S.bind(e,i)),o?t.reduceRight(e,n):t.reduceRight(e);var r=t.length;if(r!==+r){var s=S.keys(t);r=s.length}if(k(t,function(a,l,u){l=s?s[--r]:--r,o?n=e.call(i,n,t[l],l,u):(n=t[l],o=!0)}),!o)throw new TypeError(P);return n},S.find=S.detect=function(t,e,n){var i;return C(t,function(t,o,r){return e.call(n,t,o,r)?(i=t,!0):void 0}),i},S.filter=S.select=function(t,e,n){var i=[];return null==t?i:v&&t.filter===v?t.filter(e,n):(k(t,function(t,o,r){e.call(n,t,o,r)&&i.push(t)}),i)},S.reject=function(t,e,n){return S.filter(t,function(t,i,o){return!e.call(n,t,i,o)},n)},S.every=S.all=function(t,e,n){e||(e=S.identity);var i=!0;return null==t?i:y&&t.every===y?t.every(e,n):(k(t,function(t,r,s){return(i=i&&e.call(n,t,r,s))?void 0:o}),!!i)};var C=S.some=S.any=function(t,e,n){e||(e=S.identity);var i=!1;return null==t?i:_&&t.some===_?t.some(e,n):(k(t,function(t,r,s){return i||(i=e.call(n,t,r,s))?o:void 0}),!!i)};S.contains=S.include=function(t,e){return null==t?!1:b&&t.indexOf===b?-1!=t.indexOf(e):C(t,function(t){return t===e})},S.invoke=function(t,e){var n=u.call(arguments,2),i=S.isFunction(e);return S.map(t,function(t){return(i?e:t[e]).apply(t,n)})},S.pluck=function(t,e){return S.map(t,S.property(e))},S.where=function(t,e){return S.filter(t,S.matches(e))},S.findWhere=function(t,e){return S.find(t,S.matches(e))},S.max=function(t,e,n){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-(1/0),o=-(1/0);return k(t,function(t,r,s){var a=e?e.call(n,t,r,s):t;a>o&&(i=t,o=a)}),i},S.min=function(t,e,n){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,o=1/0;return k(t,function(t,r,s){var a=e?e.call(n,t,r,s):t;o>a&&(i=t,o=a)}),i},S.shuffle=function(t){var e,n=0,i=[];return k(t,function(t){e=S.random(n++),i[n-1]=i[e],i[e]=t}),i},S.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=S.values(t)),t[S.random(t.length-1)]):S.shuffle(t).slice(0,Math.max(0,e))};var E=function(t){return null==t?S.identity:S.isFunction(t)?t:S.property(t)};S.sortBy=function(t,e,n){return e=E(e),S.pluck(S.map(t,function(t,i,o){return{value:t,index:i,criteria:e.call(n,t,i,o)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var D=function(t){return function(e,n,i){var o={};return n=E(n),k(e,function(r,s){var a=n.call(i,r,s,e);t(o,a,r)}),o}};S.groupBy=D(function(t,e,n){S.has(t,e)?t[e].push(n):t[e]=[n]}),S.indexBy=D(function(t,e,n){t[e]=n}),S.countBy=D(function(t,e){S.has(t,e)?t[e]++:t[e]=1}),S.sortedIndex=function(t,e,n,i){n=E(n);for(var o=n.call(i,e),r=0,s=t.length;s>r;){var a=r+s>>>1;n.call(i,t[a])<o?r=a+1:s=a}return r},S.toArray=function(t){return t?S.isArray(t)?u.call(t):t.length===+t.length?S.map(t,S.identity):S.values(t):[]},S.size=function(t){return null==t?0:t.length===+t.length?t.length:S.keys(t).length},S.first=S.head=S.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:u.call(t,0,e)},S.initial=function(t,e,n){return u.call(t,0,t.length-(null==e||n?1:e))},S.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:u.call(t,Math.max(t.length-e,0))},S.rest=S.tail=S.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},S.compact=function(t){return S.filter(t,S.identity)};var M=function(t,e,n){return e&&S.every(t,S.isArray)?c.apply(n,t):(k(t,function(t){S.isArray(t)||S.isArguments(t)?e?l.apply(n,t):M(t,e,n):n.push(t)}),n)};S.flatten=function(t,e){return M(t,e,[])},S.without=function(t){return S.difference(t,u.call(arguments,1))},S.partition=function(t,e){var n=[],i=[];return k(t,function(t){(e(t)?n:i).push(t)}),[n,i]},S.uniq=S.unique=function(t,e,n,i){S.isFunction(e)&&(i=n,n=e,e=!1);var o=n?S.map(t,n,i):t,r=[],s=[];return k(o,function(n,i){(e?i&&s[s.length-1]===n:S.contains(s,n))||(s.push(n),r.push(t[i]))}),r},S.union=function(){return S.uniq(S.flatten(arguments,!0))},S.intersection=function(t){var e=u.call(arguments,1);return S.filter(S.uniq(t),function(t){return S.every(e,function(e){return S.contains(e,t)})})},S.difference=function(t){var e=c.apply(r,u.call(arguments,1));return S.filter(t,function(t){return!S.contains(e,t)})},S.zip=function(){for(var t=S.max(S.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=S.pluck(arguments,""+n);return e},S.object=function(t,e){if(null==t)return{};for(var n={},i=0,o=t.length;o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},S.indexOf=function(t,e,n){if(null==t)return-1;var i=0,o=t.length;if(n){if("number"!=typeof n)return i=S.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,o+n):n}if(b&&t.indexOf===b)return t.indexOf(e,n);for(;o>i;i++)if(t[i]===e)return i;return-1},S.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(w&&t.lastIndexOf===w)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var o=i?n:t.length;o--;)if(t[o]===e)return o;return-1},S.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=0,r=new Array(i);i>o;)r[o++]=t,t+=n;return r};var A=function(){};S.bind=function(t,e){var n,i;if(T&&t.bind===T)return T.apply(t,u.call(arguments,1));if(!S.isFunction(t))throw new TypeError;return n=u.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(u.call(arguments)));A.prototype=t.prototype;var o=new A;A.prototype=null;var r=t.apply(o,n.concat(u.call(arguments)));return Object(r)===r?r:o}},S.partial=function(t){var e=u.call(arguments,1);return function(){for(var n=0,i=e.slice(),o=0,r=i.length;r>o;o++)i[o]===S&&(i[o]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},S.bindAll=function(t){var e=u.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return k(e,function(e){t[e]=S.bind(t[e],t)}),t},S.memoize=function(t,e){var n={};return e||(e=S.identity),function(){var i=e.apply(this,arguments);return S.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},S.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},S.defer=function(t){return S.delay.apply(S,[t,1].concat(u.call(arguments,1)))},S.throttle=function(t,e,n){var i,o,r,s=null,a=0;n||(n={});var l=function(){a=n.leading===!1?0:S.now(),s=null,r=t.apply(i,o),i=o=null};return function(){var u=S.now();a||n.leading!==!1||(a=u);var c=e-(u-a);return i=this,o=arguments,0>=c?(clearTimeout(s),s=null,a=u,r=t.apply(i,o),i=o=null):s||n.trailing===!1||(s=setTimeout(l,c)),r}},S.debounce=function(t,e,n){var i,o,r,s,a,l=function(){var u=S.now()-s;e>u?i=setTimeout(l,e-u):(i=null,n||(a=t.apply(r,o),r=o=null))};return function(){r=this,o=arguments,s=S.now();var u=n&&!i;return i||(i=setTimeout(l,e)),u&&(a=t.apply(r,o),r=o=null),a}},S.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},S.wrap=function(t,e){return S.partial(e,t)},S.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},S.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},S.keys=function(t){if(!S.isObject(t))return[];if(L)return L(t);var e=[];for(var n in t)S.has(t,n)&&e.push(n);return e},S.values=function(t){for(var e=S.keys(t),n=e.length,i=new Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},S.pairs=function(t){for(var e=S.keys(t),n=e.length,i=new Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},S.invert=function(t){for(var e={},n=S.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},S.functions=S.methods=function(t){var e=[];for(var n in t)S.isFunction(t[n])&&e.push(n);return e.sort()},S.extend=function(t){return k(u.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},S.pick=function(t){var e={},n=c.apply(r,u.call(arguments,1));return k(n,function(n){n in t&&(e[n]=t[n])}),e},S.omit=function(t){var e={},n=c.apply(r,u.call(arguments,1));for(var i in t)S.contains(n,i)||(e[i]=t[i]);return e},S.defaults=function(t){return k(u.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},S.clone=function(t){return S.isObject(t)?S.isArray(t)?t.slice():S.extend({},t):t},S.tap=function(t,e){return e(t),t};var z=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof S&&(t=t._wrapped),e instanceof S&&(e=e._wrapped);var o=h.call(t);if(o!=h.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]==t)return i[r]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!(S.isFunction(s)&&s instanceof s&&S.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var l=0,u=!0;if("[object Array]"==o){if(l=t.length,u=l==e.length)for(;l--&&(u=z(t[l],e[l],n,i)););}else{for(var c in t)if(S.has(t,c)&&(l++,!(u=S.has(e,c)&&z(t[c],e[c],n,i))))break;if(u){for(c in e)if(S.has(e,c)&&!l--)break;u=!l}}return n.pop(),i.pop(),u};S.isEqual=function(t,e){return z(t,e,[],[])},S.isEmpty=function(t){if(null==t)return!0;if(S.isArray(t)||S.isString(t))return 0===t.length;for(var e in t)if(S.has(t,e))return!1;return!0},S.isElement=function(t){return!(!t||1!==t.nodeType)},S.isArray=x||function(t){return"[object Array]"==h.call(t)},S.isObject=function(t){return t===Object(t)},k(["Arguments","Function","String","Number","Date","RegExp"],function(t){S["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),S.isArguments(arguments)||(S.isArguments=function(t){return!(!t||!S.has(t,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(t){return"function"==typeof t}),S.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},S.isNaN=function(t){return S.isNumber(t)&&t!=+t},S.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==h.call(t)},S.isNull=function(t){return null===t},S.isUndefined=function(t){return void 0===t},S.has=function(t,e){return d.call(t,e)},S.noConflict=function(){return t._=i,this},S.identity=function(t){return t},S.constant=function(t){return function(){return t}},S.property=function(t){return function(e){return e[t]}},S.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},S.times=function(t,e,n){for(var i=Array(Math.max(0,t)),o=0;t>o;o++)i[o]=e.call(n,o);return i},S.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},S.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=S.invert(I.escape);var O={escape:new RegExp("["+S.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(I.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(t){S[t]=function(e){return null==e?"":(""+e).replace(O[t],function(e){return I[t][e]})}}),S.result=function(t,e){if(null==t)return void 0;var n=t[e];return S.isFunction(n)?n.call(t):n},S.mixin=function(t){k(S.functions(t),function(e){var n=S[e]=t[e];S.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),F.call(this,n.apply(S,t))}})};var N=0;S.uniqueId=function(t){var e=++N+"";return t?t+e:e},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(t,e,n){var i;n=S.defaults({},n,S.templateSettings);var o=new RegExp([(n.escape||R).source,(n.interpolate||R).source,(n.evaluate||R).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(o,function(e,n,i,o,a){return s+=t.slice(r,a).replace(q,function(t){return"\\"+j[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(e)return i(e,S);var l=function(t){return i.call(this,t,S)};return l.source="function("+(n.variable||"obj")+"){\n"+s+"}",l},S.chain=function(t){return S(t).chain()};var F=function(t){return this._chain?S(t).chain():t};S.mixin(S),k(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];S.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],F.call(this,n)}}),k(["concat","join","slice"],function(t){var e=r[t];S.prototype[t]=function(){return F.call(this,e.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return S})}).call(this)},{}],90:[function(t,e,n){e.exports={name:"carto",version:"0.15.1-cdb1",description:"CartoCSS Stylesheet Compiler",url:"https://github.com/cartodb/carto",repository:{type:"git",url:"git+ssh://git@github.com/cartodb/carto.git"},author:{name:"CartoDB",url:"http://cartodb.com/"},keywords:["maps","css","stylesheets"],contributors:[{name:"Tom MacWright",email:"macwright@gmail.com"},{name:"Konstantin K√§fer"},{name:"Alexis Sellier",email:"self@cloudhead.net"},{name:"Raul Ochoa",email:"rochoa@cartodb.com"},{name:"Javi Santana",email:"jsantana@cartodb.com"}],licenses:[{type:"Apache"}],bin:{carto:"./bin/carto"},man:["./man/carto.1"],main:"./lib/carto/index",engines:{node:">=0.4.x"},dependencies:{underscore:"~1.6.0","mapnik-reference":"~6.0.2",optimist:"~0.6.0"},devDependencies:{mocha:"1.12.x",jshint:"0.2.x",sax:"0.1.x",istanbul:"~0.2.14",coveralls:"~2.10.1",browserify:"~7.0.0","uglify-js":"1.3.3"},scripts:{pretest:"npm install",test:"mocha -R spec",coverage:"istanbul cover ./node_modules/.bin/_mocha && coveralls < ./coverage/lcov.info"},readme:"# CartoCSS\n\n[![Build Status](https://secure.travis-ci.org/mapbox/carto.png)](http://travis-ci.org/mapbox/carto)\n\nIs as stylesheet renderer for javascript, It's an evolution of the Mapnik renderer from Mapbox.\nPlease, see original [Mapbox repo](http://github.com/mapbox/carto) for more information and credits\n\n## Quick Start\n\n```javascript\n// shader is a CartoCSS object\n\nvar cartocss = [\n    '#layer {',\n    ' marker-width: [property]',\n    ' marker-fill: red',\n    '}'\n].join('')\nvar shader = new carto.RendererJS().render(cartocss);\nvar layers = shader.getLayers()\nfor (var i = 0; i < layers.length; ++i) {\n    var layer = layers[i];\n    console.log(\"layer name: \", layer.fullName())\n    console.log(\"- frames: \", layer.frames())\n    console.log(\"- attachment: \", layer.attachment())\n\n    var layerShader = layer.getStyle({ property: 1 }, { zoom: 10 })\n    console.log(layerShader['marker-width']) // 1\n    console.log(layerShader['marker-fill']) // #FF0000\n}\n\n```\n\n# API\n\n## RendererJS\n\n### render(cartocss)\n\n## CartoCSS\n\ncompiled cartocss object\n\n### getLayers\n\nreturn the layers, an array of ``CartoCSS.Layer`` object\n\n### getDefault\n\nreturn the default layer (``CartoCSS.Layer``), usually the Map layer\n\n\n### findLayer(where)\n\nfind a layer using where object.\n\n```\nshader.findLayer({ name: 'test' })\n```\n\n## CartoCSS.Layer\n\n### getStyle(props, context)\n\nreturn the evaluated style:\n    - props: object containing properties needed to render the style. If the cartocss style uses\n      some variables they should be passed in this object\n    - context: rendering context variables like ``zoom`` or animation ``frame``\n\n\n\n\n\n\n\n\n\n\n## Reference Documentation\n\n* [mapbox.com/carto](http://mapbox.com/carto/)\n\n\n",readmeFilename:"README.md",bugs:{url:"https://github.com/cartodb/carto/issues"},homepage:"https://github.com/cartodb/carto#readme",_id:"carto@0.15.1-cdb1",_shasum:"62534c2975cbee073f10c6c14a0c7e889c9469e7",_resolved:"https://github.com/CartoDB/carto/archive/master.tar.gz",_from:"https://github.com/CartoDB/carto/archive/master.tar.gz"}},{}],91:[function(t,e,n){var i=t("turf-meta").coordEach,o=t("turf-point");e.exports=function(t){var e=0,n=0,r=0;return i(t,function(t){e+=t[0],n+=t[1],r++},!0),o([e/r,n/r])}},{"turf-meta":92,"turf-point":93}],92:[function(t,e,n){function i(t,e,n){var i,o,r,s,a,u,c,h,d,f=0,p="FeatureCollection"===t.type,m="Feature"===t.type,g=p?t.features.length:1;for(i=0;g>i;i++)for(h=p?t.features[i].geometry:m?t.geometry:t,d="GeometryCollection"===h.type,u=d?h.geometries.length:1,s=0;u>s;s++)if(a=d?h.geometries[s]:h,c=a.coordinates,f=!n||"Polygon"!==a.type&&"MultiPolygon"!==a.type?0:1,"Point"===a.type)e(c);else if("LineString"===a.type||"MultiPoint"===a.type)for(o=0;o<c.length;o++)e(c[o]);else if("Polygon"===a.type||"MultiLineString"===a.type)for(o=0;o<c.length;o++)for(r=0;r<c[o].length-f;r++)e(c[o][r]);else{if("MultiPolygon"!==a.type)throw new Error("Unknown Geometry Type");for(o=0;o<c.length;o++)for(r=0;r<c[o].length;r++)for(l=0;l<c[o][r].length-f;l++)e(c[o][r][l])}}function o(t,e,n,o){return i(t,function(t){n=e(n,t)},o),n}function r(t,e){var n;switch(t.type){case"FeatureCollection":for(features=t.features,n=0;n<t.features.length;n++)e(t.features[n].properties);break;case"Feature":e(t.properties)}}function s(t,e,n){return r(t,function(t){n=e(n,t)}),n}e.exports.coordEach=i,e.exports.coordReduce=o,e.exports.propEach=r,e.exports.propReduce=s},{}],93:[function(t,e,n){var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.exports=function(t,e){if(!i(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:e||{}}}},{}],94:[function(t,e,n){e.exports=function(t,e){if(null===t)throw new Error("No coordinates passed");for(var n=0;n<t.length;n++)for(var i=t[n],o=0;o<i[i.length-1].length;o++){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");

if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}var r={type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:e};return r.properties||(r.properties={}),r}},{}],95:[function(t,e,n){(function(){function t(t){function e(e,n,i,o,r,s){for(;r>=0&&s>r;r+=t){var a=o?o[r]:r;i=n(i,e[a],a,e)}return i}return function(n,i,o,r){i=w(i,r,4);var s=!C(n)&&b.keys(n),a=(s||n).length,l=t>0?0:a-1;return arguments.length<3&&(o=n[s?s[l]:l],l+=t),e(n,i,o,s,l,a)}}function i(t){return function(e,n,i){n=x(n,i);for(var o=P(e),r=t>0?0:o-1;r>=0&&o>r;r+=t)if(n(e[r],r,e))return r;return-1}}function o(t,e,n){return function(i,o,r){var s=0,a=P(i);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(n&&r&&a)return r=n(i,o),i[r]===o?r:-1;if(o!==o)return r=e(d.call(i,s,a),b.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&a>r;r+=t)if(i[r]===o)return r;return-1}}function r(t,e){var n=z.length,i=t.constructor,o=b.isFunction(i)&&i.prototype||u,r="constructor";for(b.has(t,r)&&!b.contains(e,r)&&e.push(r);n--;)r=z[n],r in t&&t[r]!==o[r]&&!b.contains(e,r)&&e.push(r)}var s=this,a=s._,l=Array.prototype,u=Object.prototype,c=Function.prototype,h=l.push,d=l.slice,f=u.toString,p=u.hasOwnProperty,m=Array.isArray,g=Object.keys,v=c.bind,y=Object.create,_=function(){},b=function(t){return t instanceof b?t:this instanceof b?void(this._wrapped=t):new b(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=b),n._=b):s._=b,b.VERSION="1.8.3";var w=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)};case 4:return function(n,i,o,r){return t.call(e,n,i,o,r)}}return function(){return t.apply(e,arguments)}},x=function(t,e,n){return null==t?b.identity:b.isFunction(t)?w(t,e,n):b.isObject(t)?b.matcher(t):b.property(t)};b.iteratee=function(t,e){return x(t,e,1/0)};var L=function(t,e){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var o=1;i>o;o++)for(var r=arguments[o],s=t(r),a=s.length,l=0;a>l;l++){var u=s[l];e&&void 0!==n[u]||(n[u]=r[u])}return n}},T=function(t){if(!b.isObject(t))return{};if(y)return y(t);_.prototype=t;var e=new _;return _.prototype=null,e},S=function(t){return function(e){return null==e?void 0:e[t]}},k=Math.pow(2,53)-1,P=S("length"),C=function(t){var e=P(t);return"number"==typeof e&&e>=0&&k>=e};b.each=b.forEach=function(t,e,n){e=w(e,n);var i,o;if(C(t))for(i=0,o=t.length;o>i;i++)e(t[i],i,t);else{var r=b.keys(t);for(i=0,o=r.length;o>i;i++)e(t[r[i]],r[i],t)}return t},b.map=b.collect=function(t,e,n){e=x(e,n);for(var i=!C(t)&&b.keys(t),o=(i||t).length,r=Array(o),s=0;o>s;s++){var a=i?i[s]:s;r[s]=e(t[a],a,t)}return r},b.reduce=b.foldl=b.inject=t(1),b.reduceRight=b.foldr=t(-1),b.find=b.detect=function(t,e,n){var i;return i=C(t)?b.findIndex(t,e,n):b.findKey(t,e,n),void 0!==i&&-1!==i?t[i]:void 0},b.filter=b.select=function(t,e,n){var i=[];return e=x(e,n),b.each(t,function(t,n,o){e(t,n,o)&&i.push(t)}),i},b.reject=function(t,e,n){return b.filter(t,b.negate(x(e)),n)},b.every=b.all=function(t,e,n){e=x(e,n);for(var i=!C(t)&&b.keys(t),o=(i||t).length,r=0;o>r;r++){var s=i?i[r]:r;if(!e(t[s],s,t))return!1}return!0},b.some=b.any=function(t,e,n){e=x(e,n);for(var i=!C(t)&&b.keys(t),o=(i||t).length,r=0;o>r;r++){var s=i?i[r]:r;if(e(t[s],s,t))return!0}return!1},b.contains=b.includes=b.include=function(t,e,n,i){return C(t)||(t=b.values(t)),("number"!=typeof n||i)&&(n=0),b.indexOf(t,e,n)>=0},b.invoke=function(t,e){var n=d.call(arguments,2),i=b.isFunction(e);return b.map(t,function(t){var o=i?e:t[e];return null==o?o:o.apply(t,n)})},b.pluck=function(t,e){return b.map(t,b.property(e))},b.where=function(t,e){return b.filter(t,b.matcher(e))},b.findWhere=function(t,e){return b.find(t,b.matcher(e))},b.max=function(t,e,n){var i,o,r=-(1/0),s=-(1/0);if(null==e&&null!=t){t=C(t)?t:b.values(t);for(var a=0,l=t.length;l>a;a++)i=t[a],i>r&&(r=i)}else e=x(e,n),b.each(t,function(t,n,i){o=e(t,n,i),(o>s||o===-(1/0)&&r===-(1/0))&&(r=t,s=o)});return r},b.min=function(t,e,n){var i,o,r=1/0,s=1/0;if(null==e&&null!=t){t=C(t)?t:b.values(t);for(var a=0,l=t.length;l>a;a++)i=t[a],r>i&&(r=i)}else e=x(e,n),b.each(t,function(t,n,i){o=e(t,n,i),(s>o||o===1/0&&r===1/0)&&(r=t,s=o)});return r},b.shuffle=function(t){for(var e,n=C(t)?t:b.values(t),i=n.length,o=Array(i),r=0;i>r;r++)e=b.random(0,r),e!==r&&(o[r]=o[e]),o[e]=n[r];return o},b.sample=function(t,e,n){return null==e||n?(C(t)||(t=b.values(t)),t[b.random(t.length-1)]):b.shuffle(t).slice(0,Math.max(0,e))},b.sortBy=function(t,e,n){return e=x(e,n),b.pluck(b.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,n,i){var o={};return n=x(n,i),b.each(e,function(i,r){var s=n(i,r,e);t(o,i,s)}),o}};b.groupBy=E(function(t,e,n){b.has(t,n)?t[n].push(e):t[n]=[e]}),b.indexBy=E(function(t,e,n){t[n]=e}),b.countBy=E(function(t,e,n){b.has(t,n)?t[n]++:t[n]=1}),b.toArray=function(t){return t?b.isArray(t)?d.call(t):C(t)?b.map(t,b.identity):b.values(t):[]},b.size=function(t){return null==t?0:C(t)?t.length:b.keys(t).length},b.partition=function(t,e,n){e=x(e,n);var i=[],o=[];return b.each(t,function(t,n,r){(e(t,n,r)?i:o).push(t)}),[i,o]},b.first=b.head=b.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:b.initial(t,t.length-e)},b.initial=function(t,e,n){return d.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},b.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:b.rest(t,Math.max(0,t.length-e))},b.rest=b.tail=b.drop=function(t,e,n){return d.call(t,null==e||n?1:e)},b.compact=function(t){return b.filter(t,b.identity)};var D=function(t,e,n,i){for(var o=[],r=0,s=i||0,a=P(t);a>s;s++){var l=t[s];if(C(l)&&(b.isArray(l)||b.isArguments(l))){e||(l=D(l,e,n));var u=0,c=l.length;for(o.length+=c;c>u;)o[r++]=l[u++]}else n||(o[r++]=l)}return o};b.flatten=function(t,e){return D(t,e,!1)},b.without=function(t){return b.difference(t,d.call(arguments,1))},b.uniq=b.unique=function(t,e,n,i){b.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=x(n,i));for(var o=[],r=[],s=0,a=P(t);a>s;s++){var l=t[s],u=n?n(l,s,t):l;e?(s&&r===u||o.push(l),r=u):n?b.contains(r,u)||(r.push(u),o.push(l)):b.contains(o,l)||o.push(l)}return o},b.union=function(){return b.uniq(D(arguments,!0,!0))},b.intersection=function(t){for(var e=[],n=arguments.length,i=0,o=P(t);o>i;i++){var r=t[i];if(!b.contains(e,r)){for(var s=1;n>s&&b.contains(arguments[s],r);s++);s===n&&e.push(r)}}return e},b.difference=function(t){var e=D(arguments,!0,!0,1);return b.filter(t,function(t){return!b.contains(e,t)})},b.zip=function(){return b.unzip(arguments)},b.unzip=function(t){for(var e=t&&b.max(t,P).length||0,n=Array(e),i=0;e>i;i++)n[i]=b.pluck(t,i);return n},b.object=function(t,e){for(var n={},i=0,o=P(t);o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},b.findIndex=i(1),b.findLastIndex=i(-1),b.sortedIndex=function(t,e,n,i){n=x(n,i,1);for(var o=n(e),r=0,s=P(t);s>r;){var a=Math.floor((r+s)/2);n(t[a])<o?r=a+1:s=a}return r},b.indexOf=o(1,b.findIndex,b.sortedIndex),b.lastIndexOf=o(-1,b.findLastIndex),b.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=Array(i),r=0;i>r;r++,t+=n)o[r]=t;return o};var M=function(t,e,n,i,o){if(!(i instanceof e))return t.apply(n,o);var r=T(t.prototype),s=t.apply(r,o);return b.isObject(s)?s:r};b.bind=function(t,e){if(v&&t.bind===v)return v.apply(t,d.call(arguments,1));if(!b.isFunction(t))throw new TypeError("Bind must be called on a function");var n=d.call(arguments,2),i=function(){return M(t,i,e,this,n.concat(d.call(arguments)))};return i},b.partial=function(t){var e=d.call(arguments,1),n=function(){for(var i=0,o=e.length,r=Array(o),s=0;o>s;s++)r[s]=e[s]===b?arguments[i++]:e[s];for(;i<arguments.length;)r.push(arguments[i++]);return M(t,n,this,this,r)};return n},b.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=b.bind(t[n],t);return t},b.memoize=function(t,e){var n=function(i){var o=n.cache,r=""+(e?e.apply(this,arguments):i);return b.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return n.cache={},n},b.delay=function(t,e){var n=d.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},b.defer=b.partial(b.delay,b,1),b.throttle=function(t,e,n){var i,o,r,s=null,a=0;n||(n={});var l=function(){a=n.leading===!1?0:b.now(),s=null,r=t.apply(i,o),s||(i=o=null)};return function(){var u=b.now();a||n.leading!==!1||(a=u);var c=e-(u-a);return i=this,o=arguments,0>=c||c>e?(s&&(clearTimeout(s),s=null),a=u,r=t.apply(i,o),s||(i=o=null)):s||n.trailing===!1||(s=setTimeout(l,c)),r}},b.debounce=function(t,e,n){var i,o,r,s,a,l=function(){var u=b.now()-s;e>u&&u>=0?i=setTimeout(l,e-u):(i=null,n||(a=t.apply(r,o),i||(r=o=null)))};return function(){r=this,o=arguments,s=b.now();var u=n&&!i;return i||(i=setTimeout(l,e)),u&&(a=t.apply(r,o),r=o=null),a}},b.wrap=function(t,e){return b.partial(e,t)},b.negate=function(t){return function(){return!t.apply(this,arguments)}},b.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},b.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},b.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},b.once=b.partial(b.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),z=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];b.keys=function(t){if(!b.isObject(t))return[];if(g)return g(t);var e=[];for(var n in t)b.has(t,n)&&e.push(n);return A&&r(t,e),e},b.allKeys=function(t){if(!b.isObject(t))return[];var e=[];for(var n in t)e.push(n);return A&&r(t,e),e},b.values=function(t){for(var e=b.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},b.mapObject=function(t,e,n){e=x(e,n);for(var i,o=b.keys(t),r=o.length,s={},a=0;r>a;a++)i=o[a],s[i]=e(t[i],i,t);return s},b.pairs=function(t){for(var e=b.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},b.invert=function(t){for(var e={},n=b.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},b.functions=b.methods=function(t){var e=[];for(var n in t)b.isFunction(t[n])&&e.push(n);return e.sort()},b.extend=L(b.allKeys),b.extendOwn=b.assign=L(b.keys),b.findKey=function(t,e,n){e=x(e,n);for(var i,o=b.keys(t),r=0,s=o.length;s>r;r++)if(i=o[r],e(t[i],i,t))return i},b.pick=function(t,e,n){var i,o,r={},s=t;if(null==s)return r;b.isFunction(e)?(o=b.allKeys(s),i=w(e,n)):(o=D(arguments,!1,!1,1),i=function(t,e,n){return e in n},s=Object(s));for(var a=0,l=o.length;l>a;a++){var u=o[a],c=s[u];i(c,u,s)&&(r[u]=c)}return r},b.omit=function(t,e,n){if(b.isFunction(e))e=b.negate(e);else{var i=b.map(D(arguments,!1,!1,1),String);e=function(t,e){return!b.contains(i,e)}}return b.pick(t,e,n)},b.defaults=L(b.allKeys,!0),b.create=function(t,e){var n=T(t);return e&&b.extendOwn(n,e),n},b.clone=function(t){return b.isObject(t)?b.isArray(t)?t.slice():b.extend({},t):t},b.tap=function(t,e){return e(t),t},b.isMatch=function(t,e){var n=b.keys(e),i=n.length;if(null==t)return!i;for(var o=Object(t),r=0;i>r;r++){var s=n[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var I=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof b&&(t=t._wrapped),e instanceof b&&(e=e._wrapped);var o=f.call(t);if(o!==f.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(b.isFunction(s)&&s instanceof s&&b.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===t)return i[l]===e;if(n.push(t),i.push(e),r){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!I(t[l],e[l],n,i))return!1}else{var u,c=b.keys(t);if(l=c.length,b.keys(e).length!==l)return!1;for(;l--;)if(u=c[l],!b.has(e,u)||!I(t[u],e[u],n,i))return!1}return n.pop(),i.pop(),!0};b.isEqual=function(t,e){return I(t,e)},b.isEmpty=function(t){return null==t?!0:C(t)&&(b.isArray(t)||b.isString(t)||b.isArguments(t))?0===t.length:0===b.keys(t).length},b.isElement=function(t){return!(!t||1!==t.nodeType)},b.isArray=m||function(t){return"[object Array]"===f.call(t)},b.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},b.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){b["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),b.isArguments(arguments)||(b.isArguments=function(t){return b.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(b.isFunction=function(t){return"function"==typeof t||!1}),b.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},b.isNaN=function(t){return b.isNumber(t)&&t!==+t},b.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===f.call(t)},b.isNull=function(t){return null===t},b.isUndefined=function(t){return void 0===t},b.has=function(t,e){return null!=t&&p.call(t,e)},b.noConflict=function(){return s._=a,this},b.identity=function(t){return t},b.constant=function(t){return function(){return t}},b.noop=function(){},b.property=S,b.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},b.matcher=b.matches=function(t){return t=b.extendOwn({},t),function(e){return b.isMatch(e,t)}},b.times=function(t,e,n){var i=Array(Math.max(0,t));e=w(e,n,1);for(var o=0;t>o;o++)i[o]=e(o);return i},b.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},b.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=b.invert(O),R=function(t){var e=function(e){return t[e]},n="(?:"+b.keys(t).join("|")+")",i=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(o,e):t}};b.escape=R(O),b.unescape=R(N),b.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),b.isFunction(i)?i.call(t):i};var j=0;b.uniqueId=function(t){var e=++j+"";return t?t+e:e},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,B=function(t){return"\\"+F[t]};b.template=function(t,e,n){!e&&n&&(e=n),e=b.defaults({},e,b.templateSettings);var i=RegExp([(e.escape||q).source,(e.interpolate||q).source,(e.evaluate||q).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(i,function(e,n,i,s,a){return r+=t.slice(o,a).replace(U,B),o=a+e.length,n?r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(a){throw a.source=r,a}var l=function(t){return s.call(this,t,b)},u=e.variable||"obj";return l.source="function("+u+"){\n"+r+"}",l},b.chain=function(t){var e=b(t);return e._chain=!0,e};var H=function(t,e){return t._chain?b(e).chain():e};b.mixin=function(t){b.each(b.functions(t),function(e){var n=b[e]=t[e];b.prototype[e]=function(){var t=[this._wrapped];return h.apply(t,arguments),H(this,n.apply(b,t))}})},b.mixin(b),b.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=l[t];b.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],H(this,n)}}),b.each(["concat","join","slice"],function(t){var e=l[t];b.prototype[t]=function(){return H(this,e.apply(this._wrapped,arguments))}}),b.prototype.value=function(){return this._wrapped},b.prototype.valueOf=b.prototype.toJSON=b.prototype.value,b.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return b})}).call(this)},{}],96:[function(t,e,n){arguments[4][93][0].apply(n,arguments)},{dup:93}]},{},[1]);
//# sourceMappingURL=../../app/js/main.js.map